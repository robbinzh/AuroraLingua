<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>èŠ¬å…°è¯­ç²¾è¯» - 3.2 Kaisan perheen keittiÃ¶ssÃ¤</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&family=Noto+Sans:wght@400;700&display=swap');

        :root {
            /* å¨æˆ¿ä¸»é¢˜é…è‰²ï¼šèå…¥ä¸€äº›æ¸©æš–çš„è‰²è°ƒ */
            --primary-gradient: linear-gradient(135deg, #f6d365 0%, #fda085 100%);
            --text-gradient: linear-gradient(135deg, #84fab0 0%, #8fd3f4 100%);
            --card-back-gradient: linear-gradient(135deg, #2d3436, #636e72);
            --bg-color: #fdfbf7;
            --text-color: #2d3748;
        }

        body {
            font-family: 'Noto Sans', 'Noto Sans SC', sans-serif;
            background-color: var(--bg-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 40px 20px;
            color: var(--text-color);
            margin: 0;
            min-height: 100vh;
        }

        /* è¿”å›æŒ‰é’® */
        .back-button {
            position: fixed;
            top: 20px;
            left: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 50px;
            padding: 12px 24px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(118, 75, 162, 0.3);
            transition: all 0.3s ease;
            z-index: 1000;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .back-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(118, 75, 162, 0.4);
        }

        h1 {
            text-align: center;
            color: #1a202c;
            margin-bottom: 10px;
            font-weight: 800;
            font-size: 2rem;
        }

        .subtitle {
            text-align: center;
            color: #718096;
            margin-bottom: 40px;
            max-width: 600px;
            line-height: 1.5;
        }

        /* å¡ç‰‡ç½‘æ ¼ */
        .card-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 30px;
            width: 100%;
            max-width: 1400px;
            margin-bottom: 60px;
        }

        /* å¡ç‰‡åŸºç¡€ç»“æ„ */
        .card {
            background-color: transparent;
            width: 100%;
            height: 420px;
            perspective: 1500px;
            cursor: pointer;
        }

        .card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.6s cubic-bezier(0.7, 0, 0.3, 1);
            transform-style: preserve-3d;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
            border-radius: 20px;
        }
        
        .card:hover .card-inner {
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.12);
        }

        .card.is-flipped .card-inner {
            transform: rotateY(180deg);
        }

        /* å¡ç‰‡æ­£åé¢é€šç”¨ */
        .card-front,
        .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            display: flex;
            flex-direction: column;
            padding: 24px;
            box-sizing: border-box;
            border-radius: 20px;
            overflow: hidden;
        }

        /* å¡ç‰‡æ­£é¢ */
        .card-front {
            background-color: #ffffff;
            color: var(--text-color);
            align-items: center;
            justify-content: center;
            border: 1px solid rgba(0,0,0,0.05);
        }

        .card-category {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            padding: 4px 12px;
            border-radius: 12px;
            font-weight: 700;
        }
        
        /* åˆ†ç±»æ ·å¼ */
        .cat-title { background-color: #e2e8f0; color: #2d3748; }
        .cat-text { background-color: #e6fffa; color: #2c7a7b; }
        .cat-recipe { background-color: #fffaf0; color: #dd6b20; border: 1px solid #fbd38d; }

        .card-number {
            position: absolute;
            top: 20px;
            left: 20px;
            font-size: 1.2rem;
            font-weight: 800;
            color: #cbd5e0;
        }

        .fi-text {
            font-size: 1.5rem;
            font-weight: 700;
            line-height: 1.4;
            margin: 20px 0;
            color: #2d3748;
        }

        /* å¡ç‰‡èƒŒé¢ */
        .card-back {
            background: var(--card-back-gradient);
            color: white;
            transform: rotateY(180deg);
            text-align: left;
            overflow-y: auto;
            padding-right: 18px;
        }

        .card-back::-webkit-scrollbar { width: 6px; }
        .card-back::-webkit-scrollbar-track { background: rgba(255,255,255,0.1); }
        .card-back::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.3); border-radius: 10px; }

        .card-back h3 {
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: #fab1a0; /* æš–è‰²è°ƒæ ‡é¢˜ */
            margin: 15px 0 5px 0;
            border-bottom: 1px solid rgba(255,255,255,0.2);
            padding-bottom: 4px;
        }
        .card-back h3:first-child { margin-top: 0; }

        .chunk-box {
            background: rgba(0,0,0,0.2);
            padding: 8px 12px;
            border-radius: 8px;
            font-family: 'Noto Sans Mono', monospace;
            font-size: 0.9rem;
            line-height: 1.5;
            margin-bottom: 10px;
            border-left: 3px solid #fab1a0;
        }

        .grammar-text, .zh-text {
            font-size: 0.95rem;
            line-height: 1.6;
            margin-bottom: 10px;
        }

        .grammar-text strong { color: #ffeaa7; }
        .grammar-text em { color: #81ecec; font-style: normal; text-decoration: underline; }

        /* TTS æŒ‰é’® */
        .tts-btn {
            background: var(--primary-gradient);
            color: white;
            border: none;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            margin-top: 15px;
            box-shadow: 0 4px 10px rgba(253, 160, 133, 0.4);
        }

        .tts-btn-small {
            background: linear-gradient(135deg, #f6d365 0%, #fda085 100%);
            color: white;
            border: none;
            width: 26px;
            height: 26px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 0.9rem;
            margin-left: 8px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s;
            vertical-align: middle;
            box-shadow: 0 2px 6px rgba(253, 160, 133, 0.3);
        }

        .tts-btn-small:hover { transform: scale(1.15); }
        .tts-btn-small:active { transform: scale(0.9); }

        .tts-btn:hover { transform: scale(1.1); }
        .tts-btn:active { transform: scale(0.95); }
        .tts-btn.playing { animation: pulse 1.5s infinite; background: linear-gradient(135deg, #ff9ff3 0%, #feca57 100%); }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(254, 202, 87, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(254, 202, 87, 0); }
            100% { box-shadow: 0 0 0 0 rgba(254, 202, 87, 0); }
        }

        .flip-hint {
            margin-top: auto;
            font-size: 0.8rem;
            color: #a0aec0;
            font-weight: 500;
        }

        /* æ€»ç»“è¡¨æ ¼åŒºåŸŸ */
        .summary-section {
            width: 100%;
            max-width: 1000px;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.05);
            margin-top: 20px;
        }

        .summary-section h2 {
            text-align: left;
            border-bottom: 2px solid #edf2f7;
            padding-bottom: 15px;
            margin-bottom: 25px;
            color: #e17055;
        }

        .vocab-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 30px;
        }
        
        .vocab-table th, .vocab-table td {
            text-align: left;
            padding: 12px 15px;
            border-bottom: 1px solid #edf2f7;
        }
        
        .vocab-table th {
            background-color: #fff7ed;
            color: #d35400;
            font-weight: 700;
        }
        
        .vocab-table tr:hover { background-color: #f8f9fa; }

        @media (max-width: 600px) {
            .card-container { grid-template-columns: 1fr; }
            h1 { font-size: 1.5rem; }
            .card { height: 480px; } /* ç§»åŠ¨ç«¯å¢åŠ é«˜åº¦ */
            .summary-section { padding: 20px; }
        }
    </style>
</head>
<body>

    <button class="back-button" onclick="history.back()">
        <span>â†</span> è¿”å›
    </button>

    <h1>3.2 Kaisan perheen keittiÃ¶ssÃ¤</h1>
    <p class="subtitle">åœ¨Kaisaå®¶çš„å¨æˆ¿é‡Œ<br>å­¦ä¹ é‡ç‚¹ï¼šç‰©è´¨åè¯ã€é£Ÿè°±è®¡é‡ã€å½¢å®¹è¯ä¸€è‡´æ€§</p>

    <div class="card-container" id="cardContainer">
        <!-- å¡ç‰‡å°†é€šè¿‡ JS åŠ¨æ€ç”Ÿæˆ -->
    </div>

    <!-- è¯æ±‡æ€»ç»“åŒºåŸŸ -->
    <div class="summary-section">
        <h2>é•¿éš¾å•è¯è¯­æ³•åˆ†è§£ (Sanasto ja Kielioppi)</h2>
        
        <table class="vocab-table">
            <thead>
                <tr><th>å•è¯</th><th>ä¸­æ–‡</th><th>æ„è¯æ³• / åŸå‹ä¸è¯­æ³•åˆ†æ</th></tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>paistamiseen</strong> <button class="tts-btn-small" onclick="speak(this, 'paistamiseen')" title="å¬å‘éŸ³">ğŸ”Š</button></td>
                    <td>ç”¨äºç…/ç‚’</td>
                    <td><strong>åŸå‹: paistaminen</strong> (åŠ¨åè¯)ã€‚<br>æ¥è‡ª paistaa (ç…)ã€‚å…¥æ ¼: nen â†’ se + en â†’ seenã€‚</td>
                </tr>
                <tr>
                    <td><strong>vihanneksia</strong> <button class="tts-btn-small" onclick="speak(this, 'vihanneksia')" title="å¬å‘éŸ³">ğŸ”Š</button></td>
                    <td>è”¬èœ(å¤æ•°éƒ¨åˆ†æ ¼)</td>
                    <td><strong>åŸå‹: vihannes</strong>ã€‚<br>è¯æ ¹ vihannekse-ã€‚å¤æ•° i + éƒ¨åˆ†æ ¼ aã€‚</td>
                </tr>
                <tr>
                    <td><strong>jauhelihaa</strong> <button class="tts-btn-small" onclick="speak(this, 'jauhelihaa')" title="å¬å‘éŸ³">ğŸ”Š</button></td>
                    <td>è‚‰æœ«</td>
                    <td><strong>åŸå‹: jauheliha</strong>ã€‚<br>jauhe (ç²‰) + liha (è‚‰)ã€‚ç‰©è´¨åè¯éƒ¨åˆ†æ ¼ã€‚</td>
                </tr>
                <tr>
                    <td><strong>tuoretta</strong> <button class="tts-btn-small" onclick="speak(this, 'tuoretta')" title="å¬å‘éŸ³">ğŸ”Š</button></td>
                    <td>æ–°é²œçš„</td>
                    <td><strong>åŸå‹: tuore</strong>ã€‚<br>-e ç»“å°¾å½¢å®¹è¯ï¼Œéƒ¨åˆ†æ ¼åŠ  -ttaã€‚ä¿®é¥°éƒ¨åˆ†æ ¼åè¯ã€‚</td>
                </tr>
                <tr>
                    <td><strong>kotimaista</strong> <button class="tts-btn-small" onclick="speak(this, 'kotimaista')" title="å¬å‘éŸ³">ğŸ”Š</button></td>
                    <td>å›½äº§çš„</td>
                    <td><strong>åŸå‹: kotimainen</strong>ã€‚<br>-nen ç»“å°¾ï¼Œéƒ¨åˆ†æ ¼å»æ‰ nen åŠ  staã€‚</td>
                </tr>
                <tr>
                    <td><strong>retiisiÃ¤</strong> <button class="tts-btn-small" onclick="speak(this, 'retiisiÃ¤')" title="å¬å‘éŸ³">ğŸ”Š</button></td>
                    <td>å°çº¢èåœ</td>
                    <td><strong>åŸå‹: retiisi</strong>ã€‚<br>å¤–æ¥è¯ä»¥ i ç»“å°¾ï¼Œéƒ¨åˆ†æ ¼åŠ  Ã¤ã€‚</td>
                </tr>
                <tr>
                    <td><strong>kukkakaalia</strong> <button class="tts-btn-small" onclick="speak(this, 'kukkakaalia')" title="å¬å‘éŸ³">ğŸ”Š</button></td>
                    <td>èŠ±èœ</td>
                    <td><strong>åŸå‹: kukkakaali</strong>ã€‚<br>kukka (èŠ±) + kaali (å·å¿ƒèœ)ã€‚</td>
                </tr>
            </tbody>
        </table>
    </div>

    <script>
        // æ ¸å¿ƒæ•°æ®ï¼šåŒ…å« Markdown ä¸­çš„æ‰€æœ‰å¥å­å’Œåˆ†æ
        const lessonData = [
            // --- Title ---
            {
                fi: "Kaisan perheen keittiÃ¶ssÃ¤",
                zh: "åœ¨Kaisaå®¶çš„å¨æˆ¿é‡Œã€‚",
                category: "title",
                chunks: "Kaisan perheen (Kaisaå®¶åº­çš„) / keittiÃ¶ssÃ¤ (å¨æˆ¿é‡Œ)",
                grammar: "<strong>åŒé‡å±æ ¼</strong>: Kaisan ä¿®é¥° perheenï¼Œperheen ä¿®é¥° keittiÃ¶ssÃ¤ã€‚<br><strong>keittiÃ¶ssÃ¤</strong>: å†…æ ¼ (Inessiivi)ï¼Œé™æ€ä½ç½®ã€‚"
            },
            // --- Paragraph 1 ---
            {
                fi: "Kello on kymmenen yli kymmenen.",
                zh: "ç°åœ¨æ˜¯åç‚¹ååˆ†ã€‚",
                category: "text",
                chunks: "Kello on / kymmenen yli kymmenen (åç‚¹è¿‡ååˆ†)",
                grammar: "<strong>æ—¶é—´è¡¨è¾¾</strong>: [åˆ†é’Ÿ] <em>yli</em> (è¶…è¿‡) [å°æ—¶]ã€‚"
            },
            {
                fi: "Kaisa ja Sofia ovat keittiÃ¶ssÃ¤.",
                zh: "Kaisaå’ŒSofiaåœ¨å¨æˆ¿é‡Œã€‚",
                category: "text",
                chunks: "Kaisa ja Sofia / ovat (åœ¨) / keittiÃ¶ssÃ¤ (å¨æˆ¿é‡Œ)",
                grammar: "<strong>ovat</strong>: åŸå½¢ olla (ç¬¬ä¸‰äººç§°å¤æ•°)ã€‚<br><strong>keittiÃ¶-ssÃ¤</strong>: å†…æ ¼ã€‚"
            },
            {
                fi: "Sofia syÃ¶ leipÃ¤Ã¤ ja juo maitoa.",
                zh: "Sofiaæ­£åœ¨åƒé¢åŒ…å–ç‰›å¥¶ã€‚",
                category: "text",
                chunks: "Sofia syÃ¶ (åƒ) / leipÃ¤Ã¤ (é¢åŒ…) / ja juo (å–) / maitoa (ç‰›å¥¶)",
                grammar: "<strong>æ ¸å¿ƒè¯­æ³•</strong>: é¢åŒ…(leipÃ¤)å’Œç‰›å¥¶(maito)æ˜¯ç‰©è´¨åè¯ï¼Œä¸”ä½œä¸ºæŒç»­åŠ¨ä½œçš„å¯¹è±¡ï¼Œå¿…é¡»ç”¨<strong>éƒ¨åˆ†æ ¼</strong> (Partitiivi)ã€‚"
            },
            {
                fi: "Sandrine tulee tÃ¤nÃ¤Ã¤n kylÃ¤Ã¤n.",
                zh: "Sandrineä»Šå¤©æ¥åšå®¢ã€‚",
                category: "text",
                chunks: "Sandrine tulee / tÃ¤nÃ¤Ã¤n / kylÃ¤Ã¤n (åšå®¢)",
                grammar: "<strong>tulla kylÃ¤Ã¤n</strong>: å›ºå®šæ­é…'æ¥åšå®¢'ã€‚<br>å­—é¢ä¹‰'è¿›æ‘' (kylÃ¤ + -Ã¤n)ã€‚"
            },
            {
                fi: "Kaisa tekee ruokaa.",
                zh: "Kaisaæ­£åœ¨åšé¥­ã€‚",
                category: "text",
                chunks: "Kaisa tekee (åš) / ruokaa (é£Ÿç‰©/é¥­)",
                grammar: "<strong>ruokaa</strong>: éƒ¨åˆ†æ ¼ã€‚'åšé¥­'æ˜¯æŒç»­æ´»åŠ¨ã€‚<br><strong>tekee</strong>: åŸå½¢ <em>tehdÃ¤</em> (hd â†’ k)ã€‚"
            },
            {
                fi: "KeittiÃ¶n pÃ¶ydÃ¤llÃ¤ on liha-makaronilaatikon resepti.",
                zh: "å¨æˆ¿æ¡Œå­ä¸Šæœ‰ä¸€ä»½è‚‰æœ«é€šå¿ƒç²‰çš„é£Ÿè°±ã€‚",
                category: "text",
                chunks: "KeittiÃ¶n pÃ¶ydÃ¤llÃ¤ on / liha-makaronilaatikon (è‚‰æœ«é€šå¿ƒç²‰çš„) / resepti",
                grammar: "<strong>pÃ¶ydÃ¤llÃ¤</strong>: æ¥æ ¼ (Adessiivi)ï¼Œ'åœ¨æ¡Œå­ä¸Š'ã€‚<br><strong>liha-makaronilaatikko</strong>: å¤åˆè¯ï¼Œlaatikko æŒ‡çƒ¤ç®±èœã€‚"
            },
            {
                fi: "Kaisa tekee liha-makaronilaatikkoa.",
                zh: "Kaisaæ­£åœ¨åšè‚‰æœ«é€šå¿ƒç²‰ã€‚",
                category: "text",
                chunks: "Kaisa tekee / liha-makaronilaatikkoa",
                grammar: "<strong>éƒ¨åˆ†æ ¼</strong>: å› ä¸ºæ­£åœ¨åˆ¶ä½œä¸­ï¼Œæœªå®Œæˆï¼Œæ‰€ä»¥ç”¨éƒ¨åˆ†æ ¼ (-a)ã€‚"
            },
            {
                fi: "Hellalla on kattilassa vettÃ¤.",
                zh: "ç‚‰ç¶ä¸Šçš„é”…é‡Œæœ‰æ°´ã€‚",
                category: "text",
                chunks: "Hellalla (ç‚‰ç¶ä¸Š) / on / kattilassa (é”…é‡Œ) / vettÃ¤ (æ°´)",
                grammar: "<strong>vettÃ¤</strong>: åŸå½¢ <em>vesi</em>ã€‚ä½œä¸ºå­˜åœ¨å¥ä¸»è¯­çš„ç‰©è´¨åè¯ï¼Œå¿…é¡»ç”¨éƒ¨åˆ†æ ¼ã€‚"
            },
            {
                fi: "Kaisa keittÃ¤Ã¤ makaronit vedessÃ¤.",
                zh: "Kaisaåœ¨æ°´é‡Œç…®é€šå¿ƒç²‰ã€‚",
                category: "text",
                chunks: "Kaisa keittÃ¤Ã¤ / makaronit / vedessÃ¤ (åœ¨æ°´é‡Œ)",
                grammar: "<strong>makaronit</strong>: å¤æ•°å®¾æ ¼ã€‚æŒ‡è¦æŠŠ'å…¨éƒ¨å‡†å¤‡å¥½çš„'é€šå¿ƒç²‰ç…®ç†Ÿ (æœ‰ç•Œé™çš„åŠ¨ä½œ)ã€‚<br><strong>vedessÃ¤</strong>: å†…æ ¼ (vesi)ã€‚"
            },
            {
                fi: "Kaisa tekee myÃ¶s jÃ¤lkiruokaa, hedelmÃ¤salaattia.",
                zh: "Kaisaä¹Ÿåœ¨åšç”œç‚¹ï¼Œæ°´æœæ²™æ‹‰ã€‚",
                category: "text",
                chunks: "myÃ¶s jÃ¤lkiruokaa (ä¹Ÿåšç”œç‚¹), / hedelmÃ¤salaattia (æ°´æœæ²™æ‹‰)",
                grammar: "ä¸¤ä¸ªè¯å‡ä¸º<strong>éƒ¨åˆ†æ ¼</strong>ï¼Œä½œä¸º <em>tekee</em> (tehdÃ¤) çš„å®¾è¯­ã€‚"
            },
            
            // --- Recipe Section ---
            {
                fi: "400 g makaronia",
                zh: "400å…‹é€šå¿ƒç²‰",
                category: "recipe",
                chunks: "400 (neljÃ¤sataa) / grammaa / makaronia",
                grammar: "<strong>grammaa</strong>: åº¦é‡è¡¡å•ä½ç”¨éƒ¨åˆ†æ ¼ã€‚<br><strong>makaronia</strong>: ç‰©è´¨åè¯éƒ¨åˆ†æ ¼ã€‚"
            },
            {
                fi: "500 g jauhelihaa",
                zh: "500å…‹è‚‰æœ«",
                category: "recipe",
                chunks: "500 (viisisataa) / grammaa / jauhelihaa",
                grammar: "<strong>jauhelihaa</strong>: åŸå½¢ <em>jauheliha</em> çš„éƒ¨åˆ†æ ¼ã€‚"
            },
            {
                fi: "1 sipuli",
                zh: "1ä¸ªæ´‹è‘±",
                category: "recipe",
                chunks: "yksi / sipuli",
                grammar: "<strong>è§„åˆ™</strong>: æ•°è¯æ˜¯ 1ï¼Œåè¯ç”¨<strong>ä¸»æ ¼å•æ•°</strong>ã€‚"
            },
            {
                fi: "vÃ¤hÃ¤n suolaa, vÃ¤hÃ¤n pippuria",
                zh: "å°‘è®¸ç›ï¼Œå°‘è®¸èƒ¡æ¤’",
                category: "recipe",
                chunks: "vÃ¤hÃ¤n (ä¸€ç‚¹) / suolaa, / pippuria",
                grammar: "<strong>vÃ¤hÃ¤n</strong>: ä¸å®šæ•°é‡è¯ï¼Œè¦æ±‚åé¢è·Ÿéƒ¨åˆ†æ ¼ã€‚"
            },
            {
                fi: "3 kananmunaa",
                zh: "3ä¸ªé¸¡è›‹",
                category: "recipe",
                chunks: "3 (kolme) / kananmunaa",
                grammar: "<strong>è§„åˆ™</strong>: æ•°è¯å¤§äº 1ï¼Œåè¯ç”¨<strong>éƒ¨åˆ†æ ¼å•æ•°</strong>ã€‚<br>kananmuna + aã€‚"
            },
            {
                fi: "7 dl maitoa",
                zh: "7åˆ†å‡ç‰›å¥¶",
                category: "recipe",
                chunks: "7 (seitsemÃ¤n) / dl (desilitraa) / maitoa",
                grammar: "<strong>dl</strong>: desilitraa (éƒ¨åˆ†æ ¼)ã€‚"
            },
            {
                fi: "Lihan paistamiseen: vÃ¤hÃ¤n voita ja paljon Ã¶ljyÃ¤",
                zh: "ç”¨äºç…è‚‰ï¼šå°‘è®¸é»„æ²¹å’Œå¤§é‡æ²¹",
                category: "recipe",
                chunks: "Lihan paistamiseen (ç”¨äºç…è‚‰): / vÃ¤hÃ¤n voita / ja paljon Ã¶ljyÃ¤",
                grammar: "<strong>paistamiseen</strong>: åŠ¨åè¯å…¥æ ¼ (ç”¨äº...)ã€‚<br><strong>paljon + éƒ¨åˆ†æ ¼</strong>: paljon Ã¶ljyÃ¤ (å¾ˆå¤šæ²¹)ã€‚"
            },

            // --- Paragraph 2 ---
            {
                fi: "LisÃ¤ksi Kaisa keittÃ¤Ã¤ vihanneksia.",
                zh: "æ­¤å¤–ï¼ŒKaisaè¿˜åœ¨ç…®è”¬èœã€‚",
                category: "text",
                chunks: "LisÃ¤ksi / Kaisa keittÃ¤Ã¤ / vihanneksia",
                grammar: "<strong>vihanneksia</strong>: åŸå½¢ <em>vihannes</em>ã€‚<br>å¤æ•°éƒ¨åˆ†æ ¼ (-ksia)ã€‚"
            },
            {
                fi: "KeittiÃ¶n pÃ¶ydÃ¤llÃ¤ on 4 porkkanaa, iso pala kukkakaalia ja pala parsakaalia.",
                zh: "æ¡Œä¸Šæœ‰4æ ¹èƒ¡èåœï¼Œä¸€å¤§å—èŠ±èœå’Œä¸€å—è¥¿å…°èŠ±ã€‚",
                category: "text",
                chunks: "4 porkkanaa, / iso pala kukkakaalia / ja pala parsakaalia",
                grammar: "<strong>4 porkkanaa</strong>: æ•°è¯+éƒ¨åˆ†æ ¼ã€‚<br><strong>pala + éƒ¨åˆ†æ ¼</strong>: pala kukkakaalia (å—çŠ¶é‡è¯)ã€‚"
            },
            {
                fi: "Kaisa tekee myÃ¶s salaattia.",
                zh: "Kaisaä¹Ÿåšæ²™æ‹‰ã€‚",
                category: "text",
                chunks: "tekee myÃ¶s / salaattia",
                grammar: "<strong>salaattia</strong>: åŸå½¢ <em>salaatti</em> çš„éƒ¨åˆ†æ ¼ã€‚"
            },
            {
                fi: "TiskipÃ¶ydÃ¤llÃ¤ on 1 tuore ruukkusalaatti, 3 tuoretta tomaattia, pala kotimaista kurkkua...",
                zh: "æ´—ç¢—å°ä¸Šæœ‰1é¢—ç”Ÿèœã€3ä¸ªæ–°é²œç•ªèŒ„ã€ä¸€æ®µå›½äº§é»„ç“œ...",
                category: "text",
                chunks: "1 tuore ruukkusalaatti, / 3 tuoretta tomaattia, / pala kotimaista kurkkua...",
                grammar: "<strong>é‡ç‚¹ï¼šå½¢å®¹è¯ä¸€è‡´æ€§</strong><br>1. <strong>1 tuore ruukkusalaatti</strong>: 1+ä¸»æ ¼ã€‚<br>2. <strong>3 tuoretta tomaattia</strong>: 3+éƒ¨åˆ†æ ¼ï¼Œå½¢å®¹è¯ <em>tuore</em> ä¹Ÿè¦å˜éƒ¨åˆ†æ ¼ <em>tuoretta</em>ã€‚<br>3. <strong>kotimaista kurkkua</strong>: é‡è¯ pala åæ¥éƒ¨åˆ†æ ¼ï¼Œå½¢å®¹è¯åŒå˜ã€‚"
            },
            {
                fi: "...pari punaista paprikaa ja 6 retiisiÃ¤.",
                zh: "...å‡ ä¸ªçº¢ç”œæ¤’å’Œ6ä¸ªå°çº¢èåœã€‚",
                category: "text",
                chunks: "pari punaista paprikaa / ja 6 retiisiÃ¤",
                grammar: "<strong>pari (ä¸€å¯¹/å‡ ä¸ª)</strong>: åæ¥éƒ¨åˆ†æ ¼ã€‚<br>punainen â†’ <strong>punaista</strong>ã€‚<br>paprika â†’ <strong>paprikaa</strong>ã€‚<br>retiisi â†’ <strong>retiisiÃ¤</strong>ã€‚"
            }
        ];

        // æ¸²æŸ“å¡ç‰‡
        const container = document.getElementById('cardContainer');

        lessonData.forEach((item, index) => {
            const card = document.createElement('div');
            card.className = 'card';
            
            // ç¡®å®šç±»åˆ«æ ‡ç­¾æ ·å¼
            let catClass = 'cat-text';
            let catText = 'Teksti';
            let numberDisplay = index; // é»˜è®¤åºå·

            if (item.category === 'title') {
                catClass = 'cat-title';
                catText = 'Otsikko';
                numberDisplay = 'â˜…';
            } else if (item.category === 'recipe') {
                catClass = 'cat-recipe';
                catText = 'Resepti';
            }

            card.innerHTML = `
                <div class="card-inner">
                    <div class="card-front">
                        <span class="card-number">${numberDisplay}</span>
                        <span class="card-category ${catClass}">${catText}</span>
                        <div class="fi-text" style="${item.fi.length > 50 ? 'font-size: 1.2rem' : ''}">${item.fi}</div>
                        <button class="tts-btn" onclick="speak(this, '${item.fi.replace(/'/g, "\\'")}')" title="å¬å‘éŸ³">ğŸ”Š</button>
                        <div class="flip-hint">ç‚¹å‡»æŸ¥çœ‹è§£æ</div>
                    </div>
                    <div class="card-back">
                        <h3>è¯­è¨€ç»„å— (Chunks)</h3>
                        <div class="chunk-box">${item.chunks}</div>
                        
                        <h3>è¯­æ³•åˆ†æ (Kielioppi)</h3>
                        <div class="grammar-text">${item.grammar}</div>
                        
                        <h3>ä¸­æ–‡ç¿»è¯‘ (KÃ¤Ã¤nnÃ¶s)</h3>
                        <div class="zh-text">${item.zh}</div>
                    </div>
                </div>
            `;

            // ç‚¹å‡»å¡ç‰‡ç¿»è½¬é€»è¾‘ï¼ˆæ’é™¤æŒ‰é’®ç‚¹å‡»ï¼‰
            card.addEventListener('click', (e) => {
                if (!e.target.closest('.tts-btn')) {
                    card.classList.toggle('is-flipped');
                }
            });

            container.appendChild(card);
        });

        // TTS è¯­éŸ³åŠŸèƒ½
        let currentBtn = null;

        function speak(btn, text) {
            if (window.speechSynthesis.speaking) {
                return;
            }

            currentBtn = btn;

            // å¤„ç†é£Ÿè°±ä¸­çš„æ•°å­—æœ—è¯»ä¼˜åŒ–
            let textToSpeak = text;
            // ç®€å•çš„æ›¿æ¢ä¼˜åŒ–ï¼Œè®©TTSè¯»å‡ºå•ä½å…¨ç§°
            textToSpeak = textToSpeak.replace(/(\d+)\s?g\b/g, '$1 grammaa');
            textToSpeak = textToSpeak.replace(/(\d+)\s?dl\b/g, '$1 desilitraa');

            const utterance = new SpeechSynthesisUtterance(textToSpeak);
            utterance.lang = 'fi-FI'; // èŠ¬å…°è¯­
            utterance.rate = 0.85;

            btn.classList.add('playing');
            btn.textContent = 'ğŸ”‡';

            utterance.onend = () => {
                if (btn === currentBtn) {
                    btn.classList.remove('playing');
                    btn.textContent = 'ğŸ”Š';
                }
            };

            utterance.onerror = (e) => {
                console.error('TTS Error:', e);
                if (btn === currentBtn) {
                    btn.classList.remove('playing');
                    btn.textContent = 'ğŸ”Š';
                }
                const url = `https://translate.google.com/translate_tts?ie=UTF-8&client=tw-ob&q=${encodeURIComponent(text)}&tl=fi`;
                new Audio(url).play();
            };

            window.speechSynthesis.speak(utterance);
        }
    </script>
</body>
</html>