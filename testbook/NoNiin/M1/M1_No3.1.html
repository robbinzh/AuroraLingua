<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>èŠ¬å…°è¯­ç²¾è¯» - ç¬¬ä¸‰è¯¾ (Sandrinen perheen luona)</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&family=Noto+Sans:wght@400;700&display=swap');

        :root {
            /* ä¿æŒåŸæœ‰é…è‰²é£æ ¼ï¼Œç•¥å¾®è°ƒæ•´ä¸»è‰²è°ƒä»¥åŒºåˆ†è¯¾ç¨‹ */
            --primary-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --card-back-gradient: linear-gradient(135deg, #2c3e50, #3498db);
            --accent-color: #00f2fe;
            --text-color: #2d3748;
            --bg-color: #f0f2f5;
        }

        body {
            font-family: 'Noto Sans', 'Noto Sans SC', sans-serif;
            background-color: var(--bg-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 40px 20px;
            color: var(--text-color);
            margin: 0;
            min-height: 100vh;
        }

        /* è¿”å›æŒ‰é’® */
        .back-button {
            position: fixed;
            top: 20px;
            left: 20px;
            background: var(--primary-gradient);
            color: white;
            border: none;
            border-radius: 50px;
            padding: 12px 24px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(79, 172, 254, 0.3);
            transition: all 0.3s ease;
            z-index: 1000;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .back-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(79, 172, 254, 0.4);
        }

        h1 {
            text-align: center;
            color: #1a202c;
            margin-bottom: 10px;
            font-weight: 800;
            font-size: 2rem;
        }

        .subtitle {
            text-align: center;
            color: #718096;
            margin-bottom: 40px;
            max-width: 600px;
            line-height: 1.5;
        }

        /* å¡ç‰‡ç½‘æ ¼ */
        .card-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 30px;
            width: 100%;
            max-width: 1400px;
            margin-bottom: 60px;
        }

        /* å¡ç‰‡åŸºç¡€ç»“æ„ */
        .card {
            background-color: transparent;
            width: 100%;
            height: 400px; /* ç•¥å¾®å¢åŠ é«˜åº¦ä»¥é€‚åº”å¤æ‚çš„è¯­æ³•è§£é‡Š */
            perspective: 1500px;
            cursor: pointer;
        }

        .card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.6s cubic-bezier(0.7, 0, 0.3, 1);
            transform-style: preserve-3d;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
            border-radius: 20px;
        }
        
        .card:hover .card-inner {
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.12);
        }

        .card.is-flipped .card-inner {
            transform: rotateY(180deg);
        }

        /* å¡ç‰‡æ­£åé¢é€šç”¨ */
        .card-front,
        .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            display: flex;
            flex-direction: column;
            padding: 24px;
            box-sizing: border-box;
            border-radius: 20px;
            overflow: hidden;
        }

        /* å¡ç‰‡æ­£é¢ */
        .card-front {
            background-color: #ffffff;
            color: var(--text-color);
            align-items: center;
            justify-content: center;
            border: 1px solid rgba(0,0,0,0.05);
        }

        .card-category {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            padding: 4px 12px;
            border-radius: 12px;
            font-weight: 700;
        }
        
        /* é’ˆå¯¹æœ¬è¯¾çš„åˆ†ç±»æ ·å¼ */
        .cat-title { background-color: #fed7d7; color: #9b2c2c; }
        .cat-text { background-color: #e2e8f0; color: #4a5568; }

        .card-number {
            position: absolute;
            top: 20px;
            left: 20px;
            font-size: 1.2rem;
            font-weight: 800;
            color: #cbd5e0;
        }

        .fi-text {
            font-size: 1.5rem; /* ç¨å¾®è°ƒå°ä¸€ç‚¹ä»¥é˜²å¥å­è¿‡é•¿ */
            font-weight: 700;
            line-height: 1.4;
            margin: 20px 0;
            color: #2d3748;
        }

        /* å¡ç‰‡èƒŒé¢ */
        .card-back {
            background: var(--card-back-gradient);
            color: white;
            transform: rotateY(180deg);
            text-align: left;
            overflow-y: auto;
            padding-right: 18px;
        }

        .card-back::-webkit-scrollbar { width: 6px; }
        .card-back::-webkit-scrollbar-track { background: rgba(255,255,255,0.1); }
        .card-back::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.3); border-radius: 10px; }

        .card-back h3 {
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: rgba(255,255,255,0.7);
            margin: 15px 0 5px 0;
            border-bottom: 1px solid rgba(255,255,255,0.2);
            padding-bottom: 4px;
        }
        .card-back h3:first-child { margin-top: 0; }

        .chunk-box {
            background: rgba(0,0,0,0.2);
            padding: 8px 12px;
            border-radius: 8px;
            font-family: 'Noto Sans Mono', monospace;
            font-size: 0.9rem;
            line-height: 1.5;
            margin-bottom: 10px;
            border-left: 3px solid #63b3ed;
        }

        .grammar-text, .zh-text {
            font-size: 0.95rem;
            line-height: 1.6;
            margin-bottom: 10px;
        }

        .grammar-text strong { color: #fbd38d; }
        .grammar-text em { color: #90cdf4; font-style: normal; text-decoration: underline; }

        /* TTS æŒ‰é’® */
        .tts-btn {
            background: var(--primary-gradient);
            color: white;
            border: none;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            margin-top: 15px;
            box-shadow: 0 4px 10px rgba(79, 172, 254, 0.4);
        }

        .tts-btn-small {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border: none;
            width: 26px;
            height: 26px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 0.9rem;
            margin-left: 8px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s;
            vertical-align: middle;
            box-shadow: 0 2px 6px rgba(79, 172, 254, 0.3);
        }

        .tts-btn-small:hover { transform: scale(1.15); }
        .tts-btn-small:active { transform: scale(0.9); }

        .tts-btn:hover { transform: scale(1.1); }
        .tts-btn:active { transform: scale(0.95); }
        .tts-btn.playing { animation: pulse 1.5s infinite; background: linear-gradient(135deg, #f687b3 0%, #ed64a6 100%); }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(237, 100, 166, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(237, 100, 166, 0); }
            100% { box-shadow: 0 0 0 0 rgba(237, 100, 166, 0); }
        }

        .flip-hint {
            margin-top: auto;
            font-size: 0.8rem;
            color: #a0aec0;
            font-weight: 500;
        }

        /* æ€»ç»“è¡¨æ ¼åŒºåŸŸ */
        .summary-section {
            width: 100%;
            max-width: 1000px;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.05);
            margin-top: 20px;
        }

        .summary-section h2 {
            text-align: left;
            border-bottom: 2px solid #edf2f7;
            padding-bottom: 15px;
            margin-bottom: 25px;
        }

        .vocab-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 30px;
        }
        
        .vocab-table th, .vocab-table td {
            text-align: left;
            padding: 12px 15px;
            border-bottom: 1px solid #edf2f7;
        }
        
        .vocab-table th {
            background-color: #f7fafc;
            color: #4a5568;
            font-weight: 700;
        }
        
        .vocab-table tr:hover { background-color: #f8f9fa; }

        @media (max-width: 600px) {
            .card-container { grid-template-columns: 1fr; }
            h1 { font-size: 1.5rem; }
            .card { height: 450px; } /* ç§»åŠ¨ç«¯å¢åŠ é«˜åº¦ä»¥æ˜¾ç¤ºæ›´å¤šå†…å®¹ */
            .summary-section { padding: 20px; }
        }
    </style>
</head>
<body>

    <button class="back-button" onclick="history.back()">
        <span>â†</span> è¿”å›
    </button>

    <h1>ç¬¬ä¸‰è¯¾ï¼šOma maa mansikka</h1>
    <p class="subtitle">Sandrinen perheen luona (åœ¨Sandrineå®¶)<br>æ¶µç›–æ—¶é—´è¡¨è¾¾ã€ä½ç½®æ ¼å˜åŒ–ä¸è´­ç‰©éƒ¨åˆ†æ ¼</p>

    <div class="card-container" id="cardContainer">
        <!-- å¡ç‰‡å°†é€šè¿‡ JS åŠ¨æ€ç”Ÿæˆ -->
    </div>

    <!-- è¯æ±‡æ€»ç»“åŒºåŸŸ -->
    <div class="summary-section">
        <h2>é‡ç‚¹è¯­æ³•è¯æ±‡è¡¨ (Sanasto ja Kielioppi)</h2>
        
        <table class="vocab-table">
            <thead>
                <tr><th>å•è¯</th><th>ä¸­æ–‡</th><th>æ„è¯æ³• / åŸå‹ä¸è¯­æ³•åˆ†æ</th></tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>tÃ¶ihin</strong> <button class="tts-btn-small" onclick="speak(this, 'tÃ¶ihin')" title="å¬å‘éŸ³">ğŸ”Š</button></td>
                    <td>å»ä¸Šç­/è¿›å…¥å·¥ä½œ</td>
                    <td><strong>åŸå‹: tyÃ¶</strong>ã€‚å¤æ•°å…¥æ ¼ã€‚å˜åŒ–: yÃ¶ â†’ Ã¶i + -hinã€‚</td>
                </tr>
                <tr>
                    <td><strong>kukkakimpun</strong> <button class="tts-btn-small" onclick="speak(this, 'kukkakimpun')" title="å¬å‘éŸ³">ğŸ”Š</button></td>
                    <td>èŠ±æŸ (å®¾è¯­)</td>
                    <td><strong>åŸå‹: kukkakimppu</strong>ã€‚å•æ•°å±æ ¼/å®¾æ ¼ã€‚pp â†’ mp (å¼ºå¼±çº§)ã€‚</td>
                </tr>
                <tr>
                    <td><strong>syntymÃ¤pÃ¤ivÃ¤</strong> <button class="tts-btn-small" onclick="speak(this, 'syntymÃ¤pÃ¤ivÃ¤')" title="å¬å‘éŸ³">ğŸ”Š</button></td>
                    <td>ç”Ÿæ—¥</td>
                    <td><strong>åŸå‹: syntymÃ¤pÃ¤ivÃ¤</strong>ã€‚å¤åˆè¯: syntymÃ¤ (å‡ºç”Ÿ) + pÃ¤ivÃ¤ (æ—¥å­)ã€‚</td>
                </tr>
                <tr>
                    <td><strong>ostamassa</strong> <button class="tts-btn-small" onclick="speak(this, 'ostamassa')" title="å¬å‘éŸ³">ğŸ”Š</button></td>
                    <td>æ­£åœ¨ä¹°/å»ä¹°</td>
                    <td><strong>åŸå‹: ostaa</strong>ã€‚ç¬¬ä¸‰ä¸å®šå¼å†…æ ¼ (-ma + -ssa)ã€‚å¸¸è·Ÿåœ¨ kÃ¤ydÃ¤ åã€‚</td>
                </tr>
                <tr>
                    <td><strong>tuliainen</strong> <button class="tts-btn-small" onclick="speak(this, 'tuliainen')" title="å¬å‘éŸ³">ğŸ”Š</button></td>
                    <td>ä¼´æ‰‹ç¤¼</td>
                    <td><strong>åŸå‹: tuliainen</strong>ã€‚æºè‡ª tulla (æ¥)ã€‚è¯å°¾ -inenã€‚</td>
                </tr>
                <tr>
                    <td><strong>Kaisasta</strong> <button class="tts-btn-small" onclick="speak(this, 'Kaisasta')" title="å¬å‘éŸ³">ğŸ”Š</button></td>
                    <td>Kaisaè§‰å¾—...</td>
                    <td><strong>åŸå‹: Kaisa</strong>ã€‚å‡ºæ ¼ (-sta)ã€‚ç”¨æ³•: "Kaisasta on..." (åœ¨Kaisaçœ‹æ¥...)ã€‚</td>
                </tr>
            </tbody>
        </table>
    </div>

    <script>
        // æ ¸å¿ƒæ•°æ®ï¼šåŒ…å« Markdown ä¸­çš„æ‰€æœ‰å¥å­å’Œåˆ†æ
        const lessonData = [
            // --- Title ---
            {
                fi: "Sandrinen perheen luona",
                zh: "åœ¨Sandrineå®¶ / åœ¨Sandrineçš„å®¶äººé‚£é‡Œã€‚",
                category: "title",
                chunks: "Sandrinen (Sandrineçš„) / perheen (å®¶åº­çš„) / luona (é‚£é‡Œ/ä½å¤„)",
                grammar: "<strong>luona</strong>: åç½®è¯ (Postpositio)ï¼Œæ„ä¸º'åœ¨â€¦â€¦é‚£é‡Œ'ã€‚è¦æ±‚å‰é¢çš„è¯ä¸ºå±æ ¼ã€‚<br><strong>Sandrinen</strong>: ä¸“æœ‰åè¯å±æ ¼ã€‚<br><strong>perheen</strong>: åè¯ perhe çš„å±æ ¼ã€‚"
            },
            // --- Paragraph 1 ---
            {
                fi: "Kello on puoli yhdeksÃ¤n.",
                zh: "ç°åœ¨æ˜¯å…«ç‚¹åŠã€‚",
                category: "text",
                chunks: "Kello on (é’Ÿç‚¹æ˜¯) / puoli yhdeksÃ¤n (å…«ç‚¹åŠ)",
                grammar: "<strong>æ—¶é—´è¡¨è¾¾</strong>: èŠ¬å…°è¯­çš„'åŠ'æ˜¯'é€šå¾€ä¸‹ä¸€ä¸ªå°æ—¶çš„ä¸€åŠ'ã€‚Puoli + ä¸‹ä¸€ä¸ªå°æ—¶çš„æ•°å­—ã€‚<br><strong>on</strong>: åŸå½¢ olla (æ˜¯)ã€‚"
            },
            {
                fi: "Sandrine, Akuri ja lapset ovat kotona.",
                zh: "Sandrineã€Akuriå’Œå­©å­ä»¬éƒ½åœ¨å®¶ã€‚",
                category: "text",
                chunks: "Sandrine, Akuri ja lapset / ovat (åœ¨) / kotona (å®¶é‡Œ)",
                grammar: "<strong>lapset</strong>: åè¯ lapsi (å­©å­) çš„å¤æ•°ä¸»æ ¼ (si â†’ set)ã€‚<br><strong>kotona</strong>: åè¯ koti çš„åŸƒè¥¿æ ¼/çŠ¶æ€æ ¼ (Essiivi)ï¼Œè¡¨ç¤º'åœ¨å®¶'è¿™ä¸€é™æ­¢çŠ¶æ€ã€‚"
            },
            {
                fi: "Akuri menee kohta tÃ¶ihin, mutta ensin hÃ¤n vie Lucienin kouluun.",
                zh: "Akuriå¾ˆå¿«è¦å»ä¸Šç­ï¼Œä½†é¦–å…ˆä»–è¦é€Lucienå»å­¦æ ¡ã€‚",
                category: "text",
                chunks: "Akuri menee kohta tÃ¶ihin (å»ä¸Šç­), / mutta ensin hÃ¤n vie / Lucienin / kouluun (å»å­¦æ ¡)",
                grammar: "<strong>tÃ¶ihin</strong>: tyÃ¶ çš„å¤æ•°å…¥æ ¼ï¼Œ'å»ä¸Šç­'ã€‚<br><strong>Lucienin</strong>: ç‰¹å®šå®¾è¯­ï¼ŒåŠ  -nã€‚<br><strong>kouluun</strong>: koulu çš„å…¥æ ¼ï¼Œè¡¨ç¤ºæ–¹å‘'å»å­¦æ ¡é‡Œ'ã€‚"
            },
            // --- Paragraph 2 ---
            {
                fi: "Sandrine ja Leslie jÃ¤Ã¤vÃ¤t kotiin.",
                zh: "Sandrineå’ŒLeslieç•™åœ¨å®¶é‡Œã€‚",
                category: "text",
                chunks: "Sandrine ja Leslie / jÃ¤Ã¤vÃ¤t (ç•™) / kotiin (åœ¨å®¶é‡Œ)",
                grammar: "<strong>kotiin</strong>: åŠ¨è¯ <em>jÃ¤Ã¤dÃ¤</em> (ç•™ä¸‹) è¦æ±‚æ¥åœ°ç‚¹çŠ¶è¯­çš„<strong>å…¥æ ¼</strong> (Illatiivi)ï¼Œå› ä¸º'ç•™ä¸‹'æš—ç¤ºäº†è¿‡ç¨‹çš„ç»“æœã€‚<br>å¯¹æ¯”ï¼škotona (é™æ­¢), kotiin (å»/ç•™)ã€‚"
            },
            {
                fi: "He syÃ¶vÃ¤t vielÃ¤ aamupalaa.",
                zh: "ä»–ä»¬è¿˜åœ¨åƒæ—©é¤ã€‚",
                category: "text",
                chunks: "He syÃ¶vÃ¤t (ä»–ä»¬åƒ) / vielÃ¤ (è¿˜åœ¨) / aamupalaa (æ—©é¤)",
                grammar: "<strong>aamupalaa</strong>: åè¯ aamupala çš„<strong>éƒ¨åˆ†æ ¼</strong> (Partitiivi)ã€‚<br>åŸå› ï¼šè¿›é£Ÿæ˜¯æŒç»­è¿‡ç¨‹ï¼Œä¸”é£Ÿç‰©æ˜¯ç‰©è´¨åè¯ã€‚"
            },
            {
                fi: "He menevÃ¤t pÃ¤ivÃ¤llÃ¤ Kaisan luokse kylÃ¤Ã¤n, mutta he kÃ¤yvÃ¤t ensin kaupassa ostamassa ruokaa.",
                zh: "ä»–ä»¬ç™½å¤©è¦å»Kaisaå®¶åšå®¢ï¼Œä½†ä»–ä»¬å…ˆè¦å»å•†åº—ä¹°ç‚¹åƒçš„ã€‚",
                category: "text",
                chunks: "He menevÃ¤t pÃ¤ivÃ¤llÃ¤ Kaisan luokse kylÃ¤Ã¤n, / mutta he kÃ¤yvÃ¤t ensin kaupassa / ostamassa ruokaa.",
                grammar: "<strong>pÃ¤ivÃ¤llÃ¤</strong>: æ¥æ ¼ (Adessiivi)ï¼Œæ—¶é—´çŠ¶è¯­ã€‚<br><strong>Kaisan luokse</strong>: 'å»Kaisaé‚£é‡Œ' (æ–¹å‘)ã€‚<br><strong>ostamassa</strong>: ç¬¬ä¸‰ä¸å®šå¼å†…æ ¼ï¼Œè·Ÿåœ¨ kÃ¤ydÃ¤ (å»/é€›) åé¢ï¼Œè¡¨ç¤º'å»æŸåœ°åšæŸäº‹'ã€‚"
            },
            // --- Paragraph 3 ---
            {
                fi: "Sandrine ostaa leipÃ¤Ã¤, voita, makkaraa, maitoa ja teetÃ¤.",
                zh: "Sandrineä¹°äº†é¢åŒ…ã€é»„æ²¹ã€é¦™è‚ ã€ç‰›å¥¶å’ŒèŒ¶ã€‚",
                category: "text",
                chunks: "Sandrine ostaa / leipÃ¤Ã¤, voita, makkaraa, maitoa ja teetÃ¤",
                grammar: "<strong>é‡ç‚¹</strong>: æ‰€æœ‰å®¾è¯­å‡ä¸ºç‰©è´¨åè¯ï¼Œå¿…é¡»ä½¿ç”¨<strong>éƒ¨åˆ†æ ¼</strong>ã€‚<br>leipÃ¤Ã¤ (leipÃ¤), voita (voi), makkaraa (makkara), maitoa (maito), teetÃ¤ (tee)ã€‚"
            },
            {
                fi: "LisÃ¤ksi hÃ¤n ostaa kukkakimpun ja pienen lahjan.",
                zh: "æ­¤å¤–ï¼Œå¥¹è¿˜ä¹°äº†ä¸€æŸèŠ±å’Œä¸€ä¸ªå°ç¤¼ç‰©ã€‚",
                category: "text",
                chunks: "LisÃ¤ksi / hÃ¤n ostaa / kukkakimpun / ja pienen lahjan",
                grammar: "<strong>å®¾è¯­æ ¼å¯¹æ¯”</strong>: è¿™é‡Œçš„èŠ±æŸå’Œç¤¼ç‰©æ˜¯å…·ä½“çš„ã€å¯æ•°çš„å•æ•°å¯¹è±¡ã€‚<br>ä½¿ç”¨<strong>å±æ ¼å½¢å¼çš„å®¾æ ¼</strong> (åŠ  -n)ã€‚<br><strong>pienen lahjan</strong>: å½¢å®¹è¯ä¸åè¯æ€§æ•°æ ¼ä¸€è‡´ã€‚"
            },
            {
                fi: "HÃ¤n vie lahjan Sofialle, koska Sofialla oli viikonloppuna syntymÃ¤pÃ¤ivÃ¤.",
                zh: "å¥¹æŠŠç¤¼ç‰©é€ç»™Sofiaï¼Œå› ä¸ºSofiaå‘¨æœ«è¿‡äº†ç”Ÿæ—¥ã€‚",
                category: "text",
                chunks: "HÃ¤n vie lahjan Sofialle (ç»™Sofia), / koska Sofialla oli (Sofiaæœ‰) / syntymÃ¤pÃ¤ivÃ¤",
                grammar: "<strong>Sofialle</strong>: å‘æ ¼ (Allatiivi)ï¼Œ'ç»™æŸäºº'ã€‚<br><strong>Sofialla oli</strong>: æ‰€æœ‰æ ¼ç»“æ„è¿‡å»æ—¶ã€‚<br><strong>viikonloppuna</strong>: åŸƒè¥¿æ ¼ï¼Œæ—¶é—´ç‚¹'åœ¨å‘¨æœ«'ã€‚"
            },
            {
                fi: "Sandrine vie kukat Kaisalle.",
                zh: "SandrineæŠŠèŠ±é€ç»™Kaisaã€‚",
                category: "text",
                chunks: "Sandrine vie / kukat (èŠ±) / Kaisalle (ç»™Kaisa)",
                grammar: "<strong>kukat</strong>: å¤æ•°å®¾æ ¼ (åŒä¸»æ ¼)ã€‚<br><strong>Kaisalle</strong>: å‘æ ¼ï¼Œè¡¨ç¤ºæ¥æ”¶è€…ã€‚"
            },
            {
                fi: "Kaisasta on varmaan kivaa saada pieni tuliainen.",
                zh: "Kaisaæ”¶åˆ°å°ä¼´æ‰‹ç¤¼è‚¯å®šä¼šå¾ˆå¼€å¿ƒã€‚",
                category: "text",
                chunks: "Kaisasta on (Kaisaè§‰å¾—) / varmaan kivaa (è‚¯å®šå¾ˆå¼€å¿ƒ) / saada pieni tuliainen",
                grammar: "<strong>Kaisasta on...</strong>: å‡ºæ ¼ (-sta) è¡¨ç¤º'åœ¨æŸäººçœ‹æ¥'ã€‚<br><strong>kivaa</strong>: å½¢å®¹è¯éƒ¨åˆ†æ ¼ï¼Œè¡¨ç¤ºæŠ½è±¡æ„Ÿè§‰ã€‚<br><strong>tuliainen</strong>: ä¼´æ‰‹ç¤¼ã€‚"
            }
        ];

        // æ¸²æŸ“å¡ç‰‡
        const container = document.getElementById('cardContainer');

        lessonData.forEach((item, index) => {
            const card = document.createElement('div');
            card.className = 'card';
            
            // ç¡®å®šç±»åˆ«æ ‡ç­¾æ ·å¼
            const catClass = item.category === 'title' ? 'cat-title' : 'cat-text';
            const catText = item.category === 'title' ? 'Otsikko' : 'Teksti';
            
            // åºå·é€»è¾‘ï¼šæ ‡é¢˜ä¸æ ‡å·ï¼Œæ­£æ–‡ä»1å¼€å§‹
            const numberDisplay = item.category === 'title' ? 'â˜…' : (index); 

            card.innerHTML = `
                <div class="card-inner">
                    <div class="card-front">
                        <span class="card-number">${numberDisplay}</span>
                        <span class="card-category ${catClass}">${catText}</span>
                        <div class="fi-text">${item.fi}</div>
                        <button class="tts-btn" onclick="speak(this, '${item.fi.replace(/'/g, "\\'")}')" title="å¬å‘éŸ³">ğŸ”Š</button>
                        <div class="flip-hint">ç‚¹å‡»æŸ¥çœ‹è§£æ</div>
                    </div>
                    <div class="card-back">
                        <h3>è¯­è¨€ç»„å— (Chunks)</h3>
                        <div class="chunk-box">${item.chunks}</div>
                        
                        <h3>è¯­æ³•åˆ†æ (Kielioppi)</h3>
                        <div class="grammar-text">${item.grammar}</div>
                        
                        <h3>ä¸­æ–‡ç¿»è¯‘ (KÃ¤Ã¤nnÃ¶s)</h3>
                        <div class="zh-text">${item.zh}</div>
                    </div>
                </div>
            `;

            // ç‚¹å‡»å¡ç‰‡ç¿»è½¬é€»è¾‘ï¼ˆæ’é™¤æŒ‰é’®ç‚¹å‡»ï¼‰
            card.addEventListener('click', (e) => {
                if (!e.target.closest('.tts-btn')) {
                    card.classList.toggle('is-flipped');
                }
            });

            container.appendChild(card);
        });

        // TTS è¯­éŸ³åŠŸèƒ½
        let currentBtn = null;

        function speak(btn, text) {
            if (window.speechSynthesis.speaking) {
                return;
            }

            currentBtn = btn;

            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'fi-FI'; // èŠ¬å…°è¯­
            utterance.rate = 0.85;

            btn.classList.add('playing');
            btn.textContent = 'ğŸ”‡';

            utterance.onend = () => {
                if (btn === currentBtn) {
                    btn.classList.remove('playing');
                    btn.textContent = 'ğŸ”Š';
                }
            };

            utterance.onerror = (e) => {
                console.error('TTS Error:', e);
                if (btn === currentBtn) {
                    btn.classList.remove('playing');
                    btn.textContent = 'ğŸ”Š';
                }
                // ç®€å•çš„é™çº§æ–¹æ¡ˆ
                const url = `https://translate.google.com/translate_tts?ie=UTF-8&client=tw-ob&q=${encodeURIComponent(text)}&tl=fi`;
                new Audio(url).play();
            };

            window.speechSynthesis.speak(utterance);
        }
    </script>
</body>
</html>