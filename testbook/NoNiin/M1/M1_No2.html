<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>èŠ¬å…°è¯­ç²¾è¯» - ç¬¬ä¸€è¯¾ (Kappale 1)</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&family=Noto+Sans:wght@400;700&display=swap');

        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --card-back-gradient: linear-gradient(135deg, #2c3e50, #4ca1af);
            --accent-color: #764ba2;
            --text-color: #2d3748;
            --bg-color: #f0f2f5;
        }

        body {
            font-family: 'Noto Sans', 'Noto Sans SC', sans-serif;
            background-color: var(--bg-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 40px 20px;
            color: var(--text-color);
            margin: 0;
            min-height: 100vh;
        }

        /* è¿”å›æŒ‰é’® */
        .back-button {
            position: fixed;
            top: 20px;
            left: 20px;
            background: var(--primary-gradient);
            color: white;
            border: none;
            border-radius: 50px;
            padding: 12px 24px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(118, 75, 162, 0.3);
            transition: all 0.3s ease;
            z-index: 1000;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .back-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(118, 75, 162, 0.4);
        }

        h1 {
            text-align: center;
            color: #1a202c;
            margin-bottom: 10px;
            font-weight: 800;
            font-size: 2rem;
        }

        .subtitle {
            text-align: center;
            color: #718096;
            margin-bottom: 40px;
            max-width: 600px;
            line-height: 1.5;
        }

        /* å¡ç‰‡ç½‘æ ¼ */
        .card-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 30px;
            width: 100%;
            max-width: 1400px;
            margin-bottom: 60px;
        }

        /* å¡ç‰‡åŸºç¡€ç»“æ„ */
        .card {
            background-color: transparent;
            width: 100%;
            height: 380px; /* å¢åŠ é«˜åº¦ä»¥å®¹çº³è¯¦ç»†ç¬”è®° */
            perspective: 1500px;
            cursor: pointer;
        }

        .card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.6s cubic-bezier(0.7, 0, 0.3, 1);
            transform-style: preserve-3d;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
            border-radius: 20px;
        }
        
        .card:hover .card-inner {
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.12);
        }

        .card.is-flipped .card-inner {
            transform: rotateY(180deg);
        }

        /* å¡ç‰‡æ­£åé¢é€šç”¨ */
        .card-front,
        .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            display: flex;
            flex-direction: column;
            padding: 24px;
            box-sizing: border-box;
            border-radius: 20px;
            overflow: hidden;
        }

        /* å¡ç‰‡æ­£é¢ */
        .card-front {
            background-color: #ffffff;
            color: var(--text-color);
            align-items: center;
            justify-content: center;
            border: 1px solid rgba(0,0,0,0.05);
        }

        .card-category {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            padding: 4px 12px;
            border-radius: 12px;
            font-weight: 700;
        }
        
        .cat-intro { background-color: #e2e8f0; color: #4a5568; }
        .cat-dialogue { background-color: #ebf8ff; color: #3182ce; }

        .card-number {
            position: absolute;
            top: 20px;
            left: 20px;
            font-size: 1.2rem;
            font-weight: 800;
            color: #cbd5e0;
        }

        .fi-text {
            font-size: 1.6rem;
            font-weight: 700;
            line-height: 1.4;
            margin: 20px 0;
            color: #2d3748;
        }

        /* å¡ç‰‡èƒŒé¢ */
        .card-back {
            background: var(--card-back-gradient);
            color: white;
            transform: rotateY(180deg);
            text-align: left;
            overflow-y: auto; /* å…è®¸æ»šåŠ¨ */
            padding-right: 18px; /* ç»™æ»šåŠ¨æ¡ç•™ç©º */
        }

        /* æ»šåŠ¨æ¡ç¾åŒ– */
        .card-back::-webkit-scrollbar { width: 6px; }
        .card-back::-webkit-scrollbar-track { background: rgba(255,255,255,0.1); }
        .card-back::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.3); border-radius: 10px; }

        .card-back h3 {
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: rgba(255,255,255,0.7);
            margin: 15px 0 5px 0;
            border-bottom: 1px solid rgba(255,255,255,0.2);
            padding-bottom: 4px;
        }
        .card-back h3:first-child { margin-top: 0; }

        .chunk-box {
            background: rgba(0,0,0,0.2);
            padding: 8px 12px;
            border-radius: 8px;
            font-family: 'Noto Sans Mono', monospace;
            font-size: 0.9rem;
            line-height: 1.5;
            margin-bottom: 10px;
            border-left: 3px solid #63b3ed;
        }

        .grammar-text, .zh-text {
            font-size: 0.95rem;
            line-height: 1.6;
            margin-bottom: 10px;
        }

        .grammar-text strong { color: #fbd38d; }
        .grammar-text em { color: #90cdf4; font-style: normal; text-decoration: underline; }

        /* TTS æŒ‰é’® */
        .tts-btn {
            background: var(--primary-gradient);
            color: white;
            border: none;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            margin-top: 15px;
            box-shadow: 0 4px 10px rgba(102, 126, 234, 0.4);
        }

        .tts-btn-small {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            width: 26px;
            height: 26px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 0.9rem;
            margin-left: 8px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s;
            vertical-align: middle;
            box-shadow: 0 2px 6px rgba(118, 75, 162, 0.3);
        }

        .tts-btn-small:hover { transform: scale(1.15); }
        .tts-btn-small:active { transform: scale(0.9); }

        .tts-btn:hover { transform: scale(1.1); }
        .tts-btn:active { transform: scale(0.95); }
        .tts-btn.playing { animation: pulse 1.5s infinite; background: linear-gradient(135deg, #f687b3 0%, #ed64a6 100%); }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(237, 100, 166, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(237, 100, 166, 0); }
            100% { box-shadow: 0 0 0 0 rgba(237, 100, 166, 0); }
        }

        .flip-hint {
            margin-top: auto;
            font-size: 0.8rem;
            color: #a0aec0;
            font-weight: 500;
        }

        /* æ€»ç»“è¡¨æ ¼åŒºåŸŸ */
        .summary-section {
            width: 100%;
            max-width: 1000px;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.05);
            margin-top: 20px;
        }

        .summary-section h2 {
            text-align: left;
            border-bottom: 2px solid #edf2f7;
            padding-bottom: 15px;
            margin-bottom: 25px;
        }

        .vocab-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 30px;
        }
        
        .vocab-table th, .vocab-table td {
            text-align: left;
            padding: 12px 15px;
            border-bottom: 1px solid #edf2f7;
        }
        
        .vocab-table th {
            background-color: #f7fafc;
            color: #4a5568;
            font-weight: 700;
        }
        
        .vocab-table tr:hover { background-color: #f8f9fa; }

        @media (max-width: 600px) {
            .card-container { grid-template-columns: 1fr; }
            h1 { font-size: 1.5rem; }
            .card { height: 420px; }
            .summary-section { padding: 20px; }
        }
    </style>
</head>
<body>

    <button class="back-button" onclick="history.back()">
        <span>â†</span> è¿”å›
    </button>

    <h1>ç¬¬ä¸€è¯¾ï¼šåˆæ¬¡ç›¸é‡</h1>
    <p class="subtitle">åŒ…å«èƒŒæ™¯ä»‹ç» (Tausta) ä¸å£è¯­å¯¹è¯ (Dialogi)<br>ç‚¹å‡»å¡ç‰‡æŸ¥çœ‹è¯­æ³•æ‹†è§£ä¸è¯¦ç»†åˆ†æ</p>

    <div class="card-container" id="cardContainer">
        <!-- å¡ç‰‡å°†é€šè¿‡ JS åŠ¨æ€ç”Ÿæˆ -->
    </div>

    <!-- è¯æ±‡æ€»ç»“åŒºåŸŸ -->
    <div class="summary-section">
        <h2>é‡ç‚¹è¯æ±‡ä¸è¯­æ³•è¡¨ (Sanasto ja Kielioppi)</h2>
        
        <h3>èƒŒæ™¯ç¯‡ (Tausta)</h3>
        <table class="vocab-table">
            <thead>
                <tr><th>å•è¯</th><th>ä¸­æ–‡</th><th>æ„è¯æ³•/è¯­æ³•ç‚¹</th></tr>
            </thead>
            <tbody>
                <tr><td><strong>leikkipuistossa</strong> <button class="tts-btn-small" onclick="speak(this, 'leikkipuistossa')" title="å¬å‘éŸ³">ğŸ”Š</button></td><td>åœ¨æ¸¸ä¹åœºé‡Œ</td><td>leikki (ç©) + puisto (å…¬å›­) + -ssa (å†…æ ¼)</td></tr>
                <tr><td><strong>toisen</strong> <button class="tts-btn-small" onclick="speak(this, 'toisen')" title="å¬å‘éŸ³">ğŸ”Š</button></td><td>å¦ä¸€ä¸ªçš„</td><td>toinen çš„å±æ ¼ (nen â†’ sen)</td></tr>
                <tr><td><strong>Ã¤idin</strong> <button class="tts-btn-small" onclick="speak(this, 'Ã¤idin')" title="å¬å‘éŸ³">ğŸ”Š</button></td><td>å¦ˆå¦ˆçš„</td><td>Ã¤iti çš„å±æ ¼ (t â†’ d å¼±çº§å˜åŒ–)</td></tr>
                <tr><td><strong>lÃ¤mmin</strong> <button class="tts-btn-small" onclick="speak(this, 'lÃ¤mmin')" title="å¬å‘éŸ³">ğŸ”Š</button></td><td>æš–å’Œçš„</td><td>å½¢å®¹è¯åŸå‹</td></tr>
            </tbody>
        </table>

        <h3>å¯¹è¯ç¯‡ (Dialogi)</h3>
        <table class="vocab-table">
            <thead>
                <tr><th>å•è¯</th><th>ä¸­æ–‡</th><th>æ„è¯æ³•/è¯­æ³•ç‚¹</th></tr>
            </thead>
            <tbody>
                <tr><td><strong>minkÃ¤maalainen</strong> <button class="tts-btn-small" onclick="speak(this, 'minkÃ¤maalainen')" title="å¬å‘éŸ³">ğŸ”Š</button></td><td>å“ªå›½äºº</td><td>minkÃ¤ (å“ªä¸ª) + maan (å›½å®¶) + -lainen</td></tr>
                <tr><td><strong>meille</strong> <button class="tts-btn-small" onclick="speak(this, 'meille')" title="å¬å‘éŸ³">ğŸ”Š</button></td><td>å»æˆ‘ä»¬å®¶</td><td>me (æˆ‘ä»¬) + -ille (å‘æ ¼)</td></tr>
                <tr><td><strong>neuvolaan</strong> <button class="tts-btn-small" onclick="speak(this, 'neuvolaan')" title="å¬å‘éŸ³">ğŸ”Š</button></td><td>å»è‚²å„¿å’¨è¯¢å¤„</td><td>neuvola + -an (å…¥æ ¼)</td></tr>
                <tr><td><strong>soittaa</strong> <button class="tts-btn-small" onclick="speak(this, 'soittaa')" title="å¬å‘éŸ³">ğŸ”Š</button></td><td>æ‰“ç”µè¯</td><td>æ³¨æ„ tt â†’ t çš„å¼ºå¼±å˜åŒ–</td></tr>
                <tr><td><strong>nÃ¤hdÃ¤Ã¤n</strong> <button class="tts-btn-small" onclick="speak(this, 'nÃ¤hdÃ¤Ã¤n')" title="å¬å‘éŸ³">ğŸ”Š</button></td><td>å†è§/æˆ‘ä»¬è§</td><td>è¢«åŠ¨è¯­æ€ï¼Œå£è¯­å¸¸ç”¨</td></tr>
            </tbody>
        </table>
    </div>

    <script>
        // æ ¸å¿ƒæ•°æ®ï¼šåŒ…å«æ‰€æœ‰31ä¸ªå¥å­çš„è¯¦ç»†åˆ†æ
        const lessonData = [
            // --- Intro ---
            {
                fi: "TÃ¤nÃ¤Ã¤n on kaunis pÃ¤ivÃ¤.",
                zh: "ä»Šå¤©æ˜¯ä¸ªå¥½å¤©æ°”ã€‚",
                category: "intro",
                chunks: "TÃ¤nÃ¤Ã¤n (ä»Šå¤©) / on (æ˜¯) / kaunis pÃ¤ivÃ¤ (ç¾ä¸½çš„ä¸€å¤©)",
                grammar: "<strong>TÃ¤nÃ¤Ã¤n</strong>: æ—¶é—´å‰¯è¯ã€‚<br><strong>kaunis pÃ¤ivÃ¤</strong>: ä¸»è¯­ï¼Œå½¢å®¹è¯ä¸åè¯æ€§æ•°ä¸€è‡´ã€‚"
            },
            {
                fi: "YÃ¶ oli kylmÃ¤, mutta nyt on lÃ¤mmin ilma.",
                zh: "æ˜¨æ™šå¾ˆå†·ï¼Œä½†ç°åœ¨å¤©æ°”å¾ˆæš–å’Œã€‚",
                category: "intro",
                chunks: "YÃ¶ oli kylmÃ¤ (å¤œæ™šå¾ˆå†·) / mutta (ä½†æ˜¯) / nyt on (ç°åœ¨æ˜¯) / lÃ¤mmin ilma (æ¸©æš–çš„ç©ºæ°”)",
                grammar: "<strong>oli / on</strong>: è¿‡å»æ—¶ vs ç°åœ¨æ—¶å¯¹æ¯”ã€‚<br><strong>lÃ¤mmin</strong>: å½¢å®¹è¯åŸå‹ã€‚"
            },
            {
                fi: "Kaisa ja Kaisan tyttÃ¶ Sofia ovat leikkipuistossa.",
                zh: "Kaisaå’Œå¥¹çš„å¥³å„¿Sofiaåœ¨æ¸¸ä¹åœºé‡Œã€‚",
                category: "intro",
                chunks: "Kaisa ja Kaisan tyttÃ¶ Sofia / ovat (åœ¨) / leikkipuistossa (æ¸¸ä¹åœºé‡Œ)",
                grammar: "<strong>Kaisan</strong>: å±æ ¼ (Kaisaçš„)ã€‚<br><strong>leikkipuisto-ssa</strong>: å†…æ ¼ (Inessiivi)ï¼Œè¡¨ç¤ºåœ¨...é‡Œé¢ã€‚"
            },
            {
                fi: "Sofia ja toinen lapsi leikkivÃ¤t.",
                zh: "Sofiaæ­£å’Œå¦ä¸€ä¸ªå­©å­åœ¨ç©è€ã€‚",
                category: "intro",
                chunks: "Sofia ja toinen lapsi / leikkivÃ¤t (æ­£åœ¨ç©)",
                grammar: "<strong>leikkivÃ¤t</strong>: ä¸»è¯­æ˜¯å¤æ•°ï¼ŒåŠ¨è¯ä½¿ç”¨ç¬¬ä¸‰äººç§°å¤æ•°åç¼€ <em>-vÃ¤t</em>ã€‚"
            },
            {
                fi: "Kaisa puhuu toisen Ã¤idin kanssa.",
                zh: "Kaisaæ­£åœ¨å’Œå¦ä¸€ä½å¦ˆå¦ˆèŠå¤©ã€‚",
                category: "intro",
                chunks: "Kaisa puhuu (äº¤è°ˆ) / toisen Ã¤idin kanssa (å’Œå¦ä¸€ä½å¦ˆå¦ˆ)",
                grammar: "<strong>kanssa</strong>: åç½®è¯ï¼Œè¦æ±‚å‰é¢çš„è¯ç”¨å±æ ¼ã€‚<br><strong>toisen Ã¤idin</strong>: <em>toinen</em> å’Œ <em>Ã¤iti</em> çš„å±æ ¼å½¢å¼ã€‚"
            },
            // --- Dialogue ---
            {
                fi: "Hei, minun nimi on Sandrine.",
                zh: "ä½ å¥½ï¼Œæˆ‘çš„åå­—å«Sandrineã€‚",
                category: "dialogue",
                chunks: "Hei / minun nimi on (æˆ‘çš„åå­—æ˜¯) / Sandrine",
                grammar: "æ ‡å‡†è‡ªæˆ‘ä»‹ç»ã€‚<strong>minun</strong> æ˜¯æ ‡å‡†è¯­ 'æˆ‘çš„'ã€‚"
            },
            {
                fi: "Moi! Mun nimi on Kaisa.",
                zh: "å—¨ï¼æˆ‘å«Kaisaã€‚",
                category: "dialogue",
                chunks: "Moi! / Mun nimi on / Kaisa",
                grammar: "<strong>Mun</strong>: <em>minun</em> çš„å£è¯­å½¢å¼ã€‚<br><strong>Moi</strong>: éšæ„çš„æ‰“æ‹›å‘¼ã€‚"
            },
            {
                fi: "Oletko sinÃ¤ suomalainen?",
                zh: "ä½ æ˜¯èŠ¬å…°äººå—ï¼Ÿ",
                category: "dialogue",
                chunks: "Oletko sinÃ¤ (ä½ æ˜¯å—) / suomalainen (èŠ¬å…°äºº)?",
                grammar: "<strong>-ko</strong>: ç–‘é—®åç¼€ï¼ŒåŠ åœ¨åŠ¨è¯ <em>olet</em> åã€‚"
            },
            {
                fi: "Joo, mÃ¤ oon suomalainen. MÃ¤ oon kotoisin Ã„htÃ¤ristÃ¤.",
                zh: "å¯¹ï¼Œæˆ‘æ˜¯èŠ¬å…°äººã€‚æˆ‘è€å®¶æ˜¯ Ã„htÃ¤ri çš„ã€‚",
                category: "dialogue",
                chunks: "mÃ¤ oon (æˆ‘æ˜¯) / suomalainen. / MÃ¤ oon kotoisin (æˆ‘æ¥è‡ª) / Ã„htÃ¤ristÃ¤",
                grammar: "<strong>mÃ¤ oon</strong>: å£è¯­ (minÃ¤ olen)ã€‚<br><strong>kotoisin + -sta</strong>: å›ºå®šæ­é…ï¼Œè¡¨ç¤ºåŸç±æ¥è‡ªæŸåœ°ã€‚"
            },
            {
                fi: "MinkÃ¤maalainen sÃ¤ oot?",
                zh: "ä½ æ˜¯å“ªå›½äººï¼Ÿ",
                category: "dialogue",
                chunks: "MinkÃ¤maalainen (å“ªå›½äºº) / sÃ¤ oot (ä½ æ˜¯)?",
                grammar: "<strong>MinkÃ¤maalainen</strong>: ä¸“ç”¨å›½ç±ç–‘é—®è¯ã€‚<br><strong>sÃ¤ oot</strong>: å£è¯­ (sinÃ¤ olet)ã€‚"
            },
            {
                fi: "MÃ¤ olen kamerunilainen.",
                zh: "æˆ‘æ˜¯å–€éº¦éš†äººã€‚",
                category: "dialogue",
                chunks: "MÃ¤ olen / kamerunilainen",
                grammar: "å›½ç±è¯é€šå¸¸é¦–å­—æ¯å°å†™ã€‚"
            },
            {
                fi: "Okei. MikÃ¤ sun Ã¤idinkieli on?",
                zh: "å¥½çš„ã€‚ä½ çš„æ¯è¯­æ˜¯ä»€ä¹ˆï¼Ÿ",
                category: "dialogue",
                chunks: "MikÃ¤ (ä»€ä¹ˆ) / sun Ã¤idinkieli on (ä½ çš„æ¯è¯­æ˜¯)?",
                grammar: "<strong>sun</strong>: å£è¯­ (sinun)ã€‚<br><strong>Ã¤idinkieli</strong>: å¤åˆè¯ (å¦ˆå¦ˆçš„è¯­è¨€)ã€‚"
            },
            {
                fi: "Minun Ã¤idinkieli on ranska. Mutta minÃ¤ puhun myÃ¶s englantia ja vÃ¤hÃ¤n suomea.",
                zh: "æˆ‘çš„æ¯è¯­æ˜¯æ³•è¯­ã€‚ä½†æˆ‘ä¹Ÿä¼šè¯´è‹±è¯­å’Œä¸€ç‚¹èŠ¬å…°è¯­ã€‚",
                category: "dialogue",
                chunks: "Ã¤idinkieli on ranska. / puhun myÃ¶s englantia (è¯´è‹±è¯­) / ja vÃ¤hÃ¤n suomea",
                grammar: "<strong>puhua + éƒ¨åˆ†æ ¼</strong>: è¯­è¨€åç§°ç”¨éƒ¨åˆ†æ ¼ (englantia, suomea)ã€‚"
            },
            {
                fi: "Puhutko sinÃ¤ ranskaa?",
                zh: "ä½ ä¼šè¯´æ³•è¯­å—ï¼Ÿ",
                category: "dialogue",
                chunks: "Puhutko sinÃ¤ / ranskaa?",
                grammar: "<strong>ranskaa</strong>: ranska çš„éƒ¨åˆ†æ ¼å½¢å¼ã€‚"
            },
            {
                fi: "En. MÃ¤ en puhu ranskaa. MÃ¤ puhun espanjaa ja englantia.",
                zh: "ä¸ï¼Œæˆ‘ä¸ä¼šã€‚æˆ‘ä¼šè¯´è¥¿ç­ç‰™è¯­å’Œè‹±è¯­ã€‚",
                category: "dialogue",
                chunks: "En. / MÃ¤ en puhu ranskaa. / MÃ¤ puhun espanjaa ja englantia.",
                grammar: "<strong>En</strong>: å¦å®šåŠ¨è¯ç¬¬ä¸€äººç§°ã€‚<br><strong>en puhu</strong>: å¦å®šç»“æ„ (en + è¯å¹²)ã€‚"
            },
            {
                fi: "Mun Ã¤idinkieli on suomi.",
                zh: "æˆ‘çš„æ¯è¯­æ˜¯èŠ¬å…°è¯­ã€‚",
                category: "dialogue",
                chunks: "Mun Ã¤idinkieli / on suomi",
                grammar: "<strong>suomi</strong>: æ—¢æŒ‡å›½å®¶ä¹ŸæŒ‡è¯­è¨€ã€‚"
            },
            {
                fi: "Hei katso, meidÃ¤n lapset leikkivÃ¤t yhdessÃ¤.",
                zh: "å˜¿ä½ çœ‹ï¼Œå’±ä»¬çš„å­©å­åœ¨ä¸€èµ·ç©å‘¢ã€‚",
                category: "dialogue",
                chunks: "Hei katso (çœ‹) / meidÃ¤n lapset (æˆ‘ä»¬çš„å­©å­) / leikkivÃ¤t yhdessÃ¤ (ä¸€èµ·ç©)",
                grammar: "<strong>katso</strong>: ç¥ˆä½¿å¥ã€‚<br><strong>meidÃ¤n</strong>: å±æ ¼ (æˆ‘ä»¬çš„)ã€‚<br><strong>yhdessÃ¤</strong>: å‰¯è¯ (ä¸€èµ·)ã€‚"
            },
            {
                fi: "Se on hieno juttu! MinkÃ¤ ikÃ¤inen sinun tyttÃ¶ on?",
                zh: "é‚£çœŸä¸é”™ï¼ä½ å¥³å„¿å¤šå¤§äº†ï¼Ÿ",
                category: "dialogue",
                chunks: "Se on hieno juttu (é‚£å¾ˆæ£’)! / MinkÃ¤ ikÃ¤inen (å¤šå¤§) / sinun tyttÃ¶ on?",
                grammar: "<strong>hieno juttu</strong>: å¸¸ç”¨å£è¯­ (å¥½äº‹å„¿)ã€‚<br><strong>MinkÃ¤ ikÃ¤inen</strong>: è¯¢é—®å¹´é¾„çš„æ ‡å‡†æ–¹å¼ã€‚"
            },
            {
                fi: "Sofia on melkein kaksi vuotta.",
                zh: "Sofiaå¿«ä¸¤å²äº†ã€‚",
                category: "dialogue",
                chunks: "Sofia on / melkein (å‡ ä¹) / kaksi vuotta (ä¸¤å²)",
                grammar: "<strong>kaksi vuotta</strong>: æ•°å­—(é™¤1å¤–)åæ¥åè¯éƒ¨åˆ†æ ¼å•æ•°ã€‚"
            },
            {
                fi: "EntÃ¤ sun poika?",
                zh: "é‚£ä½ å„¿å­å‘¢ï¼Ÿ",
                category: "dialogue",
                chunks: "EntÃ¤ (é‚£ä¹ˆ/é‚£...å‘¢) / sun poika?",
                grammar: "<strong>EntÃ¤</strong>: ç”¨äºåé—®æˆ–è½¬ç§»è¯é¢˜ã€‚"
            },
            {
                fi: "Leslie on vÃ¤hÃ¤n yli kaksi vuotta.",
                zh: "Leslieä¸¤å²å¤šä¸€ç‚¹ã€‚",
                category: "dialogue",
                chunks: "Leslie on / vÃ¤hÃ¤n yli (ç¨è¶…è¿‡) / kaksi vuotta",
                grammar: "<strong>yl</strong>: è¶…è¿‡ã€‚"
            },
            {
                fi: "Olisi kiva tutustua paremmin.",
                zh: "å¦‚æœèƒ½å¤šäº†è§£ä¸€ä¸‹/äº¤ä¸ªæœ‹å‹å°±å¥½äº†ã€‚",
                category: "dialogue",
                chunks: "Olisi kiva (é‚£æ˜¯å¾ˆå¥½çš„) / tutustua paremmin (æ›´å¥½åœ°è®¤è¯†)",
                grammar: "<strong>Olisi</strong>: æ¡ä»¶å¼ (å¦‚æœ...å°±å¥½äº†)ï¼Œè¡¨ç¤ºç¤¼è²Œæˆ–æ„¿æœ›ã€‚<br><strong>tutustua</strong>: ç»“è¯†ã€‚"
            },
            {
                fi: "Niin olisi. Asutko sinÃ¤ tÃ¤Ã¤llÃ¤ Kirjalassa?",
                zh: "æ˜¯å•Šã€‚ä½ ä½åœ¨Kirjalaè¿™é‡Œå—ï¼Ÿ",
                category: "dialogue",
                chunks: "Niin olisi (ç¡®å®æ˜¯). / Asutko sinÃ¤ / tÃ¤Ã¤llÃ¤ Kirjalassa?",
                grammar: "<strong>Kirjala-ssa</strong>: åœ°åæ¥å†…æ ¼ã€‚"
            },
            {
                fi: "Joo, mÃ¤ asun tÃ¤ssÃ¤ lÃ¤hellÃ¤. Haluatko tulla meille kahville?",
                zh: "å¯¹ï¼Œæˆ‘ä½åœ¨è¿™é™„è¿‘ã€‚æƒ³æ¥æˆ‘å®¶å–æ¯å’–å•¡å—ï¼Ÿ",
                category: "dialogue",
                chunks: "asun tÃ¤ssÃ¤ lÃ¤hellÃ¤. / Haluatko tulla / meille (å»æˆ‘ä»¬å®¶) / kahville (å–å’–å•¡)?",
                grammar: "<strong>meille</strong>: å‘æ ¼ (Allatiivi)ï¼Œå»æŸäººå®¶ã€‚<br><strong>tulla kahville</strong>: è¿™é‡Œçš„å’–å•¡ç”¨å‘æ ¼ï¼Œè¡¨ç¤ºç›®çš„ã€‚"
            },
            {
                fi: "Joo. HyvÃ¤ idea! KyllÃ¤ minÃ¤ haluan tulla, mutta tÃ¤nÃ¤Ã¤n en voi tulla.",
                zh: "å¥½ä¸»æ„ï¼æˆ‘å¾ˆæƒ³å»ï¼Œä½†ä»Šå¤©ä¸è¡Œã€‚",
                category: "dialogue",
                chunks: "HyvÃ¤ idea! / KyllÃ¤ minÃ¤ haluan / mutta tÃ¤nÃ¤Ã¤n en voi",
                grammar: "<strong>KyllÃ¤</strong>: åœ¨è¿™é‡Œè¡¨ç¤ºå¼ºè°ƒè‚¯å®šçš„æ„æ„¿ã€‚"
            },
            {
                fi: "Minun pitÃ¤Ã¤ mennÃ¤ neuvolaan.",
                zh: "æˆ‘å¾—å»å„¿ç«¥å¥åº·ä¸­å¿ƒã€‚",
                category: "dialogue",
                chunks: "Minun pitÃ¤Ã¤ mennÃ¤ (æˆ‘å¿…é¡»å») / neuvolaan",
                grammar: "<strong>Minun pitÃ¤Ã¤</strong>: å¿…è¦æ€§ç»“æ„ (genitive + pitÃ¤Ã¤ + åŠ¨è¯åŸå½¢)ã€‚<br><strong>neuvolaan</strong>: å…¥æ ¼ (Illatiivi)ï¼Œè¡¨ç¤ºæ–¹å‘ã€‚"
            },
            {
                fi: "Voitko tulla ensi viikolla?",
                zh: "ä½ ä¸‹å‘¨èƒ½æ¥å—ï¼Ÿ",
                category: "dialogue",
                chunks: "Voitko tulla / ensi viikolla (ä¸‹å‘¨)?",
                grammar: "<strong>ensi viikolla</strong>: æ—¶é—´çŠ¶è¯­å¸¸ç”¨æ¥æ ¼ (-lla)ã€‚"
            },
            {
                fi: "Joo, se sopii. Voitko soittaa minulle?",
                zh: "è¡Œï¼Œæ²¡é—®é¢˜ã€‚ä½ èƒ½ç»™æˆ‘æ‰“ä¸ªç”µè¯å—ï¼Ÿ",
                category: "dialogue",
                chunks: "se sopii (é‚£å¾ˆåˆé€‚). / Voitko soittaa / minulle (ç»™æˆ‘)?",
                grammar: "<strong>soittaa + -lle</strong>: æ‰“ç”µè¯ç»™æŸäººç”¨å‘æ ¼ã€‚"
            },
            {
                fi: "Joo, mÃ¤ soitan sulle ensi viikolla.",
                zh: "è¡Œï¼Œæˆ‘ä¸‹å‘¨æ‰“ç»™ä½ ã€‚",
                category: "dialogue",
                chunks: "mÃ¤ soitan / sulle (ç»™ä½ ) / ensi viikolla",
                grammar: "<strong>sulle</strong>: å£è¯­ (sinulle)ã€‚"
            },
            {
                fi: "Mutta nyt mun pitÃ¤Ã¤ mennÃ¤ kotiin! Oli kiva tutustua.",
                zh: "ä½†æˆ‘ç°åœ¨å¾—å›å®¶äº†ï¼å¾ˆé«˜å…´è®¤è¯†ä½ ã€‚",
                category: "dialogue",
                chunks: "mun pitÃ¤Ã¤ mennÃ¤ / kotiin (å›å®¶)! / Oli kiva tutustua.",
                grammar: "<strong>kotiin</strong>: koti çš„å…¥æ ¼ (ä¸è§„åˆ™å˜åŒ–)ã€‚<br><strong>Oli kiva tutustua</strong>: å›ºå®šå®¢å¥—è¯­ã€‚"
            },
            {
                fi: "Joo, niin oli. HyvÃ¤Ã¤ viikonloppua! Hei, hei.",
                zh: "æ˜¯å•Šï¼Œæˆ‘ä¹Ÿæ˜¯ã€‚å‘¨æœ«æ„‰å¿«ï¼æ‹œæ‹œã€‚",
                category: "dialogue",
                chunks: "HyvÃ¤Ã¤ viikonloppua!",
                grammar: "<strong>partitiivi</strong>: ç¥æ„¿è¯­é€šå¸¸ä½¿ç”¨éƒ¨åˆ†æ ¼ã€‚"
            },
            {
                fi: "Kiitos samoin, hauskaa viikonloppua! NÃ¤hdÃ¤Ã¤n taas!",
                zh: "è°¢è°¢ï¼Œä½ ä¹Ÿä¸€æ ·ï¼Œå‘¨æœ«æ„‰å¿«ï¼ä¸‹æ¬¡è§ï¼",
                category: "dialogue",
                chunks: "Kiitos samoin (åŒæ ·åœ°) / hauskaa viikonloppua! / NÃ¤hdÃ¤Ã¤n taas (å†è§)!",
                grammar: "<strong>NÃ¤hdÃ¤Ã¤n</strong>: è¢«åŠ¨è¯­æ€ï¼Œå£è¯­ä¸­è¡¨ç¤ºâ€œæˆ‘ä»¬å°†ä¼šè§é¢/å†è§â€ã€‚"
            }
        ];

        // æ¸²æŸ“å¡ç‰‡
        const container = document.getElementById('cardContainer');

        lessonData.forEach((item, index) => {
            const card = document.createElement('div');
            card.className = 'card';
            
            // ç¡®å®šç±»åˆ«æ ‡ç­¾æ ·å¼å’Œæ–‡å­—
            const catClass = item.category === 'intro' ? 'cat-intro' : 'cat-dialogue';
            const catText = item.category === 'intro' ? 'Tausta' : 'Dialogi';

            card.innerHTML = `
                <div class="card-inner">
                    <div class="card-front">
                        <span class="card-number">${index + 1}</span>
                        <span class="card-category ${catClass}">${catText}</span>
                        <div class="fi-text">${item.fi}</div>
                        <button class="tts-btn" onclick="speak(this, '${item.fi.replace(/'/g, "\\'")}')" title="å¬å‘éŸ³">ğŸ”Š</button>
                        <div class="flip-hint">ç‚¹å‡»æŸ¥çœ‹è§£æ</div>
                    </div>
                    <div class="card-back">
                        <h3>è¯­è¨€ç»„å— (Chunks)</h3>
                        <div class="chunk-box">${item.chunks}</div>
                        
                        <h3>è¯­æ³•åˆ†æ (Kielioppi)</h3>
                        <div class="grammar-text">${item.grammar}</div>
                        
                        <h3>ä¸­æ–‡ç¿»è¯‘ (KÃ¤Ã¤nnÃ¶s)</h3>
                        <div class="zh-text">${item.zh}</div>
                    </div>
                </div>
            `;

            // ç‚¹å‡»å¡ç‰‡ç¿»è½¬é€»è¾‘ï¼ˆæ’é™¤æŒ‰é’®ç‚¹å‡»ï¼‰
            card.addEventListener('click', (e) => {
                if (!e.target.closest('.tts-btn')) {
                    card.classList.toggle('is-flipped');
                }
            });

            container.appendChild(card);
        });

        // TTS è¯­éŸ³åŠŸèƒ½
        let currentBtn = null;

        function speak(btn, text) {
            // å¦‚æœæ­£åœ¨æ’­æ”¾å£°éŸ³ï¼Œç›´æ¥è¿”å›ï¼ˆæŒ‰é’®æ— æ•ˆï¼‰
            if (window.speechSynthesis.speaking) {
                return;
            }

            // è®°å½•å½“å‰æŒ‰é’®
            currentBtn = btn;

            // è®¾ç½®æ–°è¯­éŸ³
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'fi-FI'; // èŠ¬å…°è¯­
            utterance.rate = 0.85; // ç¨æ…¢è¯­é€Ÿé€‚åˆç²¾è¯»

            // æŒ‰é’®åŠ¨ç”»çŠ¶æ€
            btn.classList.add('playing');
            btn.textContent = 'ğŸ”‡';

            utterance.onend = () => {
                if (btn === currentBtn) { // ç¡®ä¿åŠ¨ç”»åªå½±å“å½“å‰æŒ‰é’®
                    btn.classList.remove('playing');
                    btn.textContent = 'ğŸ”Š';
                }
            };

            utterance.onerror = (e) => {
                console.error('TTS Error:', e);
                if (btn === currentBtn) {
                    btn.classList.remove('playing');
                    btn.textContent = 'ğŸ”Š';
                }
                // é™çº§æ–¹æ¡ˆï¼ˆå¯é€‰ï¼‰
                fallbackAudio(text);
            };

            window.speechSynthesis.speak(utterance);
        }

        function fallbackAudio(text) {
            const url = `https://translate.google.com/translate_tts?ie=UTF-8&client=tw-ob&q=${encodeURIComponent(text)}&tl=fi`;
            new Audio(url).play();
        }
    </script>
</body>
</html>