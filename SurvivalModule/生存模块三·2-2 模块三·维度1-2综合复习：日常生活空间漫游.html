<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>èŠ¬å…°è¯­æ¨¡å—ä¸‰Â·ç»´åº¦1&2ä¸æ¨¡å—äºŒç»¼åˆå¤ä¹  (èŒƒå›´é™å®šç‰ˆTTS)</title>
    <style>
        body { font-family: "Microsoft YaHei", sans-serif; line-height: 1.7; margin: 20px auto; max-width: 900px; padding: 0 20px; color: #333; background-color: #f9f9f9; }
        h1, h2, h3, h4, h5 { color: #2c3e50; }
        h1 { text-align: center; margin-bottom: 35px; font-size: 2.2em; }
        h2 { border-bottom: 2px solid #27ae60; padding-bottom: 12px; margin-top: 45px; font-size: 1.8em; color: #27ae60; }
        h3 { margin-top: 30px; font-size: 1.5em; color: #2ecc71; }
        h4 { font-size: 1.3em; color: #8e44ad; margin-top:25px; margin-bottom:15px; }
        h5 { font-size: 1.1em; color: #34495e; margin-top:20px; margin-bottom:10px;}

        table { width: 100%; border-collapse: collapse; margin-bottom: 25px; display: block; overflow-x: auto; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: left; vertical-align: top;}
        thead { background-color: #e9ecef; }
        
        .review-section-card, .scene-card, .summary-card, .example {
            background-color: #fff; border: 1px solid #e0e0e0; border-radius: 8px; padding: 20px; margin-bottom: 30px; box-shadow: 0 4px 10px rgba(0,0,0,0.08);
        }
        .example, .scene-card { border-left: 6px solid #27ae60 !important; }
        
        .dialogue-step { margin-bottom: 20px; padding-left: 20px; border-left: 3px solid #f1c40f; background-color: #fefefe; padding:15px; border-radius: 0 5px 5px 0;}
        .dialogue-step img { max-width: 120px; height: auto; border-radius: 4px; float: right; margin-left: 15px; margin-bottom:10px; border: 1px solid #eee; }
        .dialogue-step p { margin: 8px 0; font-size: 1.1em; clear: right; }
        
        .finnish-phrase { font-weight: bold; color: #27ae60; font-size: 1.1em; }
        .chinese-sense, .note { font-size: 0.95em; color: #555; font-style: italic; }
        .tts-button { background: none; border: none; cursor: pointer; font-size: 1.2em; margin-left: 8px; padding: 0; display: inline-block; vertical-align: middle; color: #27ae60; }
        .tts-button:hover { color: #229954; opacity: 0.8; }
        
        .debug-section { background-color: #fffbf0; border: 2px solid #ffa500; padding: 15px; margin: 20px 0; border-radius: 8px; }
        .debug-button { background-color: #4CAF50; color: white; padding: 8px 16px; margin: 5px; border: none; border-radius: 4px; cursor: pointer; }
        .debug-button:hover { background-color: #45a049; }
        .highlight { color: #c0392b; font-weight: bold; }
        hr { border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0,0,0,0), rgba(39,174,96,0.4), rgba(0,0,0,0)); margin: 40px 0; }
        
        .final-summary-list { list-style-type: none; padding-left:0; }
        .final-summary-list li { margin-bottom: 10px; font-size: 1.1em;}
        .final-summary-list .finnish-phrase { font-weight: normal;}

        .interactive-question { margin-top: 20px; padding: 15px; background-color: #ecf0f1; border-radius: 5px; border: 1px solid #bdc3c7;}
        .interactive-question p { margin-bottom: 10px; font-weight: bold; }
        .interactive-question button { background-color: #3498db; color:white; border:none; padding: 10px 15px; margin: 5px; border-radius: 4px; cursor:pointer; font-size: 1em; }
        .interactive-question button:hover { background-color: #2980b9;}
        .feedback { margin-top: 10px; font-weight: bold; padding: 8px; border-radius: 3px; }
        .correct { color: #27ae60; background-color: #e8f8f5; border: 1px solid #a3e4d7;}
        .incorrect { color: #c0392b; background-color: #fdedec; border: 1px solid #f5b7b1;}
    </style>
</head>
<body>

    <h1>ğŸ› ï¸ æ¨¡å—ä¸‰Â·ç»´åº¦1&2ä¸æ¨¡å—äºŒç»¼åˆå¤ä¹  (èŒƒå›´é™å®šä¼˜åŒ–ç‰ˆ)</h1>

    <!-- TTSè°ƒè¯•åŒºåŸŸ -->
    <div class="debug-section">
        <h3>ğŸ”§ TTSåŠŸèƒ½æµ‹è¯• (æ¨¡å—ä¸‰ ç»¼åˆå¤ä¹  - èŒƒå›´é™å®š)</h3>
        <p>å¦‚æœTTSæŒ‰é’®æ²¡æœ‰å£°éŸ³ï¼Œè¯·å…ˆæµ‹è¯•ä»¥ä¸‹åŠŸèƒ½ï¼š</p>
        <button class="debug-button" onclick="testBasicTTS()">æµ‹è¯•åŸºæœ¬TTS</button>
        <button class="debug-button" onclick="testFinnishTTSModule3_Review_Scope()">æµ‹è¯•èŠ¬å…°è¯­TTS (æ¨¡å—3å¤ä¹ é™å®š)</button>
        <button class="debug-button" onclick="listVoices()">æŸ¥çœ‹å¯ç”¨è¯­éŸ³</button>
        <button class="debug-button" onclick="removeDebugSection()">ç§»é™¤è°ƒè¯•åŒºåŸŸ</button>
        <div id="debug-output" style="margin-top: 10px; padding: 10px; background-color: #f0f0f0; border-radius: 4px; font-family: monospace; font-size: 12px; max-height: 200px; overflow-y: auto;"></div>
    </div>

    <hr>

    <section id="review-intro" class="review-section-card">
        <h2>ğŸš€ å‡çº§ä½ çš„èŠ¬å…°è¯­å·¥å…·ç®±ï¼šç©ºé—´ä¸éœ€æ±‚çš„å®Œç¾ç»“åˆï¼</h2>
        <p><span class="speakable-finnish">Onneksi olkoon! Olet oppinut jo paljon tilasta ja tarpeista!</span> (æ­å–œï¼ä½ å·²ç»å­¦äº†å¾ˆå¤šå…³äºç©ºé—´å’Œéœ€æ±‚çš„çŸ¥è¯†äº†ï¼ <span class="note speakable-finnish">tila=ç©ºé—´, tarve=éœ€æ±‚</span>)</p>
        <p>ç°åœ¨ï¼Œä½ ä¸ä»…çŸ¥é“æ€ä¹ˆè¯´ï¼š</p>
        <ul style="list-style-type: 'âœ… '; padding-left: 20px;">
            <li>â€œåœ¨æˆ¿å­<span class="highlight">é‡Œ</span>â€(<span class="finnish-phrase speakable-finnish">talossa</span>)</li>
            <li>â€œåœ¨æ¡Œå­<span class="highlight">ä¸Š</span>â€(<span class="finnish-phrase speakable-finnish">pÃ¶ydÃ¤llÃ¤</span>)</li>
        </ul>
        <p>è¿˜èƒ½ç»“åˆæ¨¡å—äºŒçš„çŸ¥è¯†ï¼Œè¡¨è¾¾ï¼š</p>
        <ul style="list-style-type: 'ğŸ›’ '; padding-left: 20px;">
            <li>â€œæˆ‘æƒ³è¦â€(<span class="speakable-finnish">Haluan</span>)</li>
            <li>â€œæˆ‘éœ€è¦â€(<span class="speakable-finnish">Tarvitsen</span>)</li>
            <li>â€œæˆ‘å–œæ¬¢â€(<span class="speakable-finnish">PidÃ¤n</span>)</li>
            <li>â€œæˆ‘åƒ/å–â€(<span class="speakable-finnish">SyÃ¶n/Juon</span>)</li>
        </ul>
        <p>æ˜¯æ—¶å€™æŠŠè¿™äº›å·¥å…·éƒ½æ‹¿å‡ºæ¥ï¼Œçœ‹çœ‹å®ƒä»¬åœ¨æˆ‘ä»¬çš„æ—¥å¸¸ç”Ÿæ´»ä¸­æ˜¯å¦‚ä½•ä¸€èµ·å·¥ä½œçš„äº†ï¼å‡†å¤‡å¥½äº†å—ï¼Ÿè®©æˆ‘ä»¬å¼€å§‹ä¸€æ®µèŠ¬å…°è¯­çš„â€œæ—¥å¸¸ç”Ÿæ´»ç©ºé—´æ¼«æ¸¸â€å§ï¼</p>
    </section>

    <hr>

    <section id="scenario-combo-1-home-morning">
        <h2>ç»¼åˆåœºæ™¯ä¸€ï¼šå®¶é‡Œçš„æ—©æ™¨æ•´ç†æ—¶å…‰ â˜€ï¸ğŸ§º</h2>
        <div class="scene-card">
            <h4><span class="speakable-finnish">Aamu kotona: Tavarat paikoilleen</span> (å®¶é‡Œçš„æ—©æ™¨ï¼šç‰©å“å½’ä½)</h4>
            <p class="note">åœºæ™¯æè¿°ï¼šè¿™æ˜¯æ˜ŸæœŸå…­çš„æ—©ä¸Šï¼Œä½ ï¼ˆ<span class="speakable-finnish">MinÃ¤</span>ï¼‰æ­£åœ¨å®¶é‡Œæ•´ç†ä¸œè¥¿ï¼Œå‡†å¤‡åƒæ—©é¤ã€‚ä½ çš„æœ‹å‹ï¼ˆ<span class="speakable-finnish">SinÃ¤</span>ï¼‰ä¹Ÿåœ¨ã€‚</p>

            <div class="dialogue-step">
                <img src="https://images.pexels.com/photos/370799/pexels-photo-370799.jpeg?auto=compress&cs=tinysrgb&w=300" alt="æ•´ç†ä¹¦æ¡Œ">
                <h5>1. ä½  (MinÃ¤) æ•´ç†ä¹¦æ¡Œä¸Šçš„ä¹¦ï¼š</h5>
                <p><span class="speakable-finnish">MinÃ¤ sanon: "Minun kirja on <span class="finnish-phrase">pÃ¶ydÃ¤llÃ¤</span>. MinÃ¤ haluan laittaa sen <span class="finnish-phrase">hyllyyn</span>."</span> <span class="note">(æˆ‘è¯´ï¼šâ€œæˆ‘çš„ä¹¦åœ¨æ¡Œå­<span class="highlight">ä¸Š</span>ã€‚æˆ‘æƒ³è¦æŠŠå®ƒæ”¾åˆ°ä¹¦æ¶<span class="highlight">é‡Œ</span>ã€‚â€ <span class="speakable-finnish">hylly</span>=ä¹¦æ¶, <span class="speakable-finnish">sen</span>=å®ƒ)</span></p>
                <p><span class="speakable-finnish">MinÃ¤ otan kirjan <span class="finnish-phrase">pÃ¶ydÃ¤ltÃ¤</span> ja laitan sen <span class="finnish-phrase">hyllyyn</span>. Nyt se on <span class="finnish-phrase">hyllyssÃ¤</span>.</span> <span class="note">(æˆ‘ä»æ¡Œå­<span class="highlight">ä¸Š</span>æ‹¿èµ·ä¹¦ï¼ŒæŠŠå®ƒæ”¾åˆ°ä¹¦æ¶<span class="highlight">é‡Œ</span>ã€‚ç°åœ¨å®ƒåœ¨ä¹¦æ¶<span class="highlight">é‡Œ</span>äº†ã€‚)</span></p>
                <p class="chinese-sense">æ··åˆæ„ŸçŸ¥ï¼š<span class="finnish-phrase speakable-finnish">pÃ¶ydÃ¤llÃ¤</span> (ç»´åº¦äºŒï¼šåœ¨è¡¨é¢), <span class="finnish-phrase speakable-finnish">hyllyyn</span> (ç»´åº¦ä¸€ï¼šåˆ°å®¹å™¨é‡Œ), <span class="finnish-phrase speakable-finnish">pÃ¶ydÃ¤ltÃ¤</span> (ç»´åº¦äºŒï¼šä»è¡¨é¢ç¦»å¼€), <span class="finnish-phrase speakable-finnish">hyllyssÃ¤</span> (ç»´åº¦ä¸€ï¼šåœ¨å®¹å™¨é‡Œ)ã€‚åŠ¨è¯ <span class="speakable-finnish">Haluan</span> (æ¨¡å—äºŒ)ã€‚</p>
            </div>

            <div class="dialogue-step">
                <img src="https://images.pexels.com/photos/4245096/pexels-photo-4245096.jpeg?auto=compress&cs=tinysrgb&w=300" alt="æœ‹å‹å¸®å¿™æ”¾æ¯å­">
                <h5>2. æœ‹å‹ (SinÃ¤) çœ‹åˆ°ä¸€ä¸ªæ¯å­ï¼š</h5>
                <p><span class="speakable-finnish">SinÃ¤ kysyt: "MissÃ¤ tÃ¤mÃ¤ kuppi on yleensÃ¤? Laitanko minÃ¤ sen <span class="finnish-phrase">pÃ¶ydÃ¤lle</span>?"</span> <span class="note">(ä½ é—®ï¼šâ€œè¿™ä¸ªæ¯å­é€šå¸¸åœ¨å“ªé‡Œï¼Ÿæˆ‘æŠŠå®ƒæ”¾åˆ°æ¡Œå­<span class="highlight">ä¸Š</span>å—ï¼Ÿâ€ <span class="speakable-finnish">yleensÃ¤</span>=é€šå¸¸, <span class="speakable-finnish">kuppi</span>=æ¯å­)</span></p>
                <p><span class="speakable-finnish">MinÃ¤ vastaan: "Ei, se on minun kuppi. Se on yleensÃ¤ <span class="finnish-phrase">kaapissa</span>. Voitko sinÃ¤ ottaa sen <span class="finnish-phrase">pÃ¶ydÃ¤ltÃ¤</span> ja laittaa sen <span class="finnish-phrase">kaappiin</span>, kiitos."</span> <span class="note">(æˆ‘å›ç­”ï¼šâ€œä¸ï¼Œé‚£æ˜¯æˆ‘çš„æ¯å­ã€‚å®ƒé€šå¸¸åœ¨æ©±æŸœ<span class="highlight">é‡Œ</span>ã€‚ä½ èƒ½æŠŠå®ƒä»æ¡Œå­<span class="highlight">ä¸Š</span>æ‹¿å¼€å¹¶æ”¾åˆ°æ©±æŸœ<span class="highlight">é‡Œ</span>å—ï¼Œè°¢è°¢ï¼Ÿâ€ <span class="speakable-finnish">kaappi</span>=æ©±æŸœ)</span></p>
                <p class="chinese-sense">æ··åˆæ„ŸçŸ¥ï¼š<span class="finnish-phrase speakable-finnish">pÃ¶ydÃ¤lle</span> (ç»´åº¦äºŒ), <span class="finnish-phrase speakable-finnish">kaapissa</span> (ç»´åº¦ä¸€), <span class="finnish-phrase speakable-finnish">pÃ¶ydÃ¤ltÃ¤</span> (ç»´åº¦äºŒ), <span class="finnish-phrase speakable-finnish">kaappiin</span> (ç»´åº¦ä¸€)ã€‚</p>
            </div>

            <div class="dialogue-step">
                <img src="https://images.pexels.com/photos/618079/pexels-photo-618079.jpeg?auto=compress&cs=tinysrgb&w=300" alt="åƒæ—©é¤">
                <h5>3. å‡†å¤‡åƒæ—©é¤ï¼š</h5>
                <p><span class="speakable-finnish">MinÃ¤ sanon: "Nyt minÃ¤ haluan syÃ¶dÃ¤ aamiaista. MinÃ¤ istun <span class="finnish-phrase">tuolille</span>."</span> <span class="note">(æˆ‘è¯´ï¼šâ€œç°åœ¨æˆ‘æƒ³è¦åƒæ—©é¤ã€‚æˆ‘ååˆ°æ¤…å­<span class="highlight">ä¸Š</span>ã€‚â€ <span class="speakable-finnish">aamiainen</span>=æ—©é¤)</span></p>
                <p><span class="speakable-finnish">SinÃ¤ sanot: "HyvÃ¤ idea! MinÃ¤ myÃ¶s. MinÃ¤ otan leivÃ¤n <span class="finnish-phrase">pÃ¶ydÃ¤ltÃ¤</span>."</span> <span class="note">(ä½ è¯´ï¼šâ€œå¥½ä¸»æ„ï¼æˆ‘ä¹Ÿæ˜¯ã€‚æˆ‘ä»æ¡Œå­<span class="highlight">ä¸Š</span>æ‹¿é¢åŒ…ã€‚â€ <span class="speakable-finnish">leipÃ¤</span>=é¢åŒ…)</span></p>
                <p><span class="speakable-finnish">MinÃ¤ juon kahvia <span class="finnish-phrase">kupista</span>. Kahvi on <span class="finnish-phrase">kupissa</span>.</span> <span class="note">(æˆ‘ä»æ¯å­<span class="highlight">é‡Œ</span>å–å’–å•¡ã€‚å’–å•¡åœ¨æ¯å­<span class="highlight">é‡Œ</span>ã€‚)</span></p>
                <p class="chinese-sense">æ··åˆæ„ŸçŸ¥ï¼š<span class="finnish-phrase speakable-finnish">tuolille</span> (ç»´åº¦äºŒ), <span class="finnish-phrase speakable-finnish">pÃ¶ydÃ¤ltÃ¤</span> (ç»´åº¦äºŒ), <span class="finnish-phrase speakable-finnish">kupista</span> (ç»´åº¦ä¸€), <span class="finnish-phrase speakable-finnish">kupissa</span> (ç»´åº¦ä¸€)ã€‚åŠ¨è¯ <span class="speakable-finnish">Haluan syÃ¶dÃ¤</span>, <span class="speakable-finnish">Juon</span> (æ¨¡å—äºŒ)ã€‚</p>
            </div>

            <div class="interactive-question">
                <p><strong>å°æµ‹éªŒ1ï¼š</strong>åœ¨ä¸Šé¢çš„å¯¹è¯ä¸­ï¼Œå½“æˆ‘è¯´â€œæˆ‘çš„æ¯å­åœ¨æ©±æŸœ<span class="highlight">é‡Œ</span>â€ (<span class="finnish-phrase speakable-finnish">Minun kuppi on kaapissa</span>) æ—¶ï¼Œ<span class="finnish-phrase speakable-finnish">kaapissa</span> è¡¨è¾¾çš„æ˜¯å“ªä¸ªç©ºé—´ç»´åº¦å’ŒçŠ¶æ€ï¼Ÿ</p>
                <button onclick="checkReviewAnswer('q_kitchen_1', 'dim1_static_inside')">ç»´åº¦ä¸€ï¼šåœ¨å°é—­å®¹å™¨é‡Œé¢</button>
                <button onclick="checkReviewAnswer('q_kitchen_1', 'dim2_on_surface')">ç»´åº¦äºŒï¼šåœ¨ç‰©ä½“è¡¨é¢ä¸Š</button>
                <button onclick="checkReviewAnswer('q_kitchen_1', 'dim1_from_inside')">ç»´åº¦ä¸€ï¼šä»å°é—­å®¹å™¨å‡ºæ¥</button>
                <div id="q_kitchen_1_feedback" class="feedback"></div>
            </div>
        </div>
    </section>

    <hr>

    <section id="scenario-combo-2-errands">
        <h2>ç»¼åˆåœºæ™¯äºŒï¼šå»å•†åº—ä¹°ä¸œè¥¿ ğŸ›ï¸ğŸ›’</h2>
        <div class="scene-card">
            <h4><span class="speakable-finnish">Ostoksilla kaupassa</span> (åœ¨å•†åº—è´­ç‰©)</h4>
            <p class="note">åœºæ™¯æè¿°ï¼šä½ ï¼ˆ<span class="speakable-finnish">MinÃ¤</span>ï¼‰éœ€è¦å»å•†åº—ä¹°ç‰›å¥¶ã€‚ä½ çš„æœ‹å‹ï¼ˆ<span class="speakable-finnish">SinÃ¤</span>ï¼‰å’Œä½ ä¸€èµ·å»ã€‚</p>

            <div class="dialogue-step">
                 <img src="https://images.pexels.com/photos/5390341/pexels-photo-5390341.jpeg?auto=compress&cs=tinysrgb&w=300" alt="å‡†å¤‡å‡ºé—¨">
                <h5>1. ä½  (MinÃ¤) å‡†å¤‡å‡ºé—¨ï¼š</h5>
                <p><span class="speakable-finnish">MinÃ¤ sanon: "MinÃ¤ tarvitsen minun laukun. Se on <span class="finnish-phrase">tuolilla</span>."</span> <span class="note">(æˆ‘è¯´ï¼šâ€œæˆ‘éœ€è¦æˆ‘çš„åŒ…ã€‚å®ƒåœ¨æ¤…å­<span class="highlight">ä¸Š</span>ã€‚â€)</span></p>
                <p><span class="speakable-finnish">MinÃ¤ otan laukun <span class="finnish-phrase">tuolilta</span> ja laitan avaimen <span class="finnish-phrase">laukkuun</span>.</span> <span class="note">(æˆ‘ä»æ¤…å­<span class="highlight">ä¸Š</span>æ‹¿èµ·åŒ…ï¼Œç„¶åæŠŠé’¥åŒ™æ”¾è¿›åŒ…<span class="highlight">é‡Œ</span>ã€‚)</span></p>
                 <p class="chinese-sense">æ··åˆæ„ŸçŸ¥ï¼š<span class="finnish-phrase speakable-finnish">tuolilla</span> (ç»´åº¦äºŒ), <span class="finnish-phrase speakable-finnish">tuolilta</span> (ç»´åº¦äºŒ), <span class="finnish-phrase speakable-finnish">laukkuun</span> (ç»´åº¦ä¸€)ã€‚åŠ¨è¯ <span class="speakable-finnish">Tarvitsen</span> (æ¨¡å—äºŒ)ã€‚</p>
            </div>

            <div class="dialogue-step">
                <img src="https://images.pexels.com/photos/7084313/pexels-photo-7084313.jpeg?auto=compress&cs=tinysrgb&w=300" alt="ä¸¤äººèµ°å‘å•†åº—">
                <h5>2. ä½ å’Œæœ‹å‹ (SinÃ¤) å‡ºé—¨å»å•†åº—ï¼š</h5>
                <p><span class="speakable-finnish">MinÃ¤ sanon sinulle: "MennÃ¤Ã¤n <span class="finnish-phrase">kauppaan</span> nyt."</span> <span class="note">(æˆ‘å¯¹ä½ è¯´ï¼šâ€œæˆ‘ä»¬ç°åœ¨å»å•†åº—<span class="highlight">é‡Œ</span>ã€‚â€ <span class="note speakable-finnish">sinulle</span>=å¯¹ä½ )</span></p>
                <p><span class="speakable-finnish">SinÃ¤ vastaat: "KyllÃ¤, mennÃ¤Ã¤n! MinÃ¤ haluan ostaa myÃ¶s leipÃ¤Ã¤ <span class="finnish-phrase">kaupasta</span>."</span> <span class="note">(ä½ å›ç­”ï¼šâ€œå¥½ï¼Œæˆ‘ä»¬èµ°ï¼æˆ‘ä¹Ÿæƒ³ä»å•†åº—<span class="highlight">é‡Œ</span>ä¹°é¢åŒ…ã€‚â€)</span></p>
                <p class="chinese-sense">æ··åˆæ„ŸçŸ¥ï¼š<span class="finnish-phrase speakable-finnish">kauppaan</span> (ç»´åº¦ä¸€), <span class="finnish-phrase speakable-finnish">kaupasta</span> (ç»´åº¦ä¸€)ã€‚åŠ¨è¯ <span class="speakable-finnish">Haluan ostaa</span> (æ¨¡å—äºŒ)ã€‚</p>
            </div>

            <div class="dialogue-step">
                 <img src="https://images.pexels.com/photos/3944454/pexels-photo-3944454.jpeg?auto=compress&cs=tinysrgb&w=300" alt="åœ¨å•†åº—é‡Œæ‰¾ç‰›å¥¶">
                <h5>3. åœ¨å•†åº—é‡Œ (Kaupassa)ï¼š</h5>
                <p><span class="speakable-finnish">MinÃ¤ sanon: "MissÃ¤ maito on? Ah, se on <span class="finnish-phrase">hyllyllÃ¤</span>."</span> <span class="note">(æˆ‘è¯´ï¼šâ€œç‰›å¥¶åœ¨å“ªé‡Œï¼Ÿå•Šï¼Œå®ƒåœ¨æ¶å­<span class="highlight">ä¸Š</span>ã€‚â€)</span></p>
                <p><span class="speakable-finnish">SinÃ¤ sanot: "MinÃ¤ nÃ¤en sen. MinÃ¤ otan maidon <span class="finnish-phrase">hyllyltÃ¤</span>."</span> <span class="note">(ä½ è¯´ï¼šâ€œæˆ‘çœ‹è§äº†ã€‚æˆ‘ä»æ¶å­<span class="highlight">ä¸Š</span>æ‹¿ç‰›å¥¶ã€‚â€)</span></p>
                <p class="chinese-sense">æ··åˆæ„ŸçŸ¥ï¼š<span class="finnish-phrase speakable-finnish">hyllyllÃ¤</span> (ç»´åº¦äºŒ), <span class="finnish-phrase speakable-finnish">hyllyltÃ¤</span> (ç»´åº¦äºŒ)ã€‚</p>
            </div>
            
            <div class="dialogue-step">
                 <img src="https://images.pexels.com/photos/5632402/pexels-photo-5632402.jpeg?auto=compress&cs=tinysrgb&w=300" alt="ç»“è´¦ç¦»å¼€å•†åº—">
                <h5>4. ç»“è´¦ç¦»å¼€ï¼š</h5>
                <p><span class="speakable-finnish">MinÃ¤ sanon: "MinÃ¤ otan tÃ¤mÃ¤n maidon. En tarvitse muuta, kiitos."</span> <span class="note">(æˆ‘è¯´ï¼šâ€œæˆ‘æ‹¿è¿™ä¸ªç‰›å¥¶ã€‚æˆ‘ä¸éœ€è¦åˆ«çš„äº†ï¼Œè°¢è°¢ã€‚â€)</span></p>
                <p><span class="speakable-finnish">SinÃ¤ sanot: "SelvÃ¤. Sitten me tulemme <span class="finnish-phrase">kaupasta</span> ja menemme <span class="finnish-phrase">kotiin</span>. MinÃ¤ haluan juoda maitoa <span class="finnish-phrase">kotona</span>!"</span> <span class="note">(ä½ è¯´ï¼šâ€œå¥½çš„ã€‚ç„¶åæˆ‘ä»¬ä»å•†åº—<span class="highlight">é‡Œ</span>å‡ºæ¥ï¼Œå›å®¶ã€‚æˆ‘æƒ³åœ¨å®¶<span class="highlight">é‡Œ</span>å–ç‰›å¥¶ï¼â€)</span></p>
                 <p class="chinese-sense">æ··åˆæ„ŸçŸ¥ï¼š<span class="finnish-phrase speakable-finnish">kaupasta</span>, <span class="finnish-phrase speakable-finnish">kotiin</span>, <span class="finnish-phrase speakable-finnish">kotona</span> (ç»´åº¦ä¸€)ã€‚åŠ¨è¯ <span class="speakable-finnish">En tarvitse</span>, <span class="speakable-finnish">Haluan juoda</span> (æ¨¡å—äºŒ)ã€‚</p>
            </div>

             <div class="interactive-question">
                <p><strong>å°æµ‹éªŒ2ï¼š</strong>å½“æˆ‘è¯´â€œç‰›å¥¶åœ¨æ¶å­<span class="highlight">ä¸Š</span>â€ (<span class="finnish-phrase speakable-finnish">Maito on hyllyllÃ¤</span>)ï¼Œè¿™ä¸ª <span class="finnish-phrase speakable-finnish">-llÃ¤</span> çš„â€œå°¾éŸ³æ„Ÿè§‰â€ä¸»è¦è¡¨è¾¾ä»€ä¹ˆï¼Ÿ</p>
                <button onclick="checkReviewAnswer('q_errands_1', 'on_surface_static')">ç‰©ä½“åœ¨æŸä¸ªè¡¨é¢ä¸Š</button>
                <button onclick="checkReviewAnswer('q_errands_1', 'into_container')">ç‰©ä½“è¿›å…¥ä¸€ä¸ªå°é—­ç©ºé—´</button>
                <button onclick="checkReviewAnswer('q_errands_1', 'from_surface')">ç‰©ä½“ä»æŸä¸ªè¡¨é¢ç¦»å¼€</button>
                <div id="q_errands_1_feedback" class="feedback"></div>
            </div>
        </div>
    </section>

    <hr>
    
    <section id="review-language-bleeding-plan" class="practice-plan-card">
        <h2>ç»¼åˆâ€œè¯­è¨€å‡ºè¡€â€è®¡åˆ’ï¼šæˆ‘çš„æˆ¿é—´æ•´ç†ä¸å°æ†© ğŸ§¹ğŸ›‹ï¸</h2>
        <p>ç°åœ¨ï¼Œè½®åˆ°ä½ äº†ï¼æƒ³è±¡ä¸€ä¸‹ä½ åœ¨æ•´ç†è‡ªå·±çš„æˆ¿é—´ï¼Œç„¶åæƒ³åœ¨æ²™å‘ä¸Šä¼‘æ¯ä¸€ä¸‹ã€‚è¯•ç€ç”¨èŠ¬å…°è¯­æè¿°è¿™ä¸ªè¿‡ç¨‹ï¼Œå°½é‡ç”¨åˆ°ä»Šå¤©å¤ä¹ çš„æ¨¡å—äºŒå’Œæ¨¡å—ä¸‰ç»´åº¦ä¸€ã€äºŒçš„è¡¨è¾¾ã€‚</p>
        <div class="usage-example">
            <p><strong>é€ å¥æç¤º (ä½ å¯ä»¥æ›¿æ¢æ‹¬å·é‡Œçš„å†…å®¹ï¼Œå¹¶ä¸»è¦ä½¿ç”¨<span class="speakable-finnish">MinÃ¤</span>å’Œ<span class="speakable-finnish">SinÃ¤</span>)ï¼š</strong></p>
            <p><span class="speakable-finnish">MinÃ¤ olen minun <span class="finnish-phrase">[<u>missÃ¤? esim. huoneessa</u>]</span>.</span> <span class="note">(æˆ‘åœ¨æˆ‘çš„[<u>å“ªé‡Œï¼Ÿä¾‹å¦‚ æˆ¿é—´<span class="highlight">é‡Œ</span></u>]ã€‚)</span></p>
            <p><span class="speakable-finnish">Minun kirja on <span class="finnish-phrase">[<u>millÃ¤? esim. lattialla</u>]</span>. Se ei ole hyvÃ¤ paikka.</span> <span class="note">(æˆ‘çš„ä¹¦åœ¨[<u>ä»€ä¹ˆ<span class="highlight">ä¸Š</span>ï¼Ÿä¾‹å¦‚ åœ°æ¿ä¸Š</u>]ã€‚é‚£ä¸æ˜¯ä¸ªå¥½åœ°æ–¹ã€‚ <span class="speakable-finnish">paikka</span>=åœ°æ–¹)</span></p>
            <p><span class="speakable-finnish">MinÃ¤ otan kirjan <span class="finnish-phrase">[<u>mistÃ¤? esim. lattialta</u>]</span> ja laitan sen <span class="finnish-phrase">[<u>mihin? esim. pÃ¶ydÃ¤lle tai hyllyyn</u>]</span>.</span> <span class="note">(æˆ‘ä»[<u>å“ªé‡Œ<span class="highlight">ä¸Š</span>ï¼Ÿä¾‹å¦‚ åœ°æ¿ä¸Š</u>]æ‹¿èµ·ä¹¦ï¼Œç„¶åæŠŠå®ƒæ”¾åˆ°[<u>å“ªé‡Œ<span class="highlight">ä¸Š/é‡Œ</span>ï¼Ÿä¾‹å¦‚ æ¡Œå­ä¸Šæˆ–ä¹¦æ¶é‡Œ</u>]ã€‚)</span></p>
            <p><span class="speakable-finnish">Nyt minÃ¤ haluan levÃ¤tÃ¤. MinÃ¤ menen <span class="finnish-phrase">[<u>minne? esim. sohvalle</u>]</span>.</span> <span class="note">(ç°åœ¨æˆ‘æƒ³è¦ä¼‘æ¯ã€‚æˆ‘å»[<u>å“ªé‡Œ<span class="highlight">ä¸Š</span>ï¼Ÿä¾‹å¦‚ æ²™å‘ä¸Š</u>]ã€‚<span class="speakable-finnish">levÃ¤tÃ¤</span>=ä¼‘æ¯, <span class="speakable-finnish">sohva</span>=æ²™å‘)</span></p>
            <p><span class="speakable-finnish">MinÃ¤ istun <span class="finnish-phrase">[<u>millÃ¤? esim. sohvalla</u>]</span> ja juon [<u>mitÃ¤? esim. vettÃ¤</u>]. MinÃ¤ pidÃ¤n tÃ¤stÃ¤ vedestÃ¤.</span> <span class="note">(æˆ‘<span style="text-decoration: underline;">ååœ¨</span>[<u>ä»€ä¹ˆ<span class="highlight">ä¸Š</span>ï¼Ÿä¾‹å¦‚ æ²™å‘ä¸Š</u>] <span style="text-decoration: underline;">å–</span>[<u>ä»€ä¹ˆï¼Ÿä¾‹å¦‚ æ°´</u>]ã€‚æˆ‘<span style="text-decoration: underline;">å–œæ¬¢</span>è¿™æ°´ã€‚)</span></p>
        </div>
    </section>

    <hr>

    <section id="review-summary-final" class="summary-card">
        <h2>âœ¨ ä½ çš„èŠ¬å…°è¯­â€œç©ºé—´æ„Ÿâ€å’Œâ€œéœ€æ±‚è¡¨è¾¾â€å·¥å…·ç®±å¤§å‡çº§ï¼</h2>
        <p>å¤ªä¸å¯æ€è®®äº†ï¼é€šè¿‡è¿™äº›æ—¥å¸¸ç”Ÿæ´»çš„ç‰‡æ®µï¼Œä½ å·²ç»æˆåŠŸåœ°å°†æ¨¡å—ä¸‰å­¦åˆ°çš„â€œå†…éƒ¨ç©ºé—´â€ã€â€œè¡¨é¢ç©ºé—´â€çš„è¡¨è¾¾ï¼Œä¸æ¨¡å—äºŒçš„â€œæˆ‘æƒ³è¦â€ã€â€œæˆ‘éœ€è¦â€ã€â€œæˆ‘å–œæ¬¢â€ã€â€œæˆ‘åƒ/å–â€è¿™äº›æ ¸å¿ƒåŠŸèƒ½ç´§å¯†åœ°è”ç³»èµ·æ¥äº†ï¼</p>
        <p>ä½ ç°åœ¨å¯ä»¥ï¼š</p>
        <ul class="final-summary-list">
            <li><span class="speakable-finnish">Kertoa, missÃ¤ sinÃ¤ tai jokin esine on (esim. <span class="finnish-phrase">MinÃ¤ olen kotona. Kirja on pÃ¶ydÃ¤llÃ¤</span>).</span> (è¯´å‡ºä½ æˆ–æŸä¸ªç‰©å“åœ¨å“ªé‡Œ)</li>
            <li><span class="speakable-finnish">Kertoa, mihin sinÃ¤ menet tai laitat jotakin (esim. <span class="finnish-phrase">MinÃ¤ menen kauppaan. Laitan avaimen laukkuun</span>).</span> (è¯´å‡ºä½ å»å“ªé‡Œæˆ–æŠŠæŸç‰©æ”¾åˆ°å“ªé‡Œ)</li>
            <li><span class="speakable-finnish">Kertoa, mistÃ¤ sinÃ¤ tulet tai otat jotakin (esim. <span class="finnish-phrase">MinÃ¤ tulen koulusta. Otan maidon jÃ¤Ã¤kaapista</span>).</span> (è¯´å‡ºä½ ä»å“ªé‡Œæ¥æˆ–ä»å“ªé‡Œæ‹¿å‡ºæŸç‰©)</li>
            <li><span class="speakable-finnish">YhdistÃ¤Ã¤ nÃ¤mÃ¤ kaikki tarpeisiisi, toiveisiisi ja tekemisiisi (esim. <span class="finnish-phrase">MinÃ¤ haluan kahvia, joka on pÃ¶ydÃ¤llÃ¤. SyÃ¶n leipÃ¤Ã¤ keittiÃ¶ssÃ¤.</span>).</span> (å¹¶å°†æ‰€æœ‰è¿™äº›ä¸ä½ çš„éœ€æ±‚ã€æ„¿æœ›å’Œè¡Œä¸ºç»“åˆèµ·æ¥)</li>
        </ul>
        <p>æœ€é‡è¦çš„æ˜¯ï¼Œä½ ä¸€ç›´åœ¨é€šè¿‡**æƒ…å¢ƒã€å£°éŸ³å’Œæ„Ÿè§‰**æ¥å­¦ä¹ ï¼Œè€Œä¸æ˜¯æ­»è®°ç¡¬èƒŒè¯­æ³•è§„åˆ™ã€‚è¿™ç§ç›´è§‰å¼çš„å­¦ä¹ æ–¹æ³•ï¼Œä¼šè®©ä½ åœ¨çœŸå®çš„èŠ¬å…°è¯­ç¯å¢ƒä¸­æ›´åŠ è‡ªä¿¡å’Œä»å®¹ï¼</p>
        <p><strong>ç»§ç»­åŠ æ²¹ï¼</strong> æ¨¡å—ä¸‰è¿˜æœ‰æ›´å¤šæœ‰è¶£çš„â€œç›¸å¯¹ä½ç½®â€ï¼ˆå‰åå·¦å³ï¼‰ã€â€œæ–¹å‘â€ï¼ˆä¸œå—è¥¿åŒ—ï¼‰å’Œâ€œä½ç½®å…³ç³»â€ï¼ˆæ—è¾¹ã€ä¸­é—´ç­‰ï¼‰ç­‰ç€æˆ‘ä»¬å»æ¢ç´¢ï¼ä½ å·²ç»ä¸ºæ¥ä¸‹æ¥çš„å­¦ä¹ æ‰“ä¸‹äº†éå¸¸åšå®çš„åŸºç¡€ï¼</p>
    </section>

<script>
    const finnishLang = 'fi-FI';

    function debugLog(message) {
        const output = document.getElementById('debug-output');
        if (output && output.innerHTML !== undefined) {
            const time = new Date().toLocaleTimeString();
            output.innerHTML += `[${time}] ${message}<br>`;
            output.scrollTop = output.scrollHeight;
        }
    }

    function testBasicTTS() {
        debugLog('å¼€å§‹æµ‹è¯•åŸºæœ¬TTSåŠŸèƒ½...');
        if (!('speechSynthesis' in window)) {
            debugLog('âŒ é”™è¯¯ï¼šæµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³åˆæˆAPI');
            alert('æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³åˆæˆåŠŸèƒ½ã€‚');
            return;
        }
        debugLog('âœ… æµè§ˆå™¨æ”¯æŒè¯­éŸ³åˆæˆAPI');
        const utterance = new SpeechSynthesisUtterance('Hello World');
        utterance.onstart = () => debugLog('âœ… è‹±è¯­æµ‹è¯•å¼€å§‹æ’­æ”¾');
        utterance.onend = () => debugLog('âœ… è‹±è¯­æµ‹è¯•æ’­æ”¾å®Œæˆ');
        utterance.onerror = (event) => debugLog('âŒ è‹±è¯­æµ‹è¯•é”™è¯¯: ' + event.error);
        window.speechSynthesis.speak(utterance);
    }

    function testFinnishTTSModule3_Review_Dim12_Singular() { 
        debugLog('å¼€å§‹æµ‹è¯•èŠ¬å…°è¯­TTSåŠŸèƒ½ (æ¨¡å—3 ç»´åº¦1&2å¤ä¹ -å•æ•°ä¼˜åŒ–)...');
        const utterance = new SpeechSynthesisUtterance('MinÃ¤ tarvitsen maitoa. MissÃ¤ maito on?');
        utterance.lang = finnishLang;
        utterance.onstart = () => debugLog('âœ… èŠ¬å…°è¯­(M3 D1&2 Rev Singular Opt)æµ‹è¯•å¼€å§‹æ’­æ”¾');
        utterance.onend = () => debugLog('âœ… èŠ¬å…°è¯­(M3 D1&2 Rev Singular Opt)æµ‹è¯•æ’­æ”¾å®Œæˆ');
        utterance.onerror = (event) => debugLog('âŒ èŠ¬å…°è¯­(M3 D1&2 Rev Singular Opt)æµ‹è¯•é”™è¯¯: ' + event.error);
        window.speechSynthesis.speak(utterance);
    }
     function listVoices() {
        debugLog('æ­£åœ¨è·å–å¯ç”¨è¯­éŸ³åˆ—è¡¨...');
        const voices = window.speechSynthesis.getVoices();
        if (voices.length === 0) {
            debugLog('âš ï¸ æœªæ‰¾åˆ°ä»»ä½•è¯­éŸ³ï¼Œè¯­éŸ³å¯èƒ½è¿˜åœ¨åŠ è½½ä¸­ã€‚');
            window.speechSynthesis.onvoiceschanged = () => {
                debugLog('è¯­éŸ³åˆ—è¡¨å·²æ›´æ–°ï¼Œé‡æ–°è·å–...');
                const updatedVoices = window.speechSynthesis.getVoices();
                if (updatedVoices.length === 0 && voices.length === 0) { 
                    debugLog('âš ï¸ æ›´æ–°åä»æœªæ‰¾åˆ°ä»»ä½•è¯­éŸ³ã€‚'); return;
                }
                if (updatedVoices.length > 0) logVoiceList(updatedVoices);
            };
            if (navigator.userAgent.toLowerCase().indexOf('firefox') > -1 || (navigator.userAgent.toLowerCase().indexOf('safari') > -1 && navigator.userAgent.toLowerCase().indexOf('chrome') === -1) ) {
                setTimeout(() => { if(window.speechSynthesis.getVoices().length > 0) listVoices(); }, 500);
            }
            return;
        }
        logVoiceList(voices);
    }
     function logVoiceList(voices) {
        debugLog(`æ‰¾åˆ° ${voices.length} ä¸ªå¯ç”¨è¯­éŸ³:`);
        voices.forEach((voice, index) => {
            const isDefault = voice.default ? ' (é»˜è®¤)' : '';
            debugLog(`${index + 1}. ${voice.name} (${voice.lang})${isDefault}`);
        });
        const finnishVoices = voices.filter(voice =>
            voice.lang.toLowerCase().startsWith('fi') ||
            voice.name.toLowerCase().includes('finnish') ||
            voice.name.toLowerCase().includes('suomi')
        );
        if (finnishVoices.length > 0) {
            debugLog(`âœ… æ‰¾åˆ° ${finnishVoices.length} ä¸ªèŠ¬å…°è¯­è¯­éŸ³:`);
            finnishVoices.forEach(voice => {
                debugLog(`  - ${voice.name} (${voice.lang})`);
            });
        } else {
            debugLog('âŒ æœªæ‰¾åˆ°èŠ¬å…°è¯­è¯­éŸ³ã€‚');
        }
    }

    function removeDebugSection() {
        const debugSection = document.querySelector('.debug-section');
        if (debugSection) {
            debugSection.style.display = 'none';
            debugLog('è°ƒè¯•åŒºåŸŸå·²éšè—');
        }
    }

    let isSpeaking = false;
    function speakText(text, lang = finnishLang) {
        if (!('speechSynthesis' in window)) return;
        if (isSpeaking) {
            window.speechSynthesis.cancel();
            setTimeout(() => startSpeaking(text, lang), 50);
        } else {
            startSpeaking(text, lang);
        }
    }

    function startSpeaking(text, lang) {
        isSpeaking = true;
        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = lang;
        utterance.rate = 0.9;
        utterance.pitch = 1.0;
        utterance.volume = 1.0;
        const voices = window.speechSynthesis.getVoices();
        let selectedVoice = null;
        if (lang.toLowerCase().startsWith('fi')) {
            selectedVoice = voices.find(voice => voice.lang.toLowerCase() === 'fi-fi') ||
                            voices.find(voice => voice.lang.toLowerCase().startsWith('fi')) ||
                            voices.find(voice => voice.name.toLowerCase().includes('finnish') || voice.name.toLowerCase().includes('suomi'));
        }
        if (selectedVoice) utterance.voice = selectedVoice;
        utterance.onend = () => { isSpeaking = false; };
        utterance.onerror = (event) => {
            debugLog(`âŒ æ’­æ”¾é”™è¯¯: ${event.error} (æ–‡æœ¬: "${text}")`);
            isSpeaking = false;
        };
        window.speechSynthesis.speak(utterance);
    }

    function addTTSButton(element, textToSpeak) {
        let cleanedText = textToSpeak.replace(/\s*\(.*?\)\s*/g, '').trim(); 
        cleanedText = cleanedText.replace(/ï¼ˆ.*?ï¼‰/g, '').trim();
        cleanedText = cleanedText.replace(/\[.*?\]/g, '').trim(); 

        if (!cleanedText || cleanedText === '') return;
        
        const existingButton = Array.from(element.childNodes).find(node => node.nodeType === Node.ELEMENT_NODE && node.classList.contains('tts-button') && node.title === 'æ’­æ”¾: ' + cleanedText);
        if (existingButton) return;

        const button = document.createElement('button');
        button.className = 'tts-button';
        button.innerHTML = 'ğŸ”Š';
        button.title = 'æ’­æ”¾: ' + cleanedText;
        button.setAttribute('aria-label', 'æ’­æ”¾éŸ³é¢‘: ' + cleanedText);
        button.onclick = (event) => {
            event.preventDefault();
            event.stopPropagation();
            speakText(cleanedText);
        };
        
        if (element.tagName === 'SPAN' && (element.classList.contains('speakable-finnish') || element.classList.contains('finnish-phrase'))) {
            if (!element.querySelector('.tts-button')) {
                element.appendChild(button);
            }
        } else {
            let insertBeforeNode = null;
            for (let i = 0; i < element.childNodes.length; i++) {
                const child = element.childNodes[i];
                if (child.nodeType === Node.ELEMENT_NODE && (child.classList.contains('note') || child.classList.contains('chinese-sense'))) {
                    insertBeforeNode = child;
                    break;
                }
            }
            if (insertBeforeNode) {
                element.insertBefore(button, insertBeforeNode);
            } else {
                element.appendChild(button);
            }
        }
    }
    
    function initializeTTSForPage() {
        debugLog('ğŸš€ åˆå§‹åŒ–é¡µé¢TTSæŒ‰é’® (æ¨¡å—ä¸‰ ç»¼åˆå¤ä¹  - äººç§°å•æ•°ä¼˜åŒ–)...');
        
        document.querySelectorAll('.speakable-finnish, .finnish-phrase').forEach(span => {
            const text = span.textContent.trim();
            if (text && !span.querySelector('.tts-button')) {
                 addTTSButton(span, text);
            }
        });

        const sentenceLevelContainers = [
            ...document.querySelectorAll('.dialogue-step p'),
            ...document.querySelectorAll('.interactive-question p'),
            ...document.querySelectorAll('.practice-plan-card .usage-example p'),
            ...document.querySelectorAll('.summary-card p'),
            ...document.querySelectorAll('.summary-card ul li'),
            ...document.querySelectorAll('#review-intro p')
        ];

        sentenceLevelContainers.forEach(el => {
            if (el.classList.contains('speakable-finnish') || el.classList.contains('finnish-phrase')) return;
            
            let hasButtonAlready = false;
            if (el.querySelector('.tts-button')) { 
                 hasButtonAlready = true;
            } else { 
                const directButton = Array.from(el.childNodes).find(node => node.nodeType === Node.ELEMENT_NODE && node.classList.contains('tts-button'));
                if (directButton) hasButtonAlready = true;
            }
            if (hasButtonAlready) return;

            if (el.closest('thead')) return;

            let textToSpeak = "";
            Array.from(el.childNodes).forEach(node => {
                if (node.nodeType === Node.TEXT_NODE) {
                    textToSpeak += node.textContent;
                } else if (node.nodeType === Node.ELEMENT_NODE &&
                           !node.classList.contains('note') &&
                           !node.classList.contains('chinese-sense') &&
                           !node.classList.contains('tts-button') &&
                           !node.classList.contains('speakable-finnish') && 
                           !node.classList.contains('finnish-phrase') &&
                           !node.classList.contains('highlight') &&
                           node.tagName !== 'IMG' 
                           ) {
                    textToSpeak += node.textContent; 
                }
            });
            textToSpeak = textToSpeak.trim();
            
            if (textToSpeak.length > 1 && textToSpeak.match(/[Ã¤Ã¶Ã¥Ã„Ã–Ã…]/i)) { 
                addTTSButton(el, textToSpeak);
            }
        });
        
        document.querySelectorAll('.scene-card h4 .speakable-finnish, .practice-plan-card .task-list h5 .speakable-finnish, #review-intro h2 .speakable-finnish, #review-summary-final h2 .speakable-finnish').forEach(el => {
             if(!el.querySelector('.tts-button')) addTTSButton(el, el.textContent);
        });
        
        document.querySelectorAll('#review-intro h2, #scenario-combo-1-home-morning h2, #scenario-combo-2-errands h2, #review-language-bleeding-plan h2, #review-summary-final h2').forEach(h => {
            if (!h.querySelector('.tts-button')) { 
                const text = h.textContent.split('(')[0].trim();
                if (text.length > 1 && text.match(/[Ã¤Ã¶Ã¥Ã„Ã–Ã…]/i)) {
                    addTTSButton(h, text);
                }
            }
        });

        debugLog('âœ… é¡µé¢TTSæŒ‰é’®åˆå§‹åŒ–å®Œæ¯• (æ¨¡å—ä¸‰ ç»¼åˆå¤ä¹  - äººç§°å•æ•°ä¼˜åŒ–)');
    }

    // Simplified Quiz Logic for review (ensure correct answers match new context)
    function checkReviewAnswer(quizId, selectedAnswerType) {
        const feedbackEl = document.getElementById(quizId + '_feedback');
        let correctAnswerTypeForQuestion, correctFinnishExample;
        let isCorrect = false;

        if (quizId === 'q_kitchen_1') { // "MinÃ¤ laitan murokulhon pÃ¶ydÃ¤lle" (å®é™…ä¸Šæ˜¯kirjan hyllyyn)
                                        // "MinÃ¤ laitan kirjan hyllyyn" -> hyllyyn
            correctAnswerTypeForQuestion = 'dim1_into'; //åˆ°å®¹å™¨é‡Œ (hyllyyn)
            correctFinnishExample = "hyllyyn";
            isCorrect = (selectedAnswerType === correctAnswerTypeForQuestion);
        } else if (quizId === 'q_errands_1') { // "MinÃ¤ menen postiin" -> postiin
            correctAnswerTypeForQuestion = 'into_container'; //è¿›å…¥ä¸€ä¸ªå°é—­ç©ºé—´ (postiin)
            correctFinnishExample = "postiin";
            isCorrect = (selectedAnswerType === correctAnswerTypeForQuestion);
        }

        if (isCorrect) {
            feedbackEl.innerHTML = `<span class="speakable-finnish">Oikein!</span> <span class="finnish-phrase speakable-finnish">${correctFinnishExample}</span> on juuri se oikea "Ã¤Ã¤nituntuma" tÃ¤hÃ¤n tilanteeseen.`;
            feedbackEl.className = 'feedback correct';
        } else {
            feedbackEl.innerHTML = `<span class="speakable-finnish">Ei ihan.</span> Mieti uudelleen. Oikea "Ã¤Ã¤nituntuma" olisi lÃ¤hempÃ¤nÃ¤ tÃ¤tÃ¤: <span class="finnish-phrase speakable-finnish">${correctFinnishExample}</span>.`;
            feedbackEl.className = 'feedback incorrect';
        }
        feedbackEl.querySelectorAll('.speakable-finnish, .finnish-phrase').forEach(el => {
            if (!el.querySelector('.tts-button')) addTTSButton(el, el.textContent);
        });
        const mainFeedbackSpan = feedbackEl.querySelector('.speakable-finnish');
        if(mainFeedbackSpan) speakText(mainFeedbackSpan.textContent.split('.')[0].split('"')[0].trim() + '.');
    }


    document.addEventListener('DOMContentLoaded', () => {
        if (window.speechSynthesis.getVoices().length === 0) {
            window.speechSynthesis.onvoiceschanged = initializeTTSForPage;
        } else {
            initializeTTSForPage();
        }
        setTimeout(initializeTTSForPage, 200); 
    });
</script>
</body>
</html>