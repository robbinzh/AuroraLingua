<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>èŠ¬å…°è¯­æ¨¡å—ä¸‰Â·ç»´åº¦äº”ï¼šæ„ŸçŸ¥â€œä½ç½®å…³ç³»â€ (SVGäº’åŠ¨TTS)</title>
    <style>
        body { font-family: "Microsoft YaHei", sans-serif; line-height: 1.7; margin: 20px auto; max-width: 900px; padding: 0 20px; color: #333; background-color: #f9f9f9; }
        h1, h2, h3, h4 { color: #2c3e50; }
        h1 { text-align: center; margin-bottom: 35px; font-size: 2.2em; }
        h2 { border-bottom: 2px solid #e67e22; padding-bottom: 12px; margin-top: 45px; font-size: 1.8em; color: #e67e22; } /* Dimension 5 color */
        h3 { margin-top: 30px; font-size: 1.5em; color: #d35400; } /* Lighter shade for H3 */
        h4 { font-size: 1.3em; color: #d35400; margin-top:25px; margin-bottom:15px; }
        table.immersion-table, table.vocab-list-table { width: 100%; border-collapse: collapse; margin-bottom: 25px; display: table; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .immersion-table th, .immersion-table td, .vocab-list-table th, .vocab-list-table td { border: 1px solid #ddd; padding: 12px; text-align: left; vertical-align: top;}
        .immersion-table thead, .vocab-list-table thead { background-color: #e9ecef; }
        .immersion-table td:first-child, .vocab-list-table td:first-child { font-weight: bold; }
        .partner-card, .practice-plan-card, .cognitive-bleeding-card, .usage-example, .summary-card, .example, .new-vocab-section {
            background-color: #fff; border: 1px solid #e0e0e0; border-radius: 8px; padding: 20px; margin-bottom: 30px; box-shadow: 0 4px 10px rgba(0,0,0,0.08);
        }
        .example { border-left: 6px solid #e67e22 !important; } /* Dimension 5 example color */
        .partner-card h4 { color: #d35400; margin-top: 0; font-size: 1.3em; border-bottom: 1px dashed #f39c12; padding-bottom: 8px; margin-bottom: 15px; }
        .partner-card-content p { margin: 5px 0; font-size: 1.1em; }
        .partner-card img, .partner-card svg { width: 100px; height: 100px; object-fit: contain; margin-right: 15px; border-radius: 4px; float: left; margin-bottom:10px;}
        .finnish-phrase { font-weight: bold; color: #d35400; font-size: 1.15em; } /* Dimension 5 phrase color */
        .genitive-n { color: #c0392b; font-weight: bold; text-decoration: underline; font-size: 1.2em; }
        .example-sentence .finnish-phrase { font-size: 1.1em; }
        .chinese-sense, .note { font-size: 0.95em; color: #555; font-style: italic; }
        .tts-button { background: none; border: none; cursor: pointer; font-size: 1.2em; margin-left: 8px; padding: 0; display: inline-block; vertical-align: middle; color: #d35400; }
        .tts-button:hover { color: #a04000; opacity: 0.8; }
        .debug-section, .interactive-svg-container, .interactive-choice { background-color: #fdfefe; border: 1px solid #e0e0e0; border-radius: 8px; padding: 15px; margin: 20px 0; }
        .debug-button { background-color: #4CAF50; color: white; padding: 8px 16px; margin: 5px; border: none; border-radius: 4px; cursor: pointer; }
        .debug-button:hover { background-color: #45a049; }
        .highlight { color: #c0392b; font-weight: bold; }
        hr { border: 0; height: 1px; background-image: linear-gradient(to right, rgba(0,0,0,0), rgba(230,126,34,0.3), rgba(0,0,0,0)); margin: 40px 0; }
        .task-list { list-style-type: none; padding-left: 0; }
        .task-list > li { margin-bottom: 15px; }
        .task-list h5 { margin-top:0; color: #2c3e50; font-size: 1.15em; }
        .task-list ul { list-style-type: disc; padding-left: 25px; margin-top: 5px; }
        .task-list ul li { font-size: 1em; margin-bottom: 8px; }
        .interactive-choice button { background-color: #f39c12; color: white; padding: 10px 15px; border: none; border-radius: 5px; cursor: pointer; margin: 8px; font-size: 1em; transition: background-color 0.2s; }
        .interactive-choice button:hover { background-color: #d35400; }
        .feedback-area { margin-top: 15px; padding: 12px; border-radius: 5px; text-align:center; font-size: 1.1em; min-height: 1.5em; }
        .correct { background-color: #d1f2eb; color: #0c6255; border: 1px solid #a3e4d7; }
        .incorrect { background-color: #fdedec; color: #c0392b; border: 1px solid #f5b7b1; }
        .action-button { background-color: #f39c12; color: white; padding: 12px 18px; border: none; border-radius: 5px; cursor: pointer; margin-top:12px; font-size: 1em; transition: background-color 0.2s; }
        .action-button:hover { background-color: #d35400; }
        .concept-map { text-align: center; margin: 25px 0; padding: 15px; background-color: #fff3e0; border: 1px dashed #ffcc80; border-radius: 6px; }
        .concept-map p { margin: 8px 0; font-size: 1.15em; }
        .n-hand-viz { display: flex; align-items: center; justify-content: center; font-size: 1.3em; margin: 20px 0; }
        .n-hand-viz span { margin: 0 15px; }
        .n-hand-viz .plus-sign { font-size: 1.5em; color: #aaa; }
    </style>
</head>
<body>

    <h1>æ¨¡å—ä¸‰ï¼šã€ç©ºé—´å®šä½å™¨ã€‘ â€“ ç»´åº¦äº”ï¼šæ„ŸçŸ¥â€œä½ç½®å…³ç³»â€</h1>

    <!-- TTSè°ƒè¯•åŒºåŸŸ -->
    <div class="debug-section">
        <h3>ğŸ”§ TTSåŠŸèƒ½æµ‹è¯• (æ¨¡å—ä¸‰Â·ç»´åº¦äº” ä½ç½®å…³ç³»)</h3>
        <p>å¦‚æœTTSæŒ‰é’®æ²¡æœ‰å£°éŸ³ï¼Œè¯·å…ˆæµ‹è¯•ä»¥ä¸‹åŠŸèƒ½ï¼š</p>
        <button class="debug-button" onclick="testBasicTTS()">æµ‹è¯•åŸºæœ¬TTS</button>
        <button class="debug-button" onclick="testFinnishTTSModule3_Dim5()">æµ‹è¯•èŠ¬å…°è¯­TTS (æ¨¡å—3.5)</button>
        <button class="debug-button" onclick="listVoices()">æŸ¥çœ‹å¯ç”¨è¯­éŸ³</button>
        <button class="debug-button" onclick="removeDebugSection()">ç§»é™¤è°ƒè¯•åŒºåŸŸ</button>
        <div id="debug-output" style="margin-top: 10px; padding: 10px; background-color: #f0f0f0; border-radius: 4px; font-family: monospace; font-size: 12px; max-height: 200px; overflow-y: auto;"></div>
    </div>

    <hr>

    <section id="intro-dimension5">
        <h2>ğŸš€ ç»´åº¦äº”å¼•å…¥ï¼šå½“ç‰©ä½“æˆä¸ºæ–°çš„â€œä¸–ç•Œä¸­å¿ƒâ€</h2>
        <div class="example">
            <p><span class="speakable-finnish">Loistavaa tyÃ¶tÃ¤ tÃ¤hÃ¤n mennessÃ¤!</span> (åˆ°ç›®å‰ä¸ºæ­¢å¹²å¾—å¤ªå‡ºè‰²äº†ï¼)</p>
            <p>æˆ‘ä»¬å·²ç»èƒ½è¯´â€œæˆ‘åœ¨å•†åº—<span class="highlight">é‡Œ</span>â€(<span class="finnish-phrase speakable-finnish">kaupassa</span>)ï¼Œèƒ½è¯´â€œä¹¦åœ¨æ¡Œå­<span class="highlight">ä¸Š</span>â€(<span class="finnish-phrase speakable-finnish">pÃ¶ydÃ¤llÃ¤</span>)ï¼Œè¿˜èƒ½è¯´â€œä½ åœ¨æˆ‘çš„<span class="highlight">å‰é¢</span>â€(<span class="finnish-phrase speakable-finnish">minun edessÃ¤</span>)ã€‚</p>
            <p>ç°åœ¨ï¼Œæˆ‘ä»¬æ¥å®Œæˆç©ºé—´å®šä½çš„æœ€åä¸€å—é‡è¦æ‹¼å›¾ï¼šå¦‚æœæˆ‘æƒ³è¯´â€œé’¥åŒ™åœ¨<span class="highlight">æ¯å­çš„æ—è¾¹</span>â€å‘¢ï¼Ÿè¿™æ—¶ï¼Œå‚ç…§ç‰©ä¸å†æ˜¯æˆ‘ï¼Œè€Œæ˜¯ä¸€ä¸ªç‰©ä½“â€”â€”â€œæ¯å­â€ã€‚</p>
            <p>èŠ¬å…°è¯­æœ‰ä¸€ä¸ªç»å¦™çš„æ–¹æ³•æ¥å¤„ç†è¿™ç§æƒ…å†µã€‚æˆ‘ä»¬å°†å®ƒç§°ä¸º**â€œ-nå°æ‰‹â€ç†è®º**ï¼</p>
        </div>
        <div class="concept-map">
            <h3>ğŸ¤ã€è®¤çŸ¥é”šç‚¹ã€‘â€œ-n å°æ‰‹â€ç†è®ºï¼šç‰©ä½“é—´çš„ä¼™ä¼´å…³ç³»</h3>
            <p>æƒ³è±¡ä¸€ä¸‹ï¼Œå½“ä¸€ä¸ªç‰©ä½“è¦æˆä¸ºå¦ä¸€ä¸ªç‰©ä½“çš„ä½ç½®å‚ç…§ç‰©æ—¶ï¼Œå®ƒéœ€è¦ä¼¸å‡ºä¸€åªâ€œå°æ‰‹â€æ¥â€œæ‹‰ä½â€æè¿°æ–¹ä½çš„è¯ã€‚</p>
            <p>è¿™åªâ€œå°æ‰‹â€é€šå¸¸å°±æ˜¯å­—æ¯ <span class="genitive-n">-n</span>ã€‚</p>
            <div class="n-hand-viz">
                <span class="finnish-phrase speakable-finnish">kuppi</span>
                <span class="plus-sign">â”</span>
                <span class="finnish-phrase speakable-finnish">kupi<span class="genitive-n">n</span></span>
                <span class="plus-sign">+</span>
                <span class="finnish-phrase speakable-finnish">vieressÃ¤</span>
                <span class="plus-sign">â”</span>
                <span class="finnish-phrase speakable-finnish">kupin vieressÃ¤</span>
            </div>
            <p>è¿™ä¸ª <span class="finnish-phrase speakable-finnish">kupi<span class="genitive-n">n</span></span> åœ¨æ„Ÿè§‰ä¸Šå°±å®Œå…¨ç­‰åŒäºä¸­æ–‡çš„â€œ**æ¯å­çš„**â€ï¼æ‰€ä»¥ <span class="finnish-phrase speakable-finnish">kupin vieressÃ¤</span> å°±æ˜¯â€œæ¯å­çš„æ—è¾¹â€ã€‚æ˜¯ä¸æ˜¯ä¸€ä¸‹å°±å˜å¾—éå¸¸äº²åˆ‡å’Œå®¹æ˜“ç†è§£äº†ï¼Ÿ</p>
        </div>
    </section>

    <hr>

    <section id="position-partners">
        <h3>ğŸ¤ è®¤è¯†æ–°çš„â€œä½ç½®ä¼™ä¼´â€ (Postpositiot)</h3>
        <p>è®©æˆ‘ä»¬æ¥è®¤è¯†å‡ ä¸ªæœ€é«˜é¢‘çš„â€œä½ç½®ä¼™ä¼´â€ã€‚è®°ä½ï¼Œå½“å®ƒä»¬å’Œå¦ä¸€ä¸ªç‰©ä½“ï¼ˆå‚ç…§ç‰©ï¼‰æ­é…æ—¶ï¼Œé‚£ä¸ªç‰©ä½“é€šå¸¸éœ€è¦ä¼¸å‡º <span class="genitive-n">-n</span> â€œå°æ‰‹â€å“¦ï¼</p>

        <!-- ä½ç½®ä¼™ä¼´ 1: vieressÃ¤ -->
        <div class="partner-card">
            <h4><span class="speakable-finnish">vieressÃ¤</span> (åœ¨...æ—è¾¹)</h4>
            <div class="partner-card-content">
                <svg width="100" height="100" viewBox="0 0 100 100">
                    <rect x="10" y="40" width="30" height="50" fill="#5DADE2" rx="2"></rect>
                    <path d="M 60 40 h 20 v 50 h -20 z" fill="#E74C3C"></path>
                    <path d="M 80 45 h 5 v 20 h -5 z" fill="#E74C3C"></path>
                </svg>
                <p><strong>å½“æŸç‰©åœ¨å¦ä¸€ä¸ªç‰©ä½“çš„æ—è¾¹ï¼š</strong></p>
                <p class="example-sentence"><span class="speakable-finnish">Minun avain on kirja<span class="genitive-n">n</span> <span class="finnish-phrase">vieressÃ¤</span>.</span> <span class="note speakable-finnish">(avain=é’¥åŒ™, kirja=ä¹¦)</span></p>
                <p class="chinese-sense">æ„ŸçŸ¥ï¼šâ€œä¹¦â€(<span class="finnish-phrase speakable-finnish">kirja</span>)ä¼¸å‡ºäº†<span class="genitive-n">-n</span>å°æ‰‹ï¼Œå˜æˆäº†â€œä¹¦çš„â€(<span class="finnish-phrase speakable-finnish">kirjan</span>)ï¼Œç„¶åæ‹‰ä½äº†â€œæ—è¾¹â€(<span class="finnish-phrase speakable-finnish">vieressÃ¤</span>)ã€‚</p>
                <p class="example-sentence"><span class="speakable-finnish">SinÃ¤ istut minun <span class="finnish-phrase">vieressÃ¤</span>ni.</span> <span class="note">(ä½ ååœ¨æˆ‘çš„æ—è¾¹ã€‚è¿™é‡Œçš„-niæ˜¯â€œæˆ‘çš„â€æ‰€æœ‰æ ¼åç¼€ï¼Œæ˜¯å¦ä¸€ç§è¡¨è¾¾æ–¹å¼)</span></p>
            </div>
        </div>

        <!-- ä½ç½®ä¼™ä¼´ 2: vÃ¤lissÃ¤ -->
        <div class="partner-card">
            <h4><span class="speakable-finnish">vÃ¤lissÃ¤</span> (åœ¨...ä¹‹é—´)</h4>
            <div class="partner-card-content">
                 <svg width="100" height="100" viewBox="0 0 100 100">
                    <rect x="5" y="40" width="25" height="50" fill="#5DADE2" rx="2"></rect>
                    <path d="M 70 40 h 20 v 50 h -20 z" fill="#E74C3C"></path>
                    <path d="M 90 45 h 5 v 20 h -5 z" fill="#E74C3C"></path>
                    <rect x="40" y="50" width="20" height="30" fill="#F1C40F" rx="2"></rect>
                </svg>
                <p><strong>å½“æŸç‰©åœ¨ä¸¤ä¸ªç‰©ä½“ä¹‹é—´ï¼š</strong></p>
                <p class="example-sentence"><span class="speakable-finnish">Puhelin on kirja<span class="genitive-n">n</span> ja kupi<span class="genitive-n">n</span> <span class="finnish-phrase">vÃ¤lissÃ¤</span>.</span> <span class="note speakable-finnish">(puhelin=æ‰‹æœº, ja=å’Œ)</span></p>
                <p class="chinese-sense">æ„ŸçŸ¥ï¼šå¤ªå¥‡å¦™äº†ï¼â€œä¹¦â€å’Œâ€œæ¯å­â€éƒ½ä¼¸å‡ºäº†è‡ªå·±çš„<span class="genitive-n">-n</span>å°æ‰‹ï¼Œç„¶åä¸€èµ·æ‹‰ä½äº†â€œä¹‹é—´â€(<span class="finnish-phrase speakable-finnish">vÃ¤lissÃ¤</span>)ã€‚</p>
                <p class="example-sentence"><span class="speakable-finnish">MinÃ¤ seison sinun ja oven <span class="finnish-phrase">vÃ¤lissÃ¤</span>.</span> <span class="note speakable-finnish">(seison=æˆ‘ç«™, ovi=é—¨ -> oven=é—¨çš„)</span></p>
            </div>
        </div>
        
        <!-- ä½ç½®ä¼™ä¼´ 3: vastapÃ¤Ã¤tÃ¤ -->
        <div class="partner-card">
            <h4><span class="speakable-finnish">vastapÃ¤Ã¤tÃ¤</span> (åœ¨...å¯¹é¢)</h4>
            <div class="partner-card-content">
                <svg width="100" height="100" viewBox="0 0 100 100">
                    <rect x="10" y="40" width="30" height="50" fill="#2ECC71" rx="2"></rect>
                    <rect x="60" y="40" width="30" height="50" fill="#3498DB" rx="2"></rect>
                    <path d="M 45 65 l 10 0" stroke="#aaa" stroke-width="2" stroke-dasharray="4 2"></path>
                </svg>
                <p><strong>å½“æŸç‰©åœ¨å¦ä¸€ä¸ªç‰©ä½“çš„å¯¹é¢ï¼š</strong></p>
                <p class="example-sentence"><span class="speakable-finnish">Kauppa on koulu<span class="genitive-n">n</span> <span class="finnish-phrase">vastapÃ¤Ã¤tÃ¤</span>.</span> <span class="note speakable-finnish">(koulu=å­¦æ ¡)</span></p>
                <p class="chinese-sense">æ„ŸçŸ¥ï¼šâ€œå­¦æ ¡â€(<span class="finnish-phrase speakable-finnish">koulu</span>)ä¼¸å‡º<span class="genitive-n">-n</span>å°æ‰‹ï¼Œå˜æˆäº†â€œå­¦æ ¡çš„â€(<span class="finnish-phrase speakable-finnish">koulun</span>)ï¼Œç„¶åæŒ‡å‘äº†å®ƒçš„â€œå¯¹é¢ä¼™ä¼´â€(<span class="finnish-phrase speakable-finnish">vastapÃ¤Ã¤tÃ¤</span>)ã€‚</p>
                <p class="example-sentence"><span class="speakable-finnish">MinÃ¤ istun sinua <span class="finnish-phrase">vastapÃ¤Ã¤tÃ¤</span>.</span> <span class="note">(æˆ‘ååœ¨ä½ çš„å¯¹é¢ã€‚è¿™é‡Œ sinua æ˜¯â€œä½ â€çš„éƒ¨åˆ†æ ¼ï¼Œæ˜¯å¦ä¸€ç§å¸¸è§ç”¨æ³•)</span></p>
            </div>
        </div>
    </section>

    <hr>

    <section id="interactive-practice-dim5">
        <h3>ğŸ’¡ äº’åŠ¨ç»ƒä¹ ï¼šæˆ‘çš„æ¡Œé¢å¯»å® (SVGç‰ˆ)</h3>
        <div class="story-card">
            <p>è¿™æ˜¯ä¸€å¼ æˆ‘ä¸ºä½ ç”»çš„æ¡Œé¢ç¤ºæ„å›¾ã€‚ä»”ç»†è§‚å¯Ÿå›¾ä¸­ç‰©å“çš„ä½ç½®ï¼Œç„¶åå›ç­”ä¸‹é¢çš„é—®é¢˜å§ï¼</p>
            <div class="interactive-svg-container" style="text-align:center;">
                <svg id="desktop-scene" width="90%" viewBox="0 0 450 220" style="border:1px solid #ddd; border-radius: 5px;">
                    <!-- Table -->
                    <rect x="10" y="180" width="430" height="15" fill="#D2B48C" rx="3"></rect>
                    <rect x="50" y="195" width="15" height="20" fill="#D2B48C"></rect>
                    <rect x="385" y="195" width="15" height="20" fill="#D2B48C"></rect>
                    <text x="400" y="175" font-size="12" fill="#aaa" class="speakable-finnish">pÃ¶ytÃ¤</text>

                    <!-- Book (kirja, blue) -->
                    <rect x="40" y="120" width="100" height="60" fill="#5DADE2" rx="3"></rect>
                    <text x="80" y="115" font-size="12" fill="#5DADE2" class="speakable-finnish">kirja</text>

                    <!-- Cup (kuppi, red) -->
                    <path d="M 300 130 h 50 v 50 h -50 z" fill="#E74C3C"></path>
                    <path d="M 350 140 h 15 v 20 h -15 z" fill="#E74C3C"></path>
                    <text x="315" y="125" font-size="12" fill="#E74C3C" class="speakable-finnish">kuppi</text>

                    <!-- Phone (puhelin, gray) -->
                    <rect x="160" y="140" width="35" height="40" fill="#7F8C8D" rx="4"></rect>
                    <text x="150" y="135" font-size="12" fill="#7F8C8D" class="speakable-finnish">puhelin</text>

                    <!-- Key (avain, yellow - question item) -->
                    <g id="interactive-key">
                        <circle cx="240" cy="170" r="8" fill="#F1C40F" />
                        <rect x="245" y="168" width="10" height="4" fill="#F1C40F" />
                        <rect x="255" y="165" width="10" height="10" fill="#F1C40F" />
                        <text x="240" y="160" font-size="12" fill="#F1C40F" font-weight="bold" class="speakable-finnish">avain</text>
                    </g>
                </svg>
            </div>
            <div id="q-dim5-container" style="margin-top:20px;">
                <!-- Questions will be dynamically inserted here by JS -->
            </div>
            <div class="interactive-choice" style="text-align: center; margin-top:15px;">
                <button class="action-button" onclick="nextDim5Question()">ä¸‹ä¸€ä¸ªé—®é¢˜</button>
            </div>
            <div id="feedback-area-dim5" class="feedback-area"></div>
        </div>
    </section>
    
    <hr>
    
    <section id="language-bleeding-plan-dim5">
        <h2>ğŸ§ªã€è¯­è¨€å‡ºè¡€ã€‘â€œæˆ‘çš„çœŸå®ç©ºé—´â€ä½ç½®å…³ç³»ä¸‰æ—¥æ¤å…¥è®¡åˆ’</h2>
        <div class="practice-plan-card">
            <ul class="task-list">
                <li>
                    <h5><span class="speakable-finnish">ğŸ“† ç¬¬1æ—¥ï¼šæ„ŸçŸ¥â€œåœ¨æ—è¾¹â€ (<span class="finnish-phrase speakable-finnish">vieressÃ¤</span>)</span></h5>
                    <ul>
                        <li><span class="speakable-finnish">æ‰¾åˆ°ä½ èº«è¾¹çš„ä»»ä½•ä¸¤ä¸ªç‰©ä½“ï¼Œæ¯”å¦‚æ‰‹æœºå’Œæ¯å­ã€‚å¯¹è‡ªå·±è¯´ï¼šâ€œMinun puhelin on kupi<span class="genitive-n">n</span> <span class="finnish-phrase">vieressÃ¤</span>.â€</span></li>
                        <li><span class="speakable-finnish">æ¢ä¸ªå‚ç…§ç‰©ï¼Œå†è¯´ä¸€éï¼šâ€œMinun kuppi on puhelime<span class="genitive-n">n</span> <span class="finnish-phrase">vieressÃ¤</span>.â€</span></li>
                        <li><span class="speakable-finnish">æ¯æ¬¡çœ‹åˆ°å¹¶æ’æ”¾ç½®çš„ä¸œè¥¿ï¼Œéƒ½ç”¨è¿™ä¸ªå¥å¼åœ¨å¿ƒé‡Œé»˜å¿µä¸€éã€‚</span></li>
                    </ul>
                </li>
                <li>
                    <h5><span class="speakable-finnish">ğŸ“† ç¬¬2æ—¥ï¼šæ„ŸçŸ¥â€œåœ¨ä¹‹é—´â€ (<span class="finnish-phrase speakable-finnish">vÃ¤lissÃ¤</span>)</span></h5>
                    <ul>
                        <li><span class="speakable-finnish">åˆ›é€ ä¸€ä¸ªâ€œä¸‰æ˜æ²»â€ç»“æ„ï¼šæŠŠä½ çš„é’¥åŒ™æ”¾åœ¨ä¹¦å’Œæ‰‹æœºä¸­é—´ã€‚ç„¶åå¤§å£°è¯´ï¼šâ€œMinun avain on kirja<span class="genitive-n">n</span> ja puhelime<span class="genitive-n">n</span> <span class="finnish-phrase">vÃ¤lissÃ¤</span>.â€</span></li>
                        <li><span class="speakable-finnish">åœ¨è¶…å¸‚æ’é˜Ÿæ—¶ï¼Œçœ‹çœ‹ä½ å‰é¢å’Œåé¢çš„äººï¼Œå¯¹è‡ªå·±è¯´ï¼šâ€œMinÃ¤ olen kahde<span class="genitive-n">n</span> ihmise<span class="genitive-n">n</span> <span class="finnish-phrase">vÃ¤lissÃ¤</span>.â€ (æˆ‘åœ¨ä¸¤ä¸ªäººä¹‹é—´ã€‚<span class="note">kaksi ihmistÃ¤ -> kahden ihmisen</span>)</span></li>
                    </ul>
                </li>
                <li>
                    <h5><span class="speakable-finnish">ğŸ“† ç¬¬3æ—¥ï¼šæ„ŸçŸ¥â€œåœ¨å¯¹é¢â€ (<span class="finnish-phrase speakable-finnish">vastapÃ¤Ã¤tÃ¤</span>) å¹¶ç»¼åˆåº”ç”¨</span></h5>
                    <ul>
                        <li><span class="speakable-finnish">å¦‚æœä½ å®¶å¯¹é¢æœ‰å¦ä¸€æ ‹æ¥¼æˆ–ä¸€å®¶å•†åº—ï¼Œå¯¹è‡ªå·±è¯´ï¼šâ€œTalo on minun talo<span class="genitive-n">n</span> <span class="finnish-phrase">vastapÃ¤Ã¤tÃ¤</span>.â€</span></li>
                        <li><span class="speakable-finnish">å’Œæœ‹å‹åœ¨å’–å•¡é¦†ï¼Œæè¿°ï¼šâ€œSinÃ¤ istut minua <span class="finnish-phrase">vastapÃ¤Ã¤tÃ¤</span>. Sokeri on kupi<span class="genitive-n">n</span> <span class="finnish-phrase">vieressÃ¤</span>.â€ (ä½ ååœ¨æˆ‘å¯¹é¢ã€‚ç³–åœ¨æ¯å­æ—è¾¹ã€‚<span class="note">sokeri=ç³–</span>)</span></li>
                    </ul>
                </li>
            </ul>
        </div>
    </section>

    <hr>

    <section id="dim5-summary-and-next">
        <h2>ğŸŒŸ ç»´åº¦äº”æ„ŸçŸ¥å°ç»“ï¼šä½ æŒæ¡äº†â€œç‰©ä½“ä¼™ä¼´å…³ç³»â€çš„è¯­è¨€ï¼ (å«æœ¯è¯­é”šå®š)</h2>
        <div class="summary-card">
            <p><span class="speakable-finnish">Mahtavaa! Olet nyt avaruudellisen paikantamisen mestari!</span> (å¤ªæ£’äº†ï¼ä½ ç°åœ¨æ˜¯ç©ºé—´å®šä½å¤§å¸ˆäº†ï¼)</p>
            <p>ä½ å·²ç»æˆåŠŸè§£é”äº†èŠ¬å…°è¯­ç©ºé—´è¡¨è¾¾ä¸­éå¸¸æ ¸å¿ƒå’Œå¼ºå¤§çš„ä¸€ä¸ªèƒ½åŠ›ï¼šæè¿°ç‰©ä½“ä¸ç‰©ä½“ä¹‹é—´çš„ä½ç½®å…³ç³»ï¼æˆ‘ä»¬çš„**â€œ-nå°æ‰‹â€ç†è®º**å¸®åŠ©ä½ è½»æ¾åœ°ç†è§£äº†è¿™ä¸€ç‚¹ã€‚</p>
            <p>è®©æˆ‘ä»¬æ¥å›é¡¾ä¸€ä¸‹è¿™ä¸ªå¼ºå¤§çš„æ¨¡å¼ï¼š</p>
             <div class="n-hand-viz" style="background-color:#fef9e7; padding:10px; border-radius:5px;">
                <span class="finnish-phrase speakable-finnish">[å‚ç…§ç‰©]</span>
                <span class="plus-sign">+</span>
                <span class="genitive-n">-n</span>
                <span class="plus-sign">+</span>
                <span class="finnish-phrase speakable-finnish">[ä½ç½®ä¼™ä¼´]</span>
            </div>
            <p class="note" style="text-align:center;">(<span class="finnish-phrase speakable-finnish">esim. pÃ¶ydÃ¤<span class="genitive-n">n</span> vieressÃ¤</span>)</p>

            <p>ç°åœ¨ï¼Œæ˜¯æ—¶å€™ä¸ºè¿™äº›ä½ å·²ç»æœ‰â€œæ„Ÿè§‰â€çš„ä¸œè¥¿ï¼ŒæŒ‚ä¸Šå®ƒä»¬çš„â€œè¯­æ³•å§“åç‰Œâ€äº†ï¼š</p>
            <ul style="list-style-type: disc; padding-left: 20px;">
                <li>æˆ‘ä»¬ç»™å‚ç…§ç‰©åè¯åŠ ä¸Šçš„é‚£ä¸ªç¥å¥‡çš„ <span class="genitive-n">-n</span> â€œå°æ‰‹â€ï¼Œåœ¨è¯­æ³•ä¸Šå«åš **<span class="speakable-finnish">genetiivi</span> (Genitive caseï¼Œæ‰€æœ‰æ ¼)**ã€‚å®ƒæœ€å¸¸è§çš„æ„æ€å°±æ˜¯ä¸­æ–‡é‡Œçš„â€œ**çš„**â€ï¼Œè¡¨ç¤ºæ‰€å±å…³ç³»æˆ–ä½œä¸ºå‚ç…§ç‚¹ã€‚</li>
                <li>è€Œåƒ <span class="finnish-phrase speakable-finnish">vieressÃ¤</span> (æ—è¾¹), <span class="finnish-phrase speakable-finnish">vÃ¤lissÃ¤</span> (ä¹‹é—´), <span class="finnish-phrase speakable-finnish">vastapÃ¤Ã¤tÃ¤</span> (å¯¹é¢) è¿™äº›â€œä½ç½®ä¼™ä¼´â€ï¼Œå®ƒä»¬åœ¨è¯­æ³•ä¸Šè¢«ç§°ä¸º **<span class="speakable-finnish">postpositiot</span> (Postpositionsï¼Œåç½®è¯)**ï¼Œå› ä¸ºå®ƒä»¬æ€»æ˜¯æ”¾åœ¨å®ƒä»¬å‚ç…§çš„åè¯ï¼ˆçš„æ‰€æœ‰æ ¼å½¢å¼ï¼‰çš„**åé¢**ã€‚</li>
            </ul>
            <p class="note speakable-finnish">Muista: tunne on tÃ¤rkeÃ¤mpi kuin termi! Nyt ymmÃ¤rrÃ¤t, miksi ja miten suomalaiset rakentavat nÃ¤itÃ¤ lauseita. (è®°ä½ï¼šæ„Ÿè§‰æ¯”æœ¯è¯­æ›´é‡è¦ï¼ç°åœ¨ä½ ç†è§£äº†èŠ¬å…°äººä¸ºä»€ä¹ˆä»¥åŠå¦‚ä½•æ„å»ºè¿™äº›å¥å­ã€‚)</p>
            <p><strong>æ¨¡å—ä¸‰æœ€ç»ˆæ€»ç»“ï¼š</strong> æˆ‘ä»¬å°†ç”¨ä¸€ä¸ªç»¼åˆä»»åŠ¡æ¥å›é¡¾å’Œèåˆå…¨éƒ¨äº”ä¸ªç»´åº¦çš„ç©ºé—´çŸ¥è¯†ï¼ŒçœŸæ­£åšåˆ°åœ¨èŠ¬å…°è¯­çš„â€œç©ºé—´å®‡å®™â€ä¸­è‡ªç”±æ¼«æ¸¸ï¼</p>
        </div>
    </section>

    <hr>
    
    <section id="new-vocabulary-list-m3p5" class="new-vocab-section">
        <h3>ğŸ“š æœ¬ç»´åº¦æ–°æœ‹å‹ï¼šè¯æ±‡ç§¯ç´¯ (èšç„¦æ ¸å¿ƒä½ç½®ä¼™ä¼´)</h3>
        <p>ä»¥ä¸‹æ˜¯æœ¬ç»´åº¦ï¼ˆæ¨¡å—ä¸‰Â·ç»´åº¦äº”ï¼‰æˆ‘ä»¬é‡ç‚¹æ¥è§¦çš„æ ¸å¿ƒâ€œä½ç½®ä¼™ä¼´â€ï¼ˆåç½®è¯ï¼‰å’Œä¸€äº›è¾…åŠ©è¯æ±‡ã€‚ç†Ÿæ‚‰å®ƒä»¬å°†è®©ä½ èƒ½æ›´ç²¾ç¡®åœ°æè¿°ä½ å‘¨å›´çš„ä¸–ç•Œï¼</p>
        <table class="vocab-list-table">
            <thead>
                <tr>
                    <th>èŠ¬å…°è¯­æ–°è¯ (åŸå½¢)</th>
                    <th>ä¸­æ–‡æ„æ€</th>
                    <th>å¸¸ç”¨å½¢å¼æˆ–åŠ¨è¯å˜å½¢ (MinÃ¤/SinÃ¤)</th>
                </tr>
            </thead>
            <tbody>
                <!-- Postpositions -->
                <tr><td><span class="speakable-finnish">vieressÃ¤</span></td><td>åœ¨...æ—è¾¹</td><td><span class="note speakable-finnish">(YleensÃ¤ substantiivin genetiivin jÃ¤lkeen, esim. 'pÃ¶ydÃ¤n vieressÃ¤')</span></td></tr>
                <tr><td><span class="speakable-finnish">vÃ¤lissÃ¤</span></td><td>åœ¨...ä¹‹é—´</td><td><span class="note speakable-finnish">(esim. 'kirjan ja kupin vÃ¤lissÃ¤')</span></td></tr>
                <tr><td><span class="speakable-finnish">vastapÃ¤Ã¤tÃ¤</span></td><td>åœ¨...å¯¹é¢</td><td><span class="note speakable-finnish">(esim. 'koulun vastapÃ¤Ã¤tÃ¤')</span></td></tr>
                
                <!-- Nouns (from examples, reinforcing old ones) -->
                <tr><td><span class="speakable-finnish">avain</span></td><td>é’¥åŒ™</td><td><span class="note speakable-finnish">(Genetiivi: avaime<span class="genitive-n">n</span>)</span></td></tr>
                <tr><td><span class="speakable-finnish">puhelin</span></td><td>æ‰‹æœº</td><td><span class="note speakable-finnish">(Genetiivi: puhelime<span class="genitive-n">n</span>)</span></td></tr>
                <tr><td><span class="speakable-finnish">sokeri</span></td><td>ç³–</td><td>-</td></tr>
                <tr><td><span class="speakable-finnish">ihminen</span></td><td>äºº</td><td><span class="note speakable-finnish">(Genetiivi monikko: ihmiste<span class="genitive-n">n</span> / kahden ihmise<span class="genitive-n">n</span>)</span></td></tr>

                <!-- Verbs -->
                <tr><td><span class="speakable-finnish">seisoa</span></td><td>ç«™ç«‹</td><td><span class="speakable-finnish">minÃ¤ seison, sinÃ¤ seisot</span> <span class="note">(å¤ä¹ )</span></td></tr>
                
                <!-- Conjunctions -->
                <tr><td><span class="speakable-finnish">ja</span></td><td>å’Œ</td><td><span class="note">(å¤ä¹ )</span></td></tr>
            </tbody>
        </table>
    </section>


<script>
    const finnishLang = 'fi-FI';

    function debugLog(message) {
        const output = document.getElementById('debug-output');
        if (output && output.innerHTML !== undefined) {
            const time = new Date().toLocaleTimeString();
            output.innerHTML += `[${time}] ${message}<br>`;
            output.scrollTop = output.scrollHeight;
        }
    }

    function testBasicTTS() {
        debugLog('å¼€å§‹æµ‹è¯•åŸºæœ¬TTSåŠŸèƒ½...');
        if (!('speechSynthesis' in window)) {
            debugLog('âŒ é”™è¯¯ï¼šæµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³åˆæˆAPI');
            alert('æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³åˆæˆåŠŸèƒ½ã€‚');
            return;
        }
        debugLog('âœ… æµè§ˆå™¨æ”¯æŒè¯­éŸ³åˆæˆAPI');
        const utterance = new SpeechSynthesisUtterance('Hello World');
        utterance.onstart = () => debugLog('âœ… è‹±è¯­æµ‹è¯•å¼€å§‹æ’­æ”¾');
        utterance.onend = () => debugLog('âœ… è‹±è¯­æµ‹è¯•æ’­æ”¾å®Œæˆ');
        utterance.onerror = (event) => debugLog('âŒ è‹±è¯­æµ‹è¯•é”™è¯¯: ' + event.error);
        window.speechSynthesis.speak(utterance);
    }

    function testFinnishTTSModule3_Dim5() { 
        debugLog('å¼€å§‹æµ‹è¯•èŠ¬å…°è¯­TTSåŠŸèƒ½ (æ¨¡å—3.5)...');
        const utterance = new SpeechSynthesisUtterance('Avain on kupin vieressÃ¤.');
        utterance.lang = finnishLang;
        utterance.onstart = () => debugLog('âœ… èŠ¬å…°è¯­(M3 D5)æµ‹è¯•å¼€å§‹æ’­æ”¾');
        utterance.onend = () => debugLog('âœ… èŠ¬å…°è¯­(M3 D5)æµ‹è¯•æ’­æ”¾å®Œæˆ');
        utterance.onerror = (event) => debugLog('âŒ èŠ¬å…°è¯­(M3 D5)æµ‹è¯•é”™è¯¯: ' + event.error);
        window.speechSynthesis.speak(utterance);
    }
     function listVoices() {
        debugLog('æ­£åœ¨è·å–å¯ç”¨è¯­éŸ³åˆ—è¡¨...');
        const voices = window.speechSynthesis.getVoices();
        if (voices.length === 0) {
            debugLog('âš ï¸ æœªæ‰¾åˆ°ä»»ä½•è¯­éŸ³ï¼Œè¯­éŸ³å¯èƒ½è¿˜åœ¨åŠ è½½ä¸­ã€‚');
            window.speechSynthesis.onvoiceschanged = () => {
                debugLog('è¯­éŸ³åˆ—è¡¨å·²æ›´æ–°ï¼Œé‡æ–°è·å–...');
                const updatedVoices = window.speechSynthesis.getVoices();
                if (updatedVoices.length === 0 && voices.length === 0) { 
                    debugLog('âš ï¸ æ›´æ–°åä»æœªæ‰¾åˆ°ä»»ä½•è¯­éŸ³ã€‚'); return;
                }
                if (updatedVoices.length > 0) logVoiceList(updatedVoices);
            };
             if (navigator.userAgent.toLowerCase().indexOf('firefox') > -1 || (navigator.userAgent.toLowerCase().indexOf('safari') > -1 && navigator.userAgent.toLowerCase().indexOf('chrome') === -1) ) {
                setTimeout(() => { if(window.speechSynthesis.getVoices().length > 0) listVoices(); }, 500);
            }
            return;
        }
        logVoiceList(voices);
    }
     function logVoiceList(voices) {
        debugLog(`æ‰¾åˆ° ${voices.length} ä¸ªå¯ç”¨è¯­éŸ³:`);
        voices.forEach((voice, index) => {
            const isDefault = voice.default ? ' (é»˜è®¤)' : '';
            debugLog(`${index + 1}. ${voice.name} (${voice.lang})${isDefault}`);
        });
        const finnishVoices = voices.filter(voice =>
            voice.lang.toLowerCase().startsWith('fi') ||
            voice.name.toLowerCase().includes('finnish') ||
            voice.name.toLowerCase().includes('suomi')
        );
        if (finnishVoices.length > 0) {
            debugLog(`âœ… æ‰¾åˆ° ${finnishVoices.length} ä¸ªèŠ¬å…°è¯­è¯­éŸ³:`);
            finnishVoices.forEach(voice => {
                debugLog(`  - ${voice.name} (${voice.lang})`);
            });
        } else {
            debugLog('âŒ æœªæ‰¾åˆ°èŠ¬å…°è¯­è¯­éŸ³ã€‚');
        }
    }

    function removeDebugSection() {
        const debugSection = document.querySelector('.debug-section');
        if (debugSection) {
            debugSection.style.display = 'none';
            debugLog('è°ƒè¯•åŒºåŸŸå·²éšè—');
        }
    }

    let isSpeaking = false;
    function speakText(text, lang = finnishLang) {
        if (!('speechSynthesis' in window)) return;
        if (isSpeaking) {
            window.speechSynthesis.cancel();
            setTimeout(() => startSpeaking(text, lang), 50);
        } else {
            startSpeaking(text, lang);
        }
    }

    function startSpeaking(text, lang) {
        isSpeaking = true;
        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = lang;
        utterance.rate = 0.9;
        utterance.pitch = 1.0;
        utterance.volume = 1.0;
        const voices = window.speechSynthesis.getVoices();
        let selectedVoice = null;
        if (lang.toLowerCase().startsWith('fi')) {
            selectedVoice = voices.find(voice => voice.lang.toLowerCase() === 'fi-fi') ||
                            voices.find(voice => voice.lang.toLowerCase().startsWith('fi')) ||
                            voices.find(voice => voice.name.toLowerCase().includes('finnish') || voice.name.toLowerCase().includes('suomi'));
        }
        if (selectedVoice) utterance.voice = selectedVoice;
        utterance.onend = () => { isSpeaking = false; };
        utterance.onerror = (event) => {
            debugLog(`âŒ æ’­æ”¾é”™è¯¯: ${event.error} (æ–‡æœ¬: "${text}")`);
            isSpeaking = false;
        };
        window.speechSynthesis.speak(utterance);
    }

    function addTTSButton(element, textToSpeak) {
        let cleanedText = textToSpeak.replace(/\s*\(.*?\)\s*/g, '').trim(); 
        cleanedText = cleanedText.replace(/ï¼ˆ.*?ï¼‰/g, '').trim();
        cleanedText = cleanedText.replace(/\[.*?\]/g, '').trim();

        if (!cleanedText || cleanedText === '') return;
        
        const existingButton = Array.from(element.childNodes).find(node => node.nodeType === Node.ELEMENT_NODE && node.classList.contains('tts-button') && node.title === 'æ’­æ”¾: ' + cleanedText);
        if (existingButton) return;

        const button = document.createElement('button');
        button.className = 'tts-button';
        button.innerHTML = 'ğŸ”Š';
        button.title = 'æ’­æ”¾: ' + cleanedText;
        button.setAttribute('aria-label', 'æ’­æ”¾éŸ³é¢‘: ' + cleanedText);
        button.onclick = (event) => {
            event.preventDefault();
            event.stopPropagation();
            speakText(cleanedText);
        };
        
        if (element.tagName === 'SPAN' && (element.classList.contains('speakable-finnish') || element.classList.contains('finnish-phrase'))) {
            if (!element.querySelector('.tts-button')) {
                element.appendChild(button);
            }
        } else {
            let insertBeforeNode = null;
            for (let i = 0; i < element.childNodes.length; i++) {
                const child = element.childNodes[i];
                if (child.nodeType === Node.ELEMENT_NODE && (child.classList.contains('note') || child.classList.contains('chinese-sense'))) {
                    insertBeforeNode = child;
                    break;
                }
            }
            if (insertBeforeNode) {
                element.insertBefore(button, insertBeforeNode);
            } else {
                element.appendChild(button);
            }
        }
    }
    
    function initializeTTSForPage() {
        debugLog('ğŸš€ åˆå§‹åŒ–é¡µé¢TTSæŒ‰é’® (æ¨¡å—ä¸‰Â·ç»´åº¦äº” ä½ç½®å…³ç³»)...');
        
        document.querySelectorAll('.speakable-finnish, .finnish-phrase').forEach(span => {
            const text = span.textContent.trim();
            if (text && !span.querySelector('.tts-button')) {
                 addTTSButton(span, text);
            }
        });

        const sentenceLevelContainers = [
            ...document.querySelectorAll('.partner-card-content p.example-sentence'),
            ...document.querySelectorAll('.usage-example p'), 
            ...document.querySelectorAll('.interactive-choice button'),
            ...document.querySelectorAll('.practice-plan-card .task-list ul li'), 
            ...document.querySelectorAll('#intro-dimension5 .example p'),
            ...document.querySelectorAll('#intro-dimension5 .concept-map p, #intro-dimension5 .concept-map h3'),
            ...document.querySelectorAll('.new-vocab-section .vocab-list-table td'),
            ...document.querySelectorAll('#dim5-summary-and-next .summary-card p'),
            ...document.querySelectorAll('#dim5-summary-and-next .summary-card ul li')
        ];

        sentenceLevelContainers.forEach(el => {
            if (el.classList.contains('speakable-finnish') || el.classList.contains('finnish-phrase')) return;
            if (el.querySelector('.tts-button')) { 
                let hasOwnButton = false;
                for(let child of el.childNodes){
                    if(child.nodeType === Node.ELEMENT_NODE && child.classList.contains('tts-button')){
                        hasOwnButton = true;
                        break;
                    }
                }
                if(hasOwnButton || el.querySelector('.speakable-finnish .tts-button')) return;
            }
            if (el.closest('thead')) return;

            let textToSpeak = "";
            Array.from(el.childNodes).forEach(node => {
                 if (node.nodeType === Node.TEXT_NODE) {
                    textToSpeak += node.textContent;
                } else if (node.nodeType === Node.ELEMENT_NODE &&
                           !node.classList.contains('note') &&
                           !node.classList.contains('chinese-sense') &&
                           !node.classList.contains('tts-button') &&
                           node.tagName !== 'svg' &&
                           node.tagName !== 'g' &&
                           node.tagName !== 'rect' &&
                           node.tagName !== 'path' &&
                           node.tagName !== 'circle'
                           ) {
                    textToSpeak += node.textContent; 
                }
            });
            textToSpeak = textToSpeak.trim();
            
            if (textToSpeak.length > 1 && (textToSpeak.match(/[a-zA-Z]/) || textToSpeak.match(/[Ã¤Ã¶Ã¥Ã„Ã–Ã…]/))) { 
                addTTSButton(el, textToSpeak);
            }
        });
        
        document.querySelectorAll('.partner-card h4 .speakable-finnish, .practice-plan-card .task-list h5 .speakable-finnish').forEach(el => {
             if(!el.querySelector('.tts-button')) addTTSButton(el, el.textContent);
        });
        
        document.querySelectorAll('h2, h3').forEach(h => {
            if (!h.querySelector('.tts-button')) { 
                const text = h.textContent.split('(')[0].trim();
                if (text.length > 1 && text.match(/[Ã¤Ã¶Ã¥Ã„Ã–Ã…]/i)) {
                    addTTSButton(h, text);
                }
            }
        });

        debugLog('âœ… é¡µé¢TTSæŒ‰é’®åˆå§‹åŒ–å®Œæ¯• (æ¨¡å—ä¸‰Â·ç»´åº¦äº” ä½ç½®å…³ç³»)');
    }
    
    // --- Interactive Quiz for Dimension 5 ---
    const dim5Questions = [
        {
            question_fi: "MissÃ¤ puhelin on?",
            question_zh: "æ‰‹æœºåœ¨å“ªé‡Œï¼Ÿ",
            options: [
                { text_fi: "Se on kirjan vieressÃ¤.", correct: true },
                { text_fi: "Se on kupin alla.", correct: false },
                { text_fi: "Se on avaimen vastapÃ¤Ã¤tÃ¤.", correct: false }
            ]
        },
        {
            question_fi: "MissÃ¤ avain on?",
            question_zh: "é’¥åŒ™åœ¨å“ªé‡Œï¼Ÿ",
            options: [
                { text_fi: "Se on kirjan ja kupin vÃ¤lissÃ¤.", correct: false }, // Let's create a new correct answer for this one.
                { text_fi: "Se on puhelimen ja kupin vÃ¤lissÃ¤.", correct: true },
                { text_fi: "Se on pÃ¶ydÃ¤n pÃ¤Ã¤llÃ¤.", correct: false } // Too generic, let's make it more specific
            ]
        },
        {
            question_fi: "MitÃ¤ on kupin vieressÃ¤?",
            question_zh: "æ¯å­æ—è¾¹æœ‰ä»€ä¹ˆï¼Ÿ",
            options: [
                { text_fi: "Kirja ja puhelin.", correct: false },
                { text_fi: "Vain avain.", correct: false },
                { text_fi: "Puhelin ja avain.", correct: true } // Assuming 'vieressÃ¤' can mean generally next to
            ]
        }
    ];
    
    // Correction for the scene logic: avain is between puhelin and kuppi.
    // Let's adjust Q2 to reflect this.
    dim5Questions[1].options = [
        { text_fi: "Se on kirjan ja kupin vÃ¤lissÃ¤.", correct: false },
        { text_fi: "Se on puhelimen ja kupin vÃ¤lissÃ¤.", correct: true },
        { text_fi: "Se on pÃ¶ydÃ¤n pÃ¤Ã¤llÃ¤.", correct: false } 
    ];

    let currentDim5QuestionIndex = 0;
    const qDim5Container = document.getElementById('q-dim5-container');
    const feedbackDim5El = document.getElementById('feedback-area-dim5');

    function displayDim5Question() {
        if (!qDim5Container || !feedbackDim5El) return;
        const q = dim5Questions[currentDim5QuestionIndex];
        
        let html = `<p><strong class="speakable-finnish">${q.question_fi}</strong> <span class="note">(${q.question_zh})</span></p>`;
        html += `<div class="interactive-choice" style="text-align: center;">`;
        q.options.forEach(opt => {
            html += `<button onclick="checkDim5Answer(${opt.correct}, '${opt.text_fi}')">${opt.text_fi}</button>`;
        });
        html += `</div>`;
        qDim5Container.innerHTML = html;
        feedbackDim5El.innerHTML = "";
        feedbackDim5El.className = 'feedback-area';
        
        qDim5Container.querySelectorAll('.speakable-finnish, button').forEach(el => {
            if(!el.querySelector('.tts-button')) addTTSButton(el, el.textContent);
        });
    }

    function checkDim5Answer(isCorrect, selectedText) {
        if (!feedbackDim5El) return;
        let feedbackText = "";
        if (isCorrect) {
            feedbackText = `<span class="speakable-finnish">Aivan oikein! ${selectedText}</span>`;
            feedbackDim5El.className = 'feedback-area correct';
        } else {
            const correctAnswer = dim5Questions[currentDim5QuestionIndex].options.find(opt => opt.correct).text_fi;
            feedbackText = `<span class="speakable-finnish">Ei ihan. Oikea vastaus on: ${correctAnswer}</span> <span class="note">(YritÃ¤ uudelleen tai katso seuraava kysymys!)</span>`;
            feedbackDim5El.className = 'feedback-area incorrect';
        }
        feedbackDim5El.innerHTML = feedbackText;
        feedbackDim5El.querySelectorAll('.speakable-finnish').forEach(el => {
            if (!el.querySelector('.tts-button')) addTTSButton(el, el.textContent);
        });
        const mainFeedbackSpan = feedbackDim5El.querySelector('.speakable-finnish');
        if(mainFeedbackSpan) speakText(mainFeedbackSpan.textContent.split('.')[0] + '.');
    }

    function nextDim5Question() {
        currentDim5QuestionIndex = (currentDim5QuestionIndex + 1) % dim5Questions.length;
        displayDim5Question();
    }

    document.addEventListener('DOMContentLoaded', () => {
        if (window.speechSynthesis.getVoices().length === 0) {
            window.speechSynthesis.onvoiceschanged = initializeTTSForPage;
        } else {
            initializeTTSForPage();
        }
        setTimeout(initializeTTSForPage, 200); 
        if (document.getElementById('q-dim5-container')) {
             displayDim5Question(); 
        }
    });
</script>
</body>
</html>