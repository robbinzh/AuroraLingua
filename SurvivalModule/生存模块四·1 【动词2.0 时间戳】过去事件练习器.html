<!DOCTYPE html>
<html lang="fi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>èŠ¬å…°è¯­æ¨¡å—å››ï¼šæ—¶é—´æˆ³é©±åŠ¨ (Verb 2.0) åŸå‹</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;700&display=swap');

        body {
            font-family: 'Noto Sans', sans-serif;
            background-color: #f0f2f5;
            color: #333;
            line-height: 1.6;
            display: flex;
            justify-content: center;
            padding: 20px;
        }

        .container {
            width: 100%;
            max-width: 800px;
            background-color: #fff;
            padding: 20px 40px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        h1, h2, h3 {
            color: #003580; /* Finnish Flag Blue */
            border-bottom: 2px solid #e7e9ec;
            padding-bottom: 10px;
        }

        h1 { font-size: 2em; text-align: center; }
        h2 { font-size: 1.6em; margin-top: 40px; }
        h3 { font-size: 1.2em; }

        .module {
            margin-bottom: 50px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background-color: #fafafa;
        }

        .instructions {
            background-color: #e6f3ff;
            border-left: 5px solid #0056b3;
            padding: 10px 15px;
            margin-bottom: 20px;
            border-radius: 5px;
        }

        .button {
            display: inline-block;
            background-color: #0056b3;
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            transition: background-color 0.3s;
            text-align: center;
            margin-top: 15px;
        }

        .button:hover {
            background-color: #003580;
        }

        .highlight {
            color: #d9534f;
            font-weight: bold;
        }
        
        /* TTS and Translation Styles */
        .tts-btn {
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            cursor: pointer;
            font-size: 14px;
            margin-left: 10px;
            transition: background-color 0.3s;
        }
        
        .tts-btn:hover {
            background-color: #218838;
        }
        
        .translation-toggle {
            background-color: #6c757d;
            color: white;
            border: none;
            border-radius: 15px;
            padding: 5px 10px;
            cursor: pointer;
            font-size: 12px;
            margin-left: 10px;
            transition: background-color 0.3s;
        }
        
        .translation-toggle:hover {
            background-color: #5a6268;
        }
        
        .translation {
            color: #666;
            font-style: italic;
            margin-top: 5px;
            display: none;
        }
        
        .sentence-container {
            position: relative;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        /* Stage 1: Aikakone */
        #aikakone-display {
            display: flex;
            justify-content: space-around;
            text-align: center;
            font-size: 1.2em;
            padding: 20px;
            background-color: #fff;
            border-radius: 5px;
        }

        /* Stage 2: Tapahtumatoistin */
        .image-container {
            text-align: center;
            margin-bottom: 15px;
        }
        .image-container img {
            max-width: 100%;
            height: 250px;
            border: 2px solid #ccc;
            border-radius: 5px;
            background-color: #eee;
        }
        
        /* Visual Event Animations */
        .visual-event {
            width: 100%;
            height: 250px;
            border: 2px solid #ccc;
            border-radius: 5px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-size: 60px;
            position: relative;
            overflow: hidden;
        }
        
        .visual-event.process {
            background: linear-gradient(135deg, #E8D8A7, #F5E6B3);
        }
        
        .visual-event.result {
            background: linear-gradient(135deg, #A3C9A8, #B8D4BD);
        }
        
        .event-emoji {
            font-size: 80px;
            margin-bottom: 10px;
        }
        
        .event-action {
            font-size: 40px;
            opacity: 0.7;
        }
        
        .event-label {
            position: absolute;
            bottom: 10px;
            font-size: 16px;
            font-weight: bold;
            color: #333;
        }
        
        /* Specific animations for each event */
        @keyframes eating {
            0%, 100% { transform: rotate(0deg); }
            50% { transform: rotate(-15deg); }
        }
        
        @keyframes drinking {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        @keyframes reading {
            0%, 100% { transform: rotateY(0deg); }
            50% { transform: rotateY(15deg); }
        }
        
        @keyframes writing {
            0%, 100% { transform: translate(0px, 0px); }
            25% { transform: translate(5px, -5px); }
            75% { transform: translate(-5px, 5px); }
        }
        
        @keyframes painting {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(5deg); }
            75% { transform: rotate(-5deg); }
        }
        
        @keyframes cleaning {
            0%, 100% { transform: translateX(0px); }
            50% { transform: translateX(20px); }
        }
        
        @keyframes shopping {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        @keyframes fixing {
            0%, 100% { transform: rotateZ(0deg); }
            25% { transform: rotateZ(10deg); }
            75% { transform: rotateZ(-10deg); }
        }
        
        @keyframes closing {
            0% { transform: scaleX(1); }
            100% { transform: scaleX(0.1); }
        }
        
        @keyframes cooking {
            0%, 100% { transform: rotate(0deg); }
            50% { transform: rotate(360deg); }
        }
        
        .process .eating { animation: eating 2s infinite; }
        .process .drinking { animation: drinking 1.5s infinite; }
        .process .reading { animation: reading 2s infinite; }
        .process .writing { animation: writing 1s infinite; }
        .process .painting { animation: painting 1.5s infinite; }
        .process .cleaning { animation: cleaning 1.5s infinite; }
        .process .shopping { animation: shopping 2s infinite; }
        .process .fixing { animation: fixing 1s infinite; }
        .process .closing { animation: closing 3s infinite; }
        .process .cooking { animation: cooking 2s infinite; }
        
        .result .event-emoji {
            opacity: 0.8;
            filter: brightness(1.2);
        }
        #tapahtumatoistin-sentence {
            font-size: 1.3em;
            text-align: center;
            font-weight: bold;
            padding: 10px;
        }
        #tapahtumatoistin-answer {
            background-color: #dff0d8;
            border: 1px solid #d6e9c6;
            color: #3c763d;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
            font-size: 1.1em;
        }
        .controls {
            display: flex;
            gap: 20px;
            align-items: center;
            margin-bottom: 15px;
        }

        /* Stage 3: Kielioppimatriisi */
        #sentence-display {
            font-size: 2em;
            text-align: center;
            font-weight: bold;
            padding: 30px 10px;
            background-color: #fcf8e3;
            border: 2px dashed #f0ad4e;
            color: #8a6d3b;
            min-height: 70px;
            border-radius: 5px;
        }
        
        /* Stage 4: Cognitive Upgrade */
        .guided-question {
            background-color: #f8f9fa;
            border-left: 4px solid #007bff;
            padding: 20px;
            margin: 25px 0;
            border-radius: 0 8px 8px 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .guided-question h3 {
            color: #007bff;
            margin-top: 0;
            font-size: 1.3em;
            border-bottom: none;
            padding-bottom: 0;
        }
        
        .guided-question p {
            line-height: 1.7;
            font-size: 1.05em;
            color: #495057;
        }
        
        .answer-space {
            min-height: 60px;
            border: 2px dashed #dee2e6;
            border-radius: 5px;
            margin: 15px 0;
            background-color: #fff;
            position: relative;
        }
        
        .answer-space::before {
            content: "ğŸ’­ æ€è€ƒç©ºé—´ï¼šè¯·åœ¨è„‘ä¸­æˆ–çº¸ä¸Šå›ç­”è¿™ä¸ªé—®é¢˜...";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #6c757d;
            font-style: italic;
            text-align: center;
            opacity: 0.7;
        }
        
        .completion-message {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            padding: 25px;
            border-radius: 10px;
            text-align: center;
            margin-top: 30px;
            box-shadow: 0 4px 15px rgba(40,167,69,0.3);
        }
        
        .completion-message h3 {
            margin-top: 0;
            font-size: 1.5em;
            border-bottom: none;
            padding-bottom: 0;
            color: white;
        }
        
        .completion-message p {
            font-size: 1.1em;
            line-height: 1.6;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>æ¨¡å—å››ï¼šæ—¶é—´æˆ³é©±åŠ¨ (Verb 2.0) åŸå‹</h1>
        <p class="instructions">è¿™æ˜¯ä¸€ä¸ªäº¤äº’å¼åŸå‹ï¼Œç”¨äºå®è·µèŠ¬å…°è¯­è¿‡å»æ—¶(Imperfekti)åŠå…¶ä¸å®¾è¯­æ ¼çš„è”åŠ¨ã€‚è¯·æŒ‰ç…§ä¸‰ä¸ªé˜¶æ®µçš„é¡ºåºè¿›è¡Œç»ƒä¹ ã€‚</p>

        <!-- ========================================================== -->
        <!-- é˜¶æ®µä¸€ï¼šéš”ç¦»å®‰è£… (Aikakone) -->
        <!-- ========================================================== -->
        <div class="module">
            <h2>é˜¶æ®µä¸€ï¼šéš”ç¦»å®‰è£… - "æ—¶é—´ç©¿æ¢­æœº"</h2>
            <p class="instructions"><strong>ç›®æ ‡ï¼š</strong>å»ºç«‹åŠ¨è¯è¿‡å»æ—¶çš„å£°éŸ³ç›´è§‰ã€‚è¯·å¤§å£°è·Ÿè¯»ï¼Œåªéœ€å…³æ³¨<span class="highlight">åŠ¨è¯</span>çš„å‘éŸ³å˜åŒ–ã€‚</p>
            <div id="aikakone-display">
                <div class="aikakone-column">
                    <h3>NYT (ç°åœ¨)</h3>
                    <div class="sentence-container">
                        <p id="aikakone-nyt">...</p>
                        <button class="tts-btn" onclick="speakText(document.getElementById('aikakone-nyt').textContent)">ğŸ”Š</button>
                        <button class="translation-toggle" onclick="toggleTranslation('aikakone-nyt-translation')">ä¸­æ–‡</button>
                    </div>
                    <div id="aikakone-nyt-translation" class="translation"></div>
                </div>
                <div class="aikakone-column">
                    <h3>EILEN (æ˜¨å¤©)</h3>
                    <div class="sentence-container">
                        <p id="aikakone-eilen">...</p>
                        <button class="tts-btn" onclick="speakText(document.getElementById('aikakone-eilen').textContent)">ğŸ”Š</button>
                        <button class="translation-toggle" onclick="toggleTranslation('aikakone-eilen-translation')">ä¸­æ–‡</button>
                    </div>
                    <div id="aikakone-eilen-translation" class="translation"></div>
                </div>
            </div>
            <button class="button" onclick="runAikakone()">ä¸‹ä¸€ç»„ (Seuraava)</button>
        </div>

        <!-- ========================================================== -->
        <!-- é˜¶æ®µäºŒï¼šè”åŠ¨åè®®æ¿€æ´» (Tapahtumatoistin) -->
        <!-- ========================================================== -->
        <div class="module">
            <h2>é˜¶æ®µäºŒï¼šè”åŠ¨åè®®æ¿€æ´» - "äº‹ä»¶å›æ”¾æ¨¡æ‹Ÿå™¨"</h2>
            <p class="instructions"><strong>ç›®æ ‡ï¼š</strong>å°†"è¿‡å»æ—¶åŠ¨è¯"å’Œ"å®Œæˆæ€å®¾è¯­"è¿›è¡Œå› æœç»‘å®šã€‚æ„Ÿå—å›¾ç‰‡å’Œå¥å­å¦‚ä½•åŒæ­¥å˜åŒ–ã€‚</p>
            
            <div class="controls">
                <label for="event-select">é€‰æ‹©äº‹ä»¶:</label>
                <select id="event-select" onchange="runTapahtumatoistin(true)">
                    <!-- Options will be populated by JS -->
                </select>
                <div>
                    <input type="radio" id="mode-passive" name="tapahtumatoistin-mode" value="passive" checked onchange="runTapahtumatoistin(true)">
                    <label for="mode-passive">è¢«åŠ¨å­¦ä¹ </label>
                </div>
                 <div>
                    <input type="radio" id="mode-active" name="tapahtumatoistin-mode" value="active" onchange="runTapahtumatoistin(true)">
                    <label for="mode-active">ä¸»åŠ¨å›æ”¾</label>
                </div>
            </div>

            <div class="image-container">
                <div id="tapahtumatoistin-visual" class="visual-event">
                    <div id="event-emoji" class="event-emoji">ğŸ</div>
                    <div id="event-action" class="event-action">âœ¨</div>
                    <div id="event-label" class="event-label">è¿‡ç¨‹ä¸­...</div>
                </div>
            </div>
            <div class="sentence-container">
                <p id="tapahtumatoistin-sentence">...</p>
                <button class="tts-btn" onclick="speakText(document.getElementById('tapahtumatoistin-sentence').textContent)">ğŸ”Š</button>
                <button class="translation-toggle" onclick="toggleTranslation('tapahtumatoistin-sentence-translation')">ä¸­æ–‡</button>
            </div>
            <div id="tapahtumatoistin-sentence-translation" class="translation"></div>
            <div id="tapahtumatoistin-answer-container" style="display: none;">
                <div class="sentence-container">
                    <p id="tapahtumatoistin-answer">...</p>
                    <button class="tts-btn" onclick="speakText(document.getElementById('tapahtumatoistin-answer').textContent)">ğŸ”Š</button>
                    <button class="translation-toggle" onclick="toggleTranslation('tapahtumatoistin-answer-translation')">ä¸­æ–‡</button>
                </div>
                <div id="tapahtumatoistin-answer-translation" class="translation"></div>
            </div>
            <button class="button" id="tapahtumatoistin-button" onclick="handleTapahtumatoistinClick()">Valmis! (å®Œæˆ!)</button>
        </div>

        <!-- ========================================================== -->
        <!-- é˜¶æ®µä¸‰ï¼šç³»ç»Ÿè‡ªåŠ¨åŒ– (Kielioppimatriisi) -->
        <!-- ========================================================== -->
        <div class="module">
            <h2>é˜¶æ®µä¸‰ï¼šç³»ç»Ÿè‡ªåŠ¨åŒ– - "è¯­æ³•çŸ©é˜µ"</h2>
            <p class="instructions"><strong>ç›®æ ‡ï¼š</strong>é€šè¿‡è®¤çŸ¥å†²å‡»ï¼Œå°†è¯­æ³•æ¨¡å¼å†…åŒ–ä¸ºæœ¬èƒ½ã€‚<strong>ä½ çš„ä»»åŠ¡ä¸æ˜¯ç†è§£ï¼Œè€Œæ˜¯è·Ÿä¸ŠèŠ‚å¥ï¼Œå¿«é€Ÿè·Ÿè¯»ï¼</strong></p>
            <div class="sentence-container">
                <div id="sentence-display">ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®ç”Ÿæˆå¥å­ã€‚</div>
                <button class="tts-btn" onclick="speakText(document.getElementById('sentence-display').textContent)" style="align-self: flex-start;">ğŸ”Š</button>
                <button class="translation-toggle" onclick="toggleTranslation('sentence-display-translation')" style="align-self: flex-start;">ä¸­æ–‡</button>
            </div>
            <div id="sentence-display-translation" class="translation"></div>
            <button class="button" onclick="runKielioppimatriisi()">Luo uusi lause (ç”Ÿæˆæ–°å¥å­)</button>
        </div>

        <!-- ========================================================== -->
        <!-- é˜¶æ®µå››ï¼šè®¤çŸ¥å‡å (Kokonaiskuva) -->
        <!-- ========================================================== -->
        <div class="module">
            <h2>é˜¶æ®µå››ï¼šè®¤çŸ¥å‡å - "æ€»è®¾è®¡å¸ˆè“å›¾"</h2>
            <p class="instructions">
                <strong>ç›®æ ‡ï¼š</strong>å°†ä½ å·²ç»å†…åŒ–çš„"è¯­æ„Ÿ"è½¬åŒ–ä¸ºæ¸…æ™°çš„"è®¾è®¡è§„åˆ™"ã€‚è¯·å›ç­”ä»¥ä¸‹é—®é¢˜ï¼Œå°†ä½ çš„å‘ç°æ•´ç†æˆä½ çš„ç§äººèŠ¬å…°è¯­çŸ¥è¯†åº“ï¼
            </p>

            <div class="guided-question">
                <h3>é—®é¢˜1ï¼šæ—¶é—´çš„å°è®°</h3>
                <p>å›é¡¾é˜¶æ®µä¸€å’ŒäºŒï¼Œå½“ä½ æƒ³è¦æè¿°ä¸€ä»¶ã€æ˜¨å¤©å‘ç”Ÿã€‘çš„äº‹æ—¶ï¼ŒèŠ¬å…°è¯­çš„åŠ¨è¯æœ¬èº«å‘ç”Ÿäº†ä»€ä¹ˆæœ€æ ¸å¿ƒçš„å˜åŒ–ï¼Ÿï¼ˆæç¤ºï¼šè§‚å¯Ÿé‚£äº›é«˜äº®çš„åŠ¨è¯ï¼Œå®ƒä»¬å…±åŒçš„"å£°éŸ³å¯†ç "æ˜¯ä»€ä¹ˆï¼Ÿï¼‰</p>
                <div class="answer-space">
                    <!-- å­¦ä¹ è€…å¯ä»¥åœ¨è„‘ä¸­æˆ–çº¸ä¸Šå›ç­” -->
                </div>
                <button class="translation-toggle" onclick="toggleTranslation('answer1')">ç‚¹å‡»æŸ¥çœ‹è®¤çŸ¥é”šç‚¹</button>
                <div id="answer1" class="translation">
                    <p><strong>è®¤çŸ¥é”šç‚¹ï¼š</strong>åŠ¨è¯çš„ä¸­é—´é€šå¸¸ä¼šåŠ å…¥ä¸€ä¸ª <strong>-i-</strong> æ ‡è®°ï¼Œè¿™å°±æ˜¯èŠ¬å…°è¯­è¿‡å»æ—¶çš„"æ—¶é—´æˆ³"ã€‚ä¾‹å¦‚ï¼šlukea -> luk<strong>i</strong>, syÃ¶dÃ¤ -> sÃ¶<strong>i</strong>ã€‚ä½ å·²ç»æŒæ¡äº†å¯åŠ¨"æ—¶é—´ç©¿æ¢­æœº"çš„ç¬¬ä¸€ä¸ªå¯†ç ï¼</p>
                </div>
            </div>

            <div class="guided-question">
                <h3>é—®é¢˜2ï¼šå®Œæˆçš„ä¿¡å·</h3>
                <p>è§‚å¯Ÿé˜¶æ®µäºŒçš„"äº‹ä»¶å›æ”¾æ¨¡æ‹Ÿå™¨"ã€‚å½“ä¸€ä¸ªåŠ¨ä½œã€æ­£åœ¨è¿›è¡Œã€‘(esim. æ­£åœ¨åƒè‹¹æœ) æ—¶ï¼Œå¥å­çš„å®¾è¯­ (è‹¹æœ) æ˜¯ä»€ä¹ˆå½¢å¼ï¼Ÿå½“è¿™ä¸ªåŠ¨ä½œã€å·²ç»å®Œæˆã€‘(esim. åƒå®Œäº†è‹¹æœ) æ—¶ï¼Œå®¾è¯­çš„å½¢å¼åˆå‘ç”Ÿäº†ä»€ä¹ˆç¥å¥‡çš„å˜åŒ–ï¼Ÿ</p>
                <div class="answer-space"></div>
                <button class="translation-toggle" onclick="toggleTranslation('answer2')">ç‚¹å‡»æŸ¥çœ‹è®¤çŸ¥é”šç‚¹</button>
                <div id="answer2" class="translation">
                    <p><strong>è®¤çŸ¥é”šç‚¹ï¼š</strong>æ²¡é”™ï¼</p>
                    <ul>
                        <li><strong>è¿›è¡Œä¸­ (éƒ¨åˆ†æ ¼, Partitiivi):</strong> `omenaa` (-a/Ã¤, -ta/tÃ¤, -tta/ttÃ¤ç»“å°¾)ã€‚è¿™è¡¨ç¤ºåŠ¨ä½œä½œç”¨äºç‰©ä½“çš„ä¸€éƒ¨åˆ†ï¼Œæˆ–ç»“æœä¸ç¡®å®šã€‚</li>
                        <li><strong>å·²å®Œæˆ (å±æ ¼/å®¾æ ¼, Genetiivi/Akkusatiivi):</strong> `omenan` (-nç»“å°¾)ã€‚è¿™åƒä¸€ä¸ª"å®Œæˆ"çš„å°ç« ï¼Œè¡¨ç¤ºæ•´ä¸ªåŠ¨ä½œç»“æŸï¼Œå¹¶äº§å‡ºäº†ä¸€ä¸ªå®Œæ•´çš„ç»“æœã€‚</li>
                    </ul>
                    <p><strong>è¿™å°±æ˜¯èŠ¬å…°è¯­å®¾è¯­æ ¼çš„æ ¸å¿ƒç§˜å¯†ï¼šå®ƒä¸ä»…ä»…è¯´æ˜"è°æ˜¯å®¾è¯­"ï¼Œæ›´é‡è¦çš„æ˜¯æè¿°äº†"åŠ¨ä½œçš„çŠ¶æ€å’Œç»“æœ"ï¼</strong></p>
                </div>
            </div>
            
            <div class="guided-question">
                <h3>é—®é¢˜3ï¼šä½ çš„è®¾è®¡è“å›¾</h3>
                <p>ç°åœ¨ï¼Œè¯·è¯•ç€ç”¨ä½ è‡ªå·±çš„è¯ï¼Œæ€»ç»“ä¸€ä¸‹ï¼šå¦‚æœæˆ‘æ˜¨å¤©ã€å®Œæˆã€‘äº†ä¸€ä»¶äº‹ï¼ˆæ¯”å¦‚"æˆ‘è¯»å®Œäº†ä¸€æœ¬ä¹¦"ï¼‰ï¼Œæˆ‘éœ€è¦å¯¹å¥å­é‡Œçš„å“ªä¸¤ä¸ªéƒ¨åˆ†è¿›è¡Œ"ç¼–è¯‘"ï¼Œä»¥åŠå¦‚ä½•"ç¼–è¯‘"ï¼Ÿ</p>
                <div class="answer-space"></div>
                <button class="translation-toggle" onclick="toggleTranslation('answer3')">ç‚¹å‡»æŸ¥çœ‹è®¤çŸ¥é”šç‚¹</button>
                <div id="answer3" class="translation">
                    <p><strong>ä¸€ä¸ªä¼˜ç§€çš„è®¾è®¡è“å›¾å¯èƒ½æ˜¯è¿™æ ·çš„ï¼š</strong></p>
                    <p>1. æ‰¾åˆ°ã€åŠ¨è¯ã€‘ï¼Œç»™å®ƒæ‰“ä¸Šè¿‡å»çš„ã€æ—¶é—´æˆ³ã€‘ï¼Œé€šå¸¸æ˜¯åŠ å…¥ <strong>-i-</strong> (esim. `lukea` -> `luin`)ã€‚</p>
                    <p>2. æ‰¾åˆ°ã€å®¾è¯­ã€‘ï¼Œç»™å®ƒç›–ä¸Šã€å·²å®Œæˆã€‘çš„å°ç« ï¼Œé€šå¸¸æ˜¯æŠŠå®ƒå˜æˆ <strong>-n</strong> ç»“å°¾çš„å½¢å¼ (esim. `kirja` -> `kirjan`)ã€‚</p>
                    <p>3. ç»„åˆèµ·æ¥ï¼š`MinÃ¤ luin kirjan.` (æˆ‘è¯»å®Œäº†ä¸€æœ¬ä¹¦ã€‚) æ­å–œä½ ï¼Œä½ å·²ç»ä»ä¸€ä¸ªä½¿ç”¨è€…ï¼Œæ™‹å‡ä¸ºèŠ¬å…°è¯­çš„"å¥å­è®¾è®¡å¸ˆ"äº†ï¼</p>
                </div>
            </div>

            <div class="guided-question">
                <h3>é—®é¢˜4ï¼šè¿ç§»ä¸åº”ç”¨</h3>
                <p>åŸºäºä½ åˆšæ‰æ€»ç»“çš„"è®¾è®¡è“å›¾"ï¼Œè¯•ç€æ„é€ è¿™ä¸ªå¥å­ï¼š"æ˜¨å¤©æˆ‘å®Œæˆäº†ä½œä¸šã€‚"ä½ ä¼šå¦‚ä½•"ç¼–è¯‘"è¿™ä¸ªèŠ¬å…°è¯­å¥å­ï¼Ÿï¼ˆæç¤ºï¼štehdÃ¤ = åšï¼ŒkotitehtÃ¤vÃ¤ = ä½œä¸šï¼‰</p>
                <div class="answer-space"></div>
                <button class="translation-toggle" onclick="toggleTranslation('answer4')">ç‚¹å‡»æŸ¥çœ‹è®¤çŸ¥é”šç‚¹</button>
                <div id="answer4" class="translation">
                    <p><strong>è®¤çŸ¥é”šç‚¹ï¼š</strong></p>
                    <p>æŒ‰ç…§ä½ çš„è®¾è®¡è“å›¾ï¼š</p>
                    <p>1. åŠ¨è¯ï¼š`tehdÃ¤` -> `tein` (åŠ å…¥æ—¶é—´æˆ³ -i-)</p>
                    <p>2. å®¾è¯­ï¼š`kotitehtÃ¤vÃ¤` -> `kotitehtÃ¤vÃ¤n` (åŠ ä¸Šå®Œæˆå°ç«  -n)</p>
                    <p>3. ç»„åˆï¼š`MinÃ¤ tein kotitehtÃ¤vÃ¤n.` (æˆ‘å®Œæˆäº†ä½œä¸šã€‚)</p>
                    <p><strong>ğŸ‰ æ­å–œï¼ä½ å·²ç»èƒ½å¤Ÿç‹¬ç«‹è®¾è®¡èŠ¬å…°è¯­å¥å­äº†ï¼è¿™æ­£æ˜¯çœŸæ­£çš„è¯­è¨€æŒæ§åŠ›ï¼</strong></p>
                </div>
            </div>

            <div class="completion-message">
                <h3>ğŸ† è®¤çŸ¥å‡åå®Œæˆ</h3>
                <p>ä½ å·²ç»æˆåŠŸå®Œæˆäº†ä»"æ„Ÿæ€§ä½“éªŒ"åˆ°"ç†æ€§æŒæ§"çš„è®¤çŸ¥å‡åï¼ç°åœ¨ä½ æ‹¥æœ‰çš„ä¸å†åªæ˜¯"è¯­æ„Ÿ"ï¼Œè€Œæ˜¯å¯ä»¥æ¸…æ™°è¡¨è¿°ã€ä¸»åŠ¨è¿ç”¨ã€çµæ´»è¿ç§»çš„"è®¾è®¡èƒ½åŠ›"ã€‚</p>
                <p><strong>ä¸‹ä¸€æ­¥ï¼š</strong>å°†è¿™äº›è®¤çŸ¥é”šç‚¹è®°å½•åœ¨ä½ çš„å­¦ä¹ ç¬”è®°ä¸­ï¼Œå®ƒä»¬å°†æˆä¸ºä½ èŠ¬å…°è¯­å­¦ä¹ è·¯ä¸Šæœ€æœ‰ä»·å€¼çš„æŒ‡å—é’ˆï¼</p>
            </div>
        </div>

    </div>

    <script>
        // ==========================================================
        // æ•°æ®å±‚ (Data Layer)
        // ==========================================================
        
        // --- é˜¶æ®µä¸€æ•°æ®ï¼šæ’å®šéƒ¨åˆ†æ ¼åŠ¨è¯ï¼ˆåŒ…å«ä¸­æ–‡ç¿»è¯‘ï¼‰ ---
        const aikakoneData = [
            { 
                verbi: "rakastaa", 
                preesens: { minÃ¤: "rakastan", sinÃ¤: "rakastat", hÃ¤n: "rakastaa", me: "rakastamme", te: "rakastatte", he: "rakastavat" }, 
                imperfekti: { minÃ¤: "rakastin", sinÃ¤: "rakastit", hÃ¤n: "rakasti", me: "rakastimme", te: "rakastitte", he: "rakastivat" }, 
                objekti: "sinua",
                translations: {
                    preesens: { minÃ¤: "æˆ‘çˆ±", sinÃ¤: "ä½ çˆ±", hÃ¤n: "ä»–/å¥¹çˆ±", me: "æˆ‘ä»¬çˆ±", te: "ä½ ä»¬çˆ±", he: "ä»–ä»¬çˆ±" },
                    imperfekti: { minÃ¤: "æˆ‘çˆ±è¿‡", sinÃ¤: "ä½ çˆ±è¿‡", hÃ¤n: "ä»–/å¥¹çˆ±è¿‡", me: "æˆ‘ä»¬çˆ±è¿‡", te: "ä½ ä»¬çˆ±è¿‡", he: "ä»–ä»¬çˆ±è¿‡" },
                    objekti: "ä½ "
                }
            },
            { 
                verbi: "odottaa", 
                preesens: { minÃ¤: "odotan", sinÃ¤: "odotat", hÃ¤n: "odottaa", me: "odotamme", te: "odotatte", he: "odottavat" }, 
                imperfekti: { minÃ¤: "odotin", sinÃ¤: "odotit", hÃ¤n: "odotti", me: "odotimme", te: "odotitte", he: "odottivat" }, 
                objekti: "bussia",
                translations: {
                    preesens: { minÃ¤: "æˆ‘åœ¨ç­‰", sinÃ¤: "ä½ åœ¨ç­‰", hÃ¤n: "ä»–/å¥¹åœ¨ç­‰", me: "æˆ‘ä»¬åœ¨ç­‰", te: "ä½ ä»¬åœ¨ç­‰", he: "ä»–ä»¬åœ¨ç­‰" },
                    imperfekti: { minÃ¤: "æˆ‘ç­‰äº†", sinÃ¤: "ä½ ç­‰äº†", hÃ¤n: "ä»–/å¥¹ç­‰äº†", me: "æˆ‘ä»¬ç­‰äº†", te: "ä½ ä»¬ç­‰äº†", he: "ä»–ä»¬ç­‰äº†" },
                    objekti: "å…¬äº¤è½¦"
                }
            },
            { 
                verbi: "pelata", 
                preesens: { minÃ¤: "pelaan", sinÃ¤: "pelaat", hÃ¤n: "pelaa", me: "pelaamme", te: "pelaatte", he: "pelaavat" }, 
                imperfekti: { minÃ¤: "pelasin", sinÃ¤: "pelasit", hÃ¤n: "pelasi", me: "pelasimme", te: "pelasitte", he: "pelasivat" }, 
                objekti: "jalkapalloa",
                translations: {
                    preesens: { minÃ¤: "æˆ‘åœ¨è¸¢", sinÃ¤: "ä½ åœ¨è¸¢", hÃ¤n: "ä»–/å¥¹åœ¨è¸¢", me: "æˆ‘ä»¬åœ¨è¸¢", te: "ä½ ä»¬åœ¨è¸¢", he: "ä»–ä»¬åœ¨è¸¢" },
                    imperfekti: { minÃ¤: "æˆ‘è¸¢äº†", sinÃ¤: "ä½ è¸¢äº†", hÃ¤n: "ä»–/å¥¹è¸¢äº†", me: "æˆ‘ä»¬è¸¢äº†", te: "ä½ ä»¬è¸¢äº†", he: "ä»–ä»¬è¸¢äº†" },
                    objekti: "è¶³çƒ"
                }
            },
            { 
                verbi: "soittaa", 
                preesens: { minÃ¤: "soitan", sinÃ¤: "soitat", hÃ¤n: "soittaa", me: "soitamme", te: "soitatte", he: "soittavat" }, 
                imperfekti: { minÃ¤: "soitin", sinÃ¤: "soitit", hÃ¤n: "soitti", me: "soitimme", te: "soititte", he: "soittivat" }, 
                objekti: "pianoa",
                translations: {
                    preesens: { minÃ¤: "æˆ‘åœ¨å¼¹", sinÃ¤: "ä½ åœ¨å¼¹", hÃ¤n: "ä»–/å¥¹åœ¨å¼¹", me: "æˆ‘ä»¬åœ¨å¼¹", te: "ä½ ä»¬åœ¨å¼¹", he: "ä»–ä»¬åœ¨å¼¹" },
                    imperfekti: { minÃ¤: "æˆ‘å¼¹äº†", sinÃ¤: "ä½ å¼¹äº†", hÃ¤n: "ä»–/å¥¹å¼¹äº†", me: "æˆ‘ä»¬å¼¹äº†", te: "ä½ ä»¬å¼¹äº†", he: "ä»–ä»¬å¼¹äº†" },
                    objekti: "é’¢ç´"
                }
            },
            { 
                verbi: "kuunnella", 
                preesens: { minÃ¤: "kuuntelen", sinÃ¤: "kuuntelet", hÃ¤n: "kuuntelee", me: "kuuntelemme", te: "kuuntelette", he: "kuuntelevat" }, 
                imperfekti: { minÃ¤: "kuuntelin", sinÃ¤: "kuuntelit", hÃ¤n: "kuunteli", me: "kuuntelimme", te: "kuuntelitte", he: "kuuntelivat" }, 
                objekti: "musiikkia",
                translations: {
                    preesens: { minÃ¤: "æˆ‘åœ¨å¬", sinÃ¤: "ä½ åœ¨å¬", hÃ¤n: "ä»–/å¥¹åœ¨å¬", me: "æˆ‘ä»¬åœ¨å¬", te: "ä½ ä»¬åœ¨å¬", he: "ä»–ä»¬åœ¨å¬" },
                    imperfekti: { minÃ¤: "æˆ‘å¬äº†", sinÃ¤: "ä½ å¬äº†", hÃ¤n: "ä»–/å¥¹å¬äº†", me: "æˆ‘ä»¬å¬äº†", te: "ä½ ä»¬å¬äº†", he: "ä»–ä»¬å¬äº†" },
                    objekti: "éŸ³ä¹"
                }
            },
            { 
                verbi: "katsoa", 
                preesens: { minÃ¤: "katson", sinÃ¤: "katsot", hÃ¤n: "katsoo", me: "katsomme", te: "katsotte", he: "katsovat" }, 
                imperfekti: { minÃ¤: "katsoin", sinÃ¤: "katsoit", hÃ¤n: "katsoi", me: "katsoimme", te: "katsoitte", he: "katsoivat" }, 
                objekti: "televisiota",
                translations: {
                    preesens: { minÃ¤: "æˆ‘åœ¨çœ‹", sinÃ¤: "ä½ åœ¨çœ‹", hÃ¤n: "ä»–/å¥¹åœ¨çœ‹", me: "æˆ‘ä»¬åœ¨çœ‹", te: "ä½ ä»¬åœ¨çœ‹", he: "ä»–ä»¬åœ¨çœ‹" },
                    imperfekti: { minÃ¤: "æˆ‘çœ‹äº†", sinÃ¤: "ä½ çœ‹äº†", hÃ¤n: "ä»–/å¥¹çœ‹äº†", me: "æˆ‘ä»¬çœ‹äº†", te: "ä½ ä»¬çœ‹äº†", he: "ä»–ä»¬çœ‹äº†" },
                    objekti: "ç”µè§†"
                }
            },
            { 
                verbi: "puhua", 
                preesens: { minÃ¤: "puhun", sinÃ¤: "puhut", hÃ¤n: "puhuu", me: "puhumme", te: "puhutte", he: "puhuvat" }, 
                imperfekti: { minÃ¤: "puhuin", sinÃ¤: "puhuit", hÃ¤n: "puhui", me: "puhuimme", te: "puhuitte", he: "puhuivat" }, 
                objekti: "suomea",
                translations: {
                    preesens: { minÃ¤: "æˆ‘åœ¨è¯´", sinÃ¤: "ä½ åœ¨è¯´", hÃ¤n: "ä»–/å¥¹åœ¨è¯´", me: "æˆ‘ä»¬åœ¨è¯´", te: "ä½ ä»¬åœ¨è¯´", he: "ä»–ä»¬åœ¨è¯´" },
                    imperfekti: { minÃ¤: "æˆ‘è¯´äº†", sinÃ¤: "ä½ è¯´äº†", hÃ¤n: "ä»–/å¥¹è¯´äº†", me: "æˆ‘ä»¬è¯´äº†", te: "ä½ ä»¬è¯´äº†", he: "ä»–ä»¬è¯´äº†" },
                    objekti: "èŠ¬å…°è¯­"
                }
            },
            { 
                verbi: "opiskella", 
                preesens: { minÃ¤: "opiskelen", sinÃ¤: "opiskelet", hÃ¤n: "opiskelee", me: "opiskelemme", te: "opiskelette", he: "opiskelevat" }, 
                imperfekti: { minÃ¤: "opiskelin", sinÃ¤: "opiskelit", hÃ¤n: "opiskeli", me: "opiskelimme", te: "opiskelitte", he: "opiskelivat" }, 
                objekti: "kieltÃ¤",
                translations: {
                    preesens: { minÃ¤: "æˆ‘åœ¨å­¦", sinÃ¤: "ä½ åœ¨å­¦", hÃ¤n: "ä»–/å¥¹åœ¨å­¦", me: "æˆ‘ä»¬åœ¨å­¦", te: "ä½ ä»¬åœ¨å­¦", he: "ä»–ä»¬åœ¨å­¦" },
                    imperfekti: { minÃ¤: "æˆ‘å­¦äº†", sinÃ¤: "ä½ å­¦äº†", hÃ¤n: "ä»–/å¥¹å­¦äº†", me: "æˆ‘ä»¬å­¦äº†", te: "ä½ ä»¬å­¦äº†", he: "ä»–ä»¬å­¦äº†" },
                    objekti: "è¯­è¨€"
                }
            },
            { 
                verbi: "tyÃ¶skennellÃ¤", 
                preesens: { minÃ¤: "tyÃ¶skentelen", sinÃ¤: "tyÃ¶skentelet", hÃ¤n: "tyÃ¶skentelee", me: "tyÃ¶skentelemme", te: "tyÃ¶skentelette", he: "tyÃ¶skentelevÃ¤t" }, 
                imperfekti: { minÃ¤: "tyÃ¶skentelin", sinÃ¤: "tyÃ¶skentelit", hÃ¤n: "tyÃ¶skenteli", me: "tyÃ¶skentelimme", te: "tyÃ¶skentelitte", he: "tyÃ¶skentelivÃ¤t" }, 
                objekti: "projektia",
                translations: {
                    preesens: { minÃ¤: "æˆ‘åœ¨åš", sinÃ¤: "ä½ åœ¨åš", hÃ¤n: "ä»–/å¥¹åœ¨åš", me: "æˆ‘ä»¬åœ¨åš", te: "ä½ ä»¬åœ¨åš", he: "ä»–ä»¬åœ¨åš" },
                    imperfekti: { minÃ¤: "æˆ‘åšäº†", sinÃ¤: "ä½ åšäº†", hÃ¤n: "ä»–/å¥¹åšäº†", me: "æˆ‘ä»¬åšäº†", te: "ä½ ä»¬åšäº†", he: "ä»–ä»¬åšäº†" },
                    objekti: "é¡¹ç›®"
                }
            },
            { 
                verbi: "auttaa", 
                preesens: { minÃ¤: "autan", sinÃ¤: "autat", hÃ¤n: "auttaa", me: "autamme", te: "autatte", he: "auttavat" }, 
                imperfekti: { minÃ¤: "autin", sinÃ¤: "autit", hÃ¤n: "auttoi", me: "autoimme", te: "autoitte", he: "auttoivat" }, 
                objekti: "ystÃ¤vÃ¤Ã¤",
                translations: {
                    preesens: { minÃ¤: "æˆ‘åœ¨å¸®", sinÃ¤: "ä½ åœ¨å¸®", hÃ¤n: "ä»–/å¥¹åœ¨å¸®", me: "æˆ‘ä»¬åœ¨å¸®", te: "ä½ ä»¬åœ¨å¸®", he: "ä»–ä»¬åœ¨å¸®" },
                    imperfekti: { minÃ¤: "æˆ‘å¸®äº†", sinÃ¤: "ä½ å¸®äº†", hÃ¤n: "ä»–/å¥¹å¸®äº†", me: "æˆ‘ä»¬å¸®äº†", te: "ä½ ä»¬å¸®äº†", he: "ä»–ä»¬å¸®äº†" },
                    objekti: "æœ‹å‹"
                }
            }
        ];

        // --- é˜¶æ®µäºŒæ•°æ®ï¼šäº‹ä»¶å›æ”¾ï¼ˆåŒ…å«ä¸­æ–‡ç¿»è¯‘å’Œè§†è§‰å…ƒç´ ï¼‰ ---
        const tapahtumatoistinData = [
            { 
                id: 1, nimi: "åƒè‹¹æœ", 
                kuva_prosessi: "https://placehold.co/600x400/E8D8A7/000000?text=Sy%C3%B6n+omenaa...", 
                kuva_tulos: "https://placehold.co/600x400/A3C9A8/000000?text=S%C3%B6in+omenan!", 
                lause_prosessi: "MinÃ¤ syÃ¶n <span class='highlight'>omenaa</span>.", 
                lause_tulos: "MinÃ¤ <span class='highlight'>sÃ¶in</span> <span class='highlight'>omenan</span>.",
                visual: {
                    emoji: "ğŸ",
                    action_process: "ğŸ‘„",
                    action_result: "âœ…",
                    animation_class: "eating",
                    label_process: "æ­£åœ¨åƒ...",
                    label_result: "åƒå®Œäº†ï¼"
                },
                translations: {
                    prosessi: "æˆ‘åœ¨åƒè‹¹æœã€‚ï¼ˆåŠ¨ä½œè¿›è¡Œä¸­ï¼‰",
                    tulos: "æˆ‘åƒäº†è‹¹æœã€‚ï¼ˆåŠ¨ä½œå·²å®Œæˆï¼‰"
                }
            },
            { 
                id: 2, nimi: "å–å’–å•¡", 
                kuva_prosessi: "https://placehold.co/600x400/E8D8A7/000000?text=Juon+kahvia...", 
                kuva_tulos: "https://placehold.co/600x400/A3C9A8/000000?text=Join+kahvin!", 
                lause_prosessi: "SinÃ¤ juot <span class='highlight'>kahvia</span>.", 
                lause_tulos: "SinÃ¤ <span class='highlight'>joit</span> <span class='highlight'>kahvin</span>.",
                visual: {
                    emoji: "â˜•",
                    action_process: "ğŸ‘„",
                    action_result: "âœ…",
                    animation_class: "drinking",
                    label_process: "æ­£åœ¨å–...",
                    label_result: "å–å®Œäº†ï¼"
                },
                translations: {
                    prosessi: "ä½ åœ¨å–å’–å•¡ã€‚ï¼ˆåŠ¨ä½œè¿›è¡Œä¸­ï¼‰",
                    tulos: "ä½ å–äº†å’–å•¡ã€‚ï¼ˆåŠ¨ä½œå·²å®Œæˆï¼‰"
                }
            },
            { 
                id: 3, nimi: "è¯»ä¹¦", 
                kuva_prosessi: "https://placehold.co/600x400/E8D8A7/000000?text=Luen+kirjaa...", 
                kuva_tulos: "https://placehold.co/600x400/A3C9A8/000000?text=Luin+kirjan!", 
                lause_prosessi: "HÃ¤n lukee <span class='highlight'>kirjaa</span>.", 
                lause_tulos: "HÃ¤n <span class='highlight'>luki</span> <span class='highlight'>kirjan</span>.",
                visual: {
                    emoji: "ğŸ“–",
                    action_process: "ğŸ‘€",
                    action_result: "âœ…",
                    animation_class: "reading",
                    label_process: "æ­£åœ¨è¯»...",
                    label_result: "è¯»å®Œäº†ï¼"
                },
                translations: {
                    prosessi: "ä»–/å¥¹åœ¨è¯»ä¹¦ã€‚ï¼ˆåŠ¨ä½œè¿›è¡Œä¸­ï¼‰",
                    tulos: "ä»–/å¥¹è¯»äº†ä¹¦ã€‚ï¼ˆåŠ¨ä½œå·²å®Œæˆï¼‰"
                }
            },
            { 
                id: 4, nimi: "å†™ä¿¡", 
                kuva_prosessi: "https://placehold.co/600x400/E8D8A7/000000?text=Kirjoitan+kirjett%C3%A4...", 
                kuva_tulos: "https://placehold.co/600x400/A3C9A8/000000?text=Kirjoitin+kirjeen!", 
                lause_prosessi: "Me kirjoitamme <span class='highlight'>kirjettÃ¤</span>.", 
                lause_tulos: "Me <span class='highlight'>kirjoitimme</span> <span class='highlight'>kirjeen</span>.",
                visual: {
                    emoji: "âœ‰ï¸",
                    action_process: "âœï¸",
                    action_result: "âœ…",
                    animation_class: "writing",
                    label_process: "æ­£åœ¨å†™...",
                    label_result: "å†™å®Œäº†ï¼"
                },
                translations: {
                    prosessi: "æˆ‘ä»¬åœ¨å†™ä¿¡ã€‚ï¼ˆåŠ¨ä½œè¿›è¡Œä¸­ï¼‰",
                    tulos: "æˆ‘ä»¬å†™äº†ä¿¡ã€‚ï¼ˆåŠ¨ä½œå·²å®Œæˆï¼‰"
                }
            },
            { 
                id: 5, nimi: "ç”»ç”»", 
                kuva_prosessi: "https://placehold.co/600x400/E8D8A7/000000?text=Maalaan+taulua...", 
                kuva_tulos: "https://placehold.co/600x400/A3C9A8/000000?text=Maalasin+taulun!", 
                lause_prosessi: "He maalaavat <span class='highlight'>taulua</span>.", 
                lause_tulos: "He <span class='highlight'>maalasivat</span> <span class='highlight'>taulun</span>.",
                visual: {
                    emoji: "ğŸ¨",
                    action_process: "ğŸ–Œï¸",
                    action_result: "âœ…",
                    animation_class: "painting",
                    label_process: "æ­£åœ¨ç”»...",
                    label_result: "ç”»å®Œäº†ï¼"
                },
                translations: {
                    prosessi: "ä»–ä»¬åœ¨ç”»ç”»ã€‚ï¼ˆåŠ¨ä½œè¿›è¡Œä¸­ï¼‰",
                    tulos: "ä»–ä»¬ç”»äº†ç”»ã€‚ï¼ˆåŠ¨ä½œå·²å®Œæˆï¼‰"
                }
            },
            { 
                id: 6, nimi: "æ‰“æ‰«æˆ¿é—´", 
                kuva_prosessi: "https://placehold.co/600x400/E8D8A7/000000?text=Siivoan+huonetta...", 
                kuva_tulos: "https://placehold.co/600x400/A3C9A8/000000?text=Siivosin+huoneen!", 
                lause_prosessi: "MinÃ¤ siivoan <span class='highlight'>huonetta</span>.", 
                lause_tulos: "MinÃ¤ <span class='highlight'>siivosin</span> <span class='highlight'>huoneen</span>.",
                visual: {
                    emoji: "ğŸ ",
                    action_process: "ğŸ§¹",
                    action_result: "âœ¨",
                    animation_class: "cleaning",
                    label_process: "æ­£åœ¨æ‰«...",
                    label_result: "æ‰«å®Œäº†ï¼"
                },
                translations: {
                    prosessi: "æˆ‘åœ¨æ‰“æ‰«æˆ¿é—´ã€‚ï¼ˆåŠ¨ä½œè¿›è¡Œä¸­ï¼‰",
                    tulos: "æˆ‘æ‰“æ‰«äº†æˆ¿é—´ã€‚ï¼ˆåŠ¨ä½œå·²å®Œæˆï¼‰"
                }
            },
            { 
                id: 7, nimi: "ä¹°è½¦", 
                kuva_prosessi: "https://placehold.co/600x400/E8D8A7/000000?text=Ostan+autoa...", 
                kuva_tulos: "https://placehold.co/600x400/A3C9A8/000000?text=Ostin+auton!", 
                lause_prosessi: "HÃ¤n ostaa <span class='highlight'>autoa</span>.", 
                lause_tulos: "HÃ¤n <span class='highlight'>osti</span> <span class='highlight'>auton</span>.",
                visual: {
                    emoji: "ğŸš—",
                    action_process: "ğŸ‘€",
                    action_result: "ğŸ”‘",
                    animation_class: "shopping",
                    label_process: "æ­£åœ¨é€‰...",
                    label_result: "ä¹°åˆ°äº†ï¼"
                },
                translations: {
                    prosessi: "ä»–/å¥¹åœ¨ä¹°è½¦ã€‚ï¼ˆåŠ¨ä½œè¿›è¡Œä¸­ï¼‰",
                    tulos: "ä»–/å¥¹ä¹°äº†è½¦ã€‚ï¼ˆåŠ¨ä½œå·²å®Œæˆï¼‰"
                }
            },
            { 
                id: 8, nimi: "ä¿®è‡ªè¡Œè½¦", 
                kuva_prosessi: "https://placehold.co/600x400/E8D8A7/000000?text=Korjaan+py%C3%B6r%C3%A4%C3%A4...", 
                kuva_tulos: "https://placehold.co/600x400/A3C9A8/000000?text=Korjasin+py%C3%B6r%C3%A4n!", 
                lause_prosessi: "SinÃ¤ korjaat <span class='highlight'>pyÃ¶rÃ¤Ã¤</span>.", 
                lause_tulos: "SinÃ¤ <span class='highlight'>korjasit</span> <span class='highlight'>pyÃ¶rÃ¤n</span>.",
                visual: {
                    emoji: "ğŸš²",
                    action_process: "ğŸ”§",
                    action_result: "âœ…",
                    animation_class: "fixing",
                    label_process: "æ­£åœ¨ä¿®...",
                    label_result: "ä¿®å¥½äº†ï¼"
                },
                translations: {
                    prosessi: "ä½ åœ¨ä¿®è‡ªè¡Œè½¦ã€‚ï¼ˆåŠ¨ä½œè¿›è¡Œä¸­ï¼‰",
                    tulos: "ä½ ä¿®äº†è‡ªè¡Œè½¦ã€‚ï¼ˆåŠ¨ä½œå·²å®Œæˆï¼‰"
                }
            },
            { 
                id: 9, nimi: "å…³é—¨", 
                kuva_prosessi: "https://placehold.co/600x400/E8D8A7/000000?text=Suljen+ovea...", 
                kuva_tulos: "https://placehold.co/600x400/A3C9A8/000000?text=Suljin+oven!", 
                lause_prosessi: "HÃ¤n sulkee <span class='highlight'>ovea</span>.", 
                lause_tulos: "HÃ¤n <span class='highlight'>sulki</span> <span class='highlight'>oven</span>.",
                visual: {
                    emoji: "ğŸšª",
                    action_process: "ğŸ‘‹",
                    action_result: "ğŸ”’",
                    animation_class: "closing",
                    label_process: "æ­£åœ¨å…³...",
                    label_result: "å…³ä¸Šäº†ï¼"
                },
                translations: {
                    prosessi: "ä»–/å¥¹åœ¨å…³é—¨ã€‚ï¼ˆåŠ¨ä½œè¿›è¡Œä¸­ï¼‰",
                    tulos: "ä»–/å¥¹å…³äº†é—¨ã€‚ï¼ˆåŠ¨ä½œå·²å®Œæˆï¼‰"
                }
            },
            { 
                id: 10, nimi: "ç…®æ±¤", 
                kuva_prosessi: "https://placehold.co/600x400/E8D8A7/000000?text=Keit%C3%A4n+keittoa...", 
                kuva_tulos: "https://placehold.co/600x400/A3C9A8/000000?text=Keitin+keiton!", 
                lause_prosessi: "Me keitÃ¤mme <span class='highlight'>keittoa</span>.", 
                lause_tulos: "Me <span class='highlight'>keitimme</span> <span class='highlight'>keiton</span>.",
                visual: {
                    emoji: "ğŸ²",
                    action_process: "ğŸ¥„",
                    action_result: "ğŸ½ï¸",
                    animation_class: "cooking",
                    label_process: "æ­£åœ¨ç…®...",
                    label_result: "ç…®å¥½äº†ï¼"
                },
                translations: {
                    prosessi: "æˆ‘ä»¬åœ¨ç…®æ±¤ã€‚ï¼ˆåŠ¨ä½œè¿›è¡Œä¸­ï¼‰",
                    tulos: "æˆ‘ä»¬ç…®äº†æ±¤ã€‚ï¼ˆåŠ¨ä½œå·²å®Œæˆï¼‰"
                }
            }
        ];

        // --- é˜¶æ®µä¸‰æ•°æ®ï¼šè¯­æ³•çŸ©é˜µï¼ˆåŒ…å«ä¸­æ–‡ç¿»è¯‘ï¼‰ ---
        const subjektit = ["MinÃ¤", "SinÃ¤", "HÃ¤n", "Pekka", "Liisa", "Opettaja", "Lapsi", "Ã„iti", "IsÃ¤", "YstÃ¤vÃ¤", "Veli", "Sisko", "Mummi", "Vaari", "Naapuri", "Kollega", "Opiskelija", "LÃ¤Ã¤kÃ¤ri", "Me", "Te", "He"];
        const persoonaMap = { 
            "MinÃ¤": "minÃ¤", "SinÃ¤": "sinÃ¤", "HÃ¤n": "hÃ¤n", "Pekka": "hÃ¤n", "Liisa": "hÃ¤n", "Opettaja": "hÃ¤n", "Lapsi": "hÃ¤n", 
            "Ã„iti": "hÃ¤n", "IsÃ¤": "hÃ¤n", "YstÃ¤vÃ¤": "hÃ¤n", "Veli": "hÃ¤n", "Sisko": "hÃ¤n", "Mummi": "hÃ¤n", "Vaari": "hÃ¤n", 
            "Naapuri": "hÃ¤n", "Kollega": "hÃ¤n", "Opiskelija": "hÃ¤n", "LÃ¤Ã¤kÃ¤ri": "hÃ¤n", "Me": "me", "Te": "te", "He": "he" 
        };
        const subjektitTranslations = { 
            "MinÃ¤": "æˆ‘", "SinÃ¤": "ä½ ", "HÃ¤n": "ä»–/å¥¹", "Pekka": "ä½©å¡", "Liisa": "ä¸½è¨", "Opettaja": "è€å¸ˆ", "Lapsi": "å­©å­", 
            "Ã„iti": "å¦ˆå¦ˆ", "IsÃ¤": "çˆ¸çˆ¸", "YstÃ¤vÃ¤": "æœ‹å‹", "Veli": "å“¥å“¥/å¼Ÿå¼Ÿ", "Sisko": "å§å§/å¦¹å¦¹", "Mummi": "å¥¶å¥¶", "Vaari": "çˆ·çˆ·", 
            "Naapuri": "é‚»å±…", "Kollega": "åŒäº‹", "Opiskelija": "å­¦ç”Ÿ", "LÃ¤Ã¤kÃ¤ri": "åŒ»ç”Ÿ", "Me": "æˆ‘ä»¬", "Te": "ä½ ä»¬", "He": "ä»–ä»¬" 
        };

        const verbiObjektiLinkit = [
            { verbi: { minÃ¤: "sÃ¶in", sinÃ¤: "sÃ¶it", hÃ¤n: "sÃ¶i", me: "sÃ¶imme", te: "sÃ¶itte", he: "sÃ¶ivÃ¤t" }, objekti_gen: "omenan", translations: { verbi: "åƒäº†", objekti: "è‹¹æœ" } },
            { verbi: { minÃ¤: "join", sinÃ¤: "joit", hÃ¤n: "joi", me: "joimme", te: "joitte", he: "joivat" }, objekti_gen: "kahvin", translations: { verbi: "å–äº†", objekti: "å’–å•¡" } },
            { verbi: { minÃ¤: "luin", sinÃ¤: "luit", hÃ¤n: "luki", me: "luimme", te: "luitte", he: "lukivat" }, objekti_gen: "kirjan", translations: { verbi: "è¯»äº†", objekti: "ä¹¦" } },
            { verbi: { minÃ¤: "ostin", sinÃ¤: "ostit", hÃ¤n: "osti", me: "ostimme", te: "ostitte", he: "ostivat" }, objekti_gen: "auton", translations: { verbi: "ä¹°äº†", objekti: "æ±½è½¦" } },
            { verbi: { minÃ¤: "tein", sinÃ¤: "teit", hÃ¤n: "teki", me: "teimme", te: "teitte", he: "tekivÃ¤t" }, objekti_gen: "ruoan", translations: { verbi: "åšäº†", objekti: "é£Ÿç‰©" } },
            { verbi: { minÃ¤: "kirjoitin", sinÃ¤: "kirjoitit", hÃ¤n: "kirjoitti", me: "kirjoitimme", te: "kirjoititte", he: "kirjoittivat" }, objekti_gen: "kirjeen", translations: { verbi: "å†™äº†", objekti: "ä¿¡" } },
            { verbi: { minÃ¤: "maalasin", sinÃ¤: "maalasit", hÃ¤n: "maalasi", me: "maalasimme", te: "maalasitte", he: "maalasivat" }, objekti_gen: "talon", translations: { verbi: "ç”»äº†", objekti: "æˆ¿å­" } },
            { verbi: { minÃ¤: "siivosin", sinÃ¤: "siivosit", hÃ¤n: "siivosi", me: "siivosimme", te: "siivositte", he: "siivosivat" }, objekti_gen: "huoneen", translations: { verbi: "æ‰“æ‰«äº†", objekti: "æˆ¿é—´" } },
            { verbi: { minÃ¤: "korjasin", sinÃ¤: "korjasit", hÃ¤n: "korjasi", me: "korjasimme", te: "korjasitte", he: "korjasivat" }, objekti_gen: "pyÃ¶rÃ¤n", translations: { verbi: "ä¿®äº†", objekti: "è‡ªè¡Œè½¦" } },
            { verbi: { minÃ¤: "suljin", sinÃ¤: "suljit", hÃ¤n: "sulki", me: "suljimme", te: "suljitte", he: "sulkivat" }, objekti_gen: "oven", translations: { verbi: "å…³äº†", objekti: "é—¨" } },
            { verbi: { minÃ¤: "avasin", sinÃ¤: "avasit", hÃ¤n: "avasi", me: "avasimme", te: "avasitte", he: "avasivat" }, objekti_gen: "ikkunan", translations: { verbi: "æ‰“å¼€äº†", objekti: "çª—æˆ·" } },
            { verbi: { minÃ¤: "maksoin", sinÃ¤: "maksoit", hÃ¤n: "maksoi", me: "maksoimme", te: "maksoitte", he: "maksoivat" }, objekti_gen: "laskun", translations: { verbi: "æ”¯ä»˜äº†", objekti: "è´¦å•" } },
            { verbi: { minÃ¤: "kuuntelin", sinÃ¤: "kuuntelit", hÃ¤n: "kuunteli", me: "kuuntelimme", te: "kuuntelitte", he: "kuuntelivat" }, objekti_gen: "musiikin", translations: { verbi: "å¬äº†", objekti: "éŸ³ä¹" } },
            { verbi: { minÃ¤: "katsoin", sinÃ¤: "katsoit", hÃ¤n: "katsoi", me: "katsoimme", te: "katsoitte", he: "katsoivat" }, objekti_gen: "elokuvan", translations: { verbi: "çœ‹äº†", objekti: "ç”µå½±" } },
            { verbi: { minÃ¤: "puhuin", sinÃ¤: "puhuit", hÃ¤n: "puhui", me: "puhuimme", te: "puhuitte", he: "puhuivat" }, objekti_gen: "Ã¤idin", translations: { verbi: "å’Œ...è¯´è¯äº†", objekti: "å¦ˆå¦ˆ" } },
            { verbi: { minÃ¤: "opiskelin", sinÃ¤: "opiskelit", hÃ¤n: "opiskeli", me: "opiskelimme", te: "opiskelitte", he: "opiskelivat" }, objekti_gen: "matematiikan", translations: { verbi: "å­¦äº†", objekti: "æ•°å­¦" } },
            { verbi: { minÃ¤: "tyÃ¶skentelin", sinÃ¤: "tyÃ¶skentelit", hÃ¤n: "tyÃ¶skenteli", me: "tyÃ¶skentelimme", te: "tyÃ¶skentelitte", he: "tyÃ¶skentelivÃ¤t" }, objekti_gen: "tehtÃ¤vÃ¤n", translations: { verbi: "åšäº†", objekti: "ä»»åŠ¡" } },
            { verbi: { minÃ¤: "autin", sinÃ¤: "autit", hÃ¤n: "auttoi", me: "autoimme", te: "autoitte", he: "auttoivat" }, objekti_gen: "ystÃ¤vÃ¤n", translations: { verbi: "å¸®äº†", objekti: "æœ‹å‹" } },
            { verbi: { minÃ¤: "soitin", sinÃ¤: "soitit", hÃ¤n: "soitti", me: "soitimme", te: "soititte", he: "soittivat" }, objekti_gen: "kitaran", translations: { verbi: "å¼¹äº†", objekti: "å‰ä»–" } },
            { verbi: { minÃ¤: "sÃ¶in", sinÃ¤: "sÃ¶it", hÃ¤n: "sÃ¶i", me: "sÃ¶imme", te: "sÃ¶itte", he: "sÃ¶ivÃ¤t" }, objekti_gen: "pizzan", translations: { verbi: "åƒäº†", objekti: "æ¯”è¨" } },
            { verbi: { minÃ¤: "pesin", sinÃ¤: "pesit", hÃ¤n: "pesi", me: "pesimme", te: "pesitte", he: "pesivÃ¤t" }, objekti_gen: "astiat", translations: { verbi: "æ´—äº†", objekti: "é¤å…·" } },
            { verbi: { minÃ¤: "lÃ¶ysin", sinÃ¤: "lÃ¶ysit", hÃ¤n: "lÃ¶ysi", me: "lÃ¶ysimme", te: "lÃ¶ysitte", he: "lÃ¶ysivÃ¤t" }, objekti_gen: "avaimen", translations: { verbi: "æ‰¾åˆ°äº†", objekti: "é’¥åŒ™" } },
            { verbi: { minÃ¤: "unohdin", sinÃ¤: "unohtit", hÃ¤n: "unohti", me: "unohdimme", te: "unohditte", he: "unohtivat" }, objekti_gen: "laukun", translations: { verbi: "å¿˜äº†", objekti: "åŒ…" } },
            { verbi: { minÃ¤: "oppisin", sinÃ¤: "oppisit", hÃ¤n: "oppisi", me: "oppisimme", te: "oppisitte", he: "oppisiit" }, objekti_gen: "sanan", translations: { verbi: "å­¦ä¼šäº†", objekti: "å•è¯" } }
        ];

        // ==========================================================
        // é€»è¾‘å±‚ (Logic Layer)
        // ==========================================================

        // --- TTSå‡½æ•° ---
        function speakText(text) {
            // ç§»é™¤HTMLæ ‡ç­¾
            const cleanText = text.replace(/<[^>]*>/g, '');
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(cleanText);
                utterance.lang = 'fi-FI';
                utterance.rate = 0.8;
                speechSynthesis.speak(utterance);
            } else {
                alert('æŠ±æ­‰ï¼Œæ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³æ’­æ”¾åŠŸèƒ½ã€‚');
            }
        }

        // --- ç¿»è¯‘æ˜¾ç¤º/éšè—å‡½æ•° ---
        function toggleTranslation(elementId) {
            const element = document.getElementById(elementId);
            if (element.style.display === 'none' || element.style.display === '') {
                element.style.display = 'block';
            } else {
                element.style.display = 'none';
            }
        }

        // --- DOM å…ƒç´ å¼•ç”¨ ---
        const aikakoneNytEl = document.getElementById('aikakone-nyt');
        const aikakoneEilenEl = document.getElementById('aikakone-eilen');
        const aikakoneNytTranslationEl = document.getElementById('aikakone-nyt-translation');
        const aikakoneEilenTranslationEl = document.getElementById('aikakone-eilen-translation');
        
        const eventSelectEl = document.getElementById('event-select');
        const tapahtumatoistinVisualEl = document.getElementById('tapahtumatoistin-visual');
        const eventEmojiEl = document.getElementById('event-emoji');
        const eventActionEl = document.getElementById('event-action');
        const eventLabelEl = document.getElementById('event-label');
        const tapahtumatoistinSentenceEl = document.getElementById('tapahtumatoistin-sentence');
        const tapahtumatoistinSentenceTranslationEl = document.getElementById('tapahtumatoistin-sentence-translation');
        const tapahtumatoistinButtonEl = document.getElementById('tapahtumatoistin-button');
        const tapahtumatoistinAnswerContainerEl = document.getElementById('tapahtumatoistin-answer-container');
        const tapahtumatoistinAnswerEl = document.getElementById('tapahtumatoistin-answer');
        const tapahtumatoistinAnswerTranslationEl = document.getElementById('tapahtumatoistin-answer-translation');

        const sentenceDisplayEl = document.getElementById('sentence-display');
        const sentenceDisplayTranslationEl = document.getElementById('sentence-display-translation');

        // --- çŠ¶æ€å˜é‡ ---
        let tapahtumatoistinState = {
            isShowingProcess: true
        };

        let currentAikakoneData = null;
        let currentTapahtumatoistinData = null;
        let currentKielioppimatriisiTranslation = "";

        // --- éšæœºé€‰æ‹©å‡½æ•° ---
        function getRandomElement(arr) {
            return arr[Math.floor(Math.random() * arr.length)];
        }

        // --- é˜¶æ®µä¸€é€»è¾‘ ---
        function runAikakone() {
            currentAikakoneData = getRandomElement(aikakoneData);
            const subjektiObj = getRandomElement(Object.keys(currentAikakoneData.preesens));
            const subjektiText = subjektiObj.charAt(0).toUpperCase() + subjektiObj.slice(1);
            
            const preesensLause = `${subjektiText} <span class="highlight">${currentAikakoneData.preesens[subjektiObj]}</span> ${currentAikakoneData.objekti}.`;
            const imperfektiLause = `${subjektiText} <span class="highlight">${currentAikakoneData.imperfekti[subjektiObj]}</span> ${currentAikakoneData.objekti}.`;

            aikakoneNytEl.innerHTML = preesensLause;
            aikakoneEilenEl.innerHTML = imperfektiLause;

            // è®¾ç½®ç¿»è¯‘
            aikakoneNytTranslationEl.textContent = `${currentAikakoneData.translations.preesens[subjektiObj]}${currentAikakoneData.translations.objekti}ã€‚`;
            aikakoneEilenTranslationEl.textContent = `${currentAikakoneData.translations.imperfekti[subjektiObj]}${currentAikakoneData.translations.objekti}ã€‚`;
        }

        // --- é˜¶æ®µäºŒé€»è¾‘ ---
        function runTapahtumatoistin(reset = false) {
            if (reset) {
                tapahtumatoistinState.isShowingProcess = true;
            }

            const selectedEventId = parseInt(eventSelectEl.value);
            currentTapahtumatoistinData = tapahtumatoistinData.find(e => e.id === selectedEventId);
            const mode = document.querySelector('input[name="tapahtumatoistin-mode"]:checked').value;

            tapahtumatoistinAnswerContainerEl.style.display = 'none'; // Hide answer by default

            // æ›´æ–°è§†è§‰å…ƒç´ 
            const visual = currentTapahtumatoistinData.visual;
            eventEmojiEl.textContent = visual.emoji;
            
            // æ¸…é™¤ä¹‹å‰çš„åŠ¨ç”»ç±»
            tapahtumatoistinVisualEl.className = 'visual-event';
            eventActionEl.className = 'event-action';

            if (mode === 'passive') {
                if (tapahtumatoistinState.isShowingProcess) {
                    // æ˜¾ç¤ºè¿‡ç¨‹çŠ¶æ€
                    tapahtumatoistinVisualEl.classList.add('process');
                    eventActionEl.textContent = visual.action_process;
                    eventActionEl.classList.add(visual.animation_class);
                    eventLabelEl.textContent = visual.label_process;
                    tapahtumatoistinSentenceEl.innerHTML = currentTapahtumatoistinData.lause_prosessi;
                    tapahtumatoistinSentenceTranslationEl.textContent = currentTapahtumatoistinData.translations.prosessi;
                    tapahtumatoistinButtonEl.textContent = 'Valmis! (å®Œæˆ!)';
                } else {
                    // æ˜¾ç¤ºç»“æœçŠ¶æ€
                    tapahtumatoistinVisualEl.classList.add('result');
                    eventActionEl.textContent = visual.action_result;
                    eventLabelEl.textContent = visual.label_result;
                    tapahtumatoistinSentenceEl.innerHTML = currentTapahtumatoistinData.lause_tulos;
                    tapahtumatoistinSentenceTranslationEl.textContent = currentTapahtumatoistinData.translations.tulos;
                    tapahtumatoistinButtonEl.textContent = 'Uudelleen (å†æ¥ä¸€æ¬¡)';
                }
            } else { // active mode
                // æ˜¾ç¤ºç»“æœçŠ¶æ€ï¼ˆä¸»åŠ¨æ¨¡å¼ä¸‹æ˜¾ç¤ºæœ€ç»ˆçŠ¶æ€ï¼‰
                tapahtumatoistinVisualEl.classList.add('result');
                eventActionEl.textContent = visual.action_result;
                eventLabelEl.textContent = '?';
                tapahtumatoistinSentenceEl.innerHTML = 'MitÃ¤ eilen tapahtui?';
                tapahtumatoistinSentenceTranslationEl.textContent = 'æ˜¨å¤©å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ';
                tapahtumatoistinAnswerEl.innerHTML = currentTapahtumatoistinData.lause_tulos;
                tapahtumatoistinAnswerTranslationEl.textContent = currentTapahtumatoistinData.translations.tulos;
                tapahtumatoistinButtonEl.textContent = 'NÃ¤ytÃ¤ vastaus (æ˜¾ç¤ºç­”æ¡ˆ)';
            }
        }
        
        function handleTapahtumatoistinClick() {
            const mode = document.querySelector('input[name="tapahtumatoistin-mode"]:checked').value;
            if (mode === 'passive') {
                tapahtumatoistinState.isShowingProcess = !tapahtumatoistinState.isShowingProcess;
                runTapahtumatoistin();
            } else { // active mode
                tapahtumatoistinAnswerContainerEl.style.display = 'block';
            }
        }
        
        // --- é˜¶æ®µä¸‰é€»è¾‘ ---
        function runKielioppimatriisi() {
            const subjekti = getRandomElement(subjektit);
            const verbiObj = getRandomElement(verbiObjektiLinkit);
            const persoona = persoonaMap[subjekti];
            const verbi = verbiObj.verbi[persoona];
            
            const lause = `${subjekti} <span class="highlight">${verbi}</span> ${verbiObj.objekti_gen}.`;
            sentenceDisplayEl.innerHTML = lause;

            // è®¾ç½®ç¿»è¯‘
            const subjektiTranslation = subjektitTranslations[subjekti];
            currentKielioppimatriisiTranslation = `${subjektiTranslation}${verbiObj.translations.verbi}${verbiObj.translations.objekti}ã€‚`;
            sentenceDisplayTranslationEl.textContent = currentKielioppimatriisiTranslation;
            
            // è‡ªåŠ¨å‘éŸ³
            const cleanSentence = lause.replace(/<[^>]*>/g, ''); // ç§»é™¤HTMLæ ‡ç­¾
            speakText(cleanSentence);
        }


        // ==========================================================
        // åˆå§‹åŒ– (Initialization)
        // ==========================================================
        window.onload = () => {
            // Populate event selector
            tapahtumatoistinData.forEach(event => {
                const option = document.createElement('option');
                option.value = event.id;
                option.textContent = event.nimi;
                eventSelectEl.appendChild(option);
            });

            // Initial runs
            runAikakone();
            runTapahtumatoistin(true);
            runKielioppimatriisi();
        };

    </script>
</body>
</html>