<!DOCTYPE html>
<html lang="fi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ëä¨ÂÖ∞ËØ≠Ê®°ÂùóÂõõÔºöÊó∂Èó¥Êà≥È©±Âä® (Verb 2.0) ÂéüÂûã</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;700&display=swap');

        body {
            font-family: 'Noto Sans', sans-serif;
            background-color: #f0f2f5;
            color: #333;
            line-height: 1.6;
            display: flex;
            justify-content: center;
            padding: 20px;
        }

        .container {
            width: 100%;
            max-width: 800px;
            background-color: #fff;
            padding: 20px 40px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        h1, h2, h3 {
            color: #003580; /* Finnish Flag Blue */
            border-bottom: 2px solid #e7e9ec;
            padding-bottom: 10px;
        }

        h1 { font-size: 2em; text-align: center; }
        h2 { font-size: 1.6em; margin-top: 40px; }
        h3 { font-size: 1.2em; }

        .module {
            margin-bottom: 50px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background-color: #fafafa;
        }

        .instructions {
            background-color: #e6f3ff;
            border-left: 5px solid #0056b3;
            padding: 10px 15px;
            margin-bottom: 20px;
            border-radius: 5px;
        }

        .button {
            display: inline-block;
            background-color: #0056b3;
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            transition: background-color 0.3s;
            text-align: center;
            margin-top: 15px;
        }

        .button:hover {
            background-color: #003580;
        }

        .highlight {
            color: #d9534f;
            font-weight: bold;
        }
        
        /* TTS and Translation Styles */
        .tts-btn {
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            cursor: pointer;
            font-size: 14px;
            margin-left: 10px;
            transition: background-color 0.3s;
        }
        
        .tts-btn:hover {
            background-color: #218838;
        }
        
        .translation-toggle {
            background-color: #6c757d;
            color: white;
            border: none;
            border-radius: 15px;
            padding: 5px 10px;
            cursor: pointer;
            font-size: 12px;
            margin-left: 10px;
            transition: background-color 0.3s;
        }
        
        .translation-toggle:hover {
            background-color: #5a6268;
        }
        
        .translation {
            color: #666;
            font-style: italic;
            margin-top: 5px;
            display: none;
        }
        
        .sentence-container {
            position: relative;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        /* Stage 1: Aikakone */
        #aikakone-display {
            display: flex;
            justify-content: space-around;
            text-align: center;
            font-size: 1.2em;
            padding: 20px;
            background-color: #fff;
            border-radius: 5px;
        }

        /* Stage 2: Tapahtumatoistin */
        .image-container {
            text-align: center;
            margin-bottom: 15px;
        }
        .image-container img {
            max-width: 100%;
            height: 250px;
            border: 2px solid #ccc;
            border-radius: 5px;
            background-color: #eee;
        }
        
        /* Visual Event Animations */
        .visual-event {
            width: 100%;
            height: 250px;
            border: 2px solid #ccc;
            border-radius: 5px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-size: 60px;
            position: relative;
            overflow: hidden;
        }
        
        .visual-event.process {
            background: linear-gradient(135deg, #E8D8A7, #F5E6B3);
        }
        
        .visual-event.result {
            background: linear-gradient(135deg, #A3C9A8, #B8D4BD);
        }
        
        .event-emoji {
            font-size: 80px;
            margin-bottom: 10px;
        }
        
        .event-action {
            font-size: 40px;
            opacity: 0.7;
        }
        
        .event-label {
            position: absolute;
            bottom: 10px;
            font-size: 16px;
            font-weight: bold;
            color: #333;
        }
        
        /* Specific animations for each event */
        @keyframes eating {
            0%, 100% { transform: rotate(0deg); }
            50% { transform: rotate(-15deg); }
        }
        
        @keyframes drinking {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        @keyframes reading {
            0%, 100% { transform: rotateY(0deg); }
            50% { transform: rotateY(15deg); }
        }
        
        @keyframes writing {
            0%, 100% { transform: translate(0px, 0px); }
            25% { transform: translate(5px, -5px); }
            75% { transform: translate(-5px, 5px); }
        }
        
        @keyframes painting {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(5deg); }
            75% { transform: rotate(-5deg); }
        }
        
        @keyframes cleaning {
            0%, 100% { transform: translateX(0px); }
            50% { transform: translateX(20px); }
        }
        
        @keyframes shopping {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        @keyframes fixing {
            0%, 100% { transform: rotateZ(0deg); }
            25% { transform: rotateZ(10deg); }
            75% { transform: rotateZ(-10deg); }
        }
        
        @keyframes closing {
            0% { transform: scaleX(1); }
            100% { transform: scaleX(0.1); }
        }
        
        @keyframes cooking {
            0%, 100% { transform: rotate(0deg); }
            50% { transform: rotate(360deg); }
        }
        
        .process .eating { animation: eating 2s infinite; }
        .process .drinking { animation: drinking 1.5s infinite; }
        .process .reading { animation: reading 2s infinite; }
        .process .writing { animation: writing 1s infinite; }
        .process .painting { animation: painting 1.5s infinite; }
        .process .cleaning { animation: cleaning 1.5s infinite; }
        .process .shopping { animation: shopping 2s infinite; }
        .process .fixing { animation: fixing 1s infinite; }
        .process .closing { animation: closing 3s infinite; }
        .process .cooking { animation: cooking 2s infinite; }
        
        .result .event-emoji {
            opacity: 0.8;
            filter: brightness(1.2);
        }
        #tapahtumatoistin-sentence {
            font-size: 1.3em;
            text-align: center;
            font-weight: bold;
            padding: 10px;
        }
        #tapahtumatoistin-answer {
            background-color: #dff0d8;
            border: 1px solid #d6e9c6;
            color: #3c763d;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
            font-size: 1.1em;
        }
        .controls {
            display: flex;
            gap: 20px;
            align-items: center;
            margin-bottom: 15px;
        }

        /* Stage 3: Kielioppimatriisi */
        #sentence-display {
            font-size: 2em;
            text-align: center;
            font-weight: bold;
            padding: 30px 10px;
            background-color: #fcf8e3;
            border: 2px dashed #f0ad4e;
            color: #8a6d3b;
            min-height: 70px;
            border-radius: 5px;
        }
        
        /* Stage 4: Cognitive Upgrade */
        .guided-question {
            background-color: #f8f9fa;
            border-left: 4px solid #007bff;
            padding: 20px;
            margin: 25px 0;
            border-radius: 0 8px 8px 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .guided-question h3 {
            color: #007bff;
            margin-top: 0;
            font-size: 1.3em;
            border-bottom: none;
            padding-bottom: 0;
        }
        
        .guided-question p {
            line-height: 1.7;
            font-size: 1.05em;
            color: #495057;
        }
        
        .answer-space {
            min-height: 60px;
            border: 2px dashed #dee2e6;
            border-radius: 5px;
            margin: 15px 0;
            background-color: #fff;
            position: relative;
        }
        
        .answer-space::before {
            content: "üí≠ ÊÄùËÄÉÁ©∫Èó¥ÔºöËØ∑Âú®ËÑë‰∏≠ÊàñÁ∫∏‰∏äÂõûÁ≠îËøô‰∏™ÈóÆÈ¢ò...";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #6c757d;
            font-style: italic;
            text-align: center;
            opacity: 0.7;
        }
        
        .completion-message {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            padding: 25px;
            border-radius: 10px;
            text-align: center;
            margin-top: 30px;
            box-shadow: 0 4px 15px rgba(40,167,69,0.3);
        }
        
        .completion-message h3 {
            margin-top: 0;
            font-size: 1.5em;
            border-bottom: none;
            padding-bottom: 0;
            color: white;
        }
        
        .completion-message p {
            font-size: 1.1em;
            line-height: 1.6;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>Ê®°ÂùóÂõõÔºöÊó∂Èó¥Êà≥È©±Âä® (Verb 2.0) ÂéüÂûã</h1>
        <p class="instructions">ËøôÊòØ‰∏Ä‰∏™‰∫§‰∫íÂºèÂéüÂûãÔºåÁî®‰∫éÂÆûË∑µËä¨ÂÖ∞ËØ≠ËøáÂéªÊó∂(Imperfekti)ÂèäÂÖ∂‰∏éÂÆæËØ≠Ê†ºÁöÑËÅîÂä®„ÄÇËØ∑ÊåâÁÖß‰∏â‰∏™Èò∂ÊÆµÁöÑÈ°∫Â∫èËøõË°åÁªÉ‰π†„ÄÇ</p>

        <!-- ========================================================== -->
        <!-- Èò∂ÊÆµ‰∏ÄÔºöÈöîÁ¶ªÂÆâË£Ö (Aikakone) -->
        <!-- ========================================================== -->
        <div class="module">
            <h2>Èò∂ÊÆµ‰∏ÄÔºöÈöîÁ¶ªÂÆâË£Ö - "Êó∂Èó¥Á©øÊ¢≠Êú∫"</h2>
            <p class="instructions"><strong>ÁõÆÊ†áÔºö</strong>Âª∫Á´ãÂä®ËØçËøáÂéªÊó∂ÁöÑÂ£∞Èü≥Áõ¥Ëßâ„ÄÇËØ∑Â§ßÂ£∞Ë∑üËØªÔºåÂè™ÈúÄÂÖ≥Ê≥®<span class="highlight">Âä®ËØç</span>ÁöÑÂèëÈü≥ÂèòÂåñ„ÄÇ</p>
            <div id="aikakone-display">
                <div class="aikakone-column">
                    <h3>NYT (Áé∞Âú®)</h3>
                    <div class="sentence-container">
                        <p id="aikakone-nyt">...</p>
                        <button class="tts-btn" onclick="speakText(document.getElementById('aikakone-nyt').textContent)">üîä</button>
                        <button class="translation-toggle" onclick="toggleTranslation('aikakone-nyt-translation')">‰∏≠Êñá</button>
                    </div>
                    <div id="aikakone-nyt-translation" class="translation"></div>
                </div>
                <div class="aikakone-column">
                    <h3>EILEN (Êò®Â§©)</h3>
                    <div class="sentence-container">
                        <p id="aikakone-eilen">...</p>
                        <button class="tts-btn" onclick="speakText(document.getElementById('aikakone-eilen').textContent)">üîä</button>
                        <button class="translation-toggle" onclick="toggleTranslation('aikakone-eilen-translation')">‰∏≠Êñá</button>
                    </div>
                    <div id="aikakone-eilen-translation" class="translation"></div>
                </div>
            </div>
            <button class="button" onclick="runAikakone()">‰∏ã‰∏ÄÁªÑ (Seuraava)</button>
        </div>

        <!-- ========================================================== -->
        <!-- Èò∂ÊÆµ‰∫åÔºöËÅîÂä®ÂçèËÆÆÊøÄÊ¥ª (Tapahtumatoistin) -->
        <!-- ========================================================== -->
        <div class="module">
            <h2>Èò∂ÊÆµ‰∫åÔºöËÅîÂä®ÂçèËÆÆÊøÄÊ¥ª - "‰∫ã‰ª∂ÂõûÊîæÊ®°ÊãüÂô®"</h2>
            <p class="instructions"><strong>ÁõÆÊ†áÔºö</strong>Â∞Ü"ËøáÂéªÊó∂Âä®ËØç"Âíå"ÂÆåÊàêÊÄÅÂÆæËØ≠"ËøõË°åÂõ†ÊûúÁªëÂÆö„ÄÇÊÑüÂèóÂõæÁâáÂíåÂè•Â≠êÂ¶Ç‰ΩïÂêåÊ≠•ÂèòÂåñ„ÄÇ</p>
            
            <div class="controls">
                <label for="event-select">ÈÄâÊã©‰∫ã‰ª∂:</label>
                <select id="event-select" onchange="runTapahtumatoistin(true)">
                    <!-- Options will be populated by JS -->
                </select>
                <div>
                    <input type="radio" id="mode-passive" name="tapahtumatoistin-mode" value="passive" checked onchange="runTapahtumatoistin(true)">
                    <label for="mode-passive">Ë¢´Âä®Â≠¶‰π†</label>
                </div>
                 <div>
                    <input type="radio" id="mode-active" name="tapahtumatoistin-mode" value="active" onchange="runTapahtumatoistin(true)">
                    <label for="mode-active">‰∏ªÂä®ÂõûÊîæ</label>
                </div>
            </div>

            <div class="image-container">
                <div id="tapahtumatoistin-visual" class="visual-event">
                    <div id="event-emoji" class="event-emoji">üçé</div>
                    <div id="event-action" class="event-action">‚ú®</div>
                    <div id="event-label" class="event-label">ËøáÁ®ã‰∏≠...</div>
                </div>
            </div>
            <div class="sentence-container">
                <p id="tapahtumatoistin-sentence">...</p>
                <button class="tts-btn" onclick="speakText(document.getElementById('tapahtumatoistin-sentence').textContent)">üîä</button>
                <button class="translation-toggle" onclick="toggleTranslation('tapahtumatoistin-sentence-translation')">‰∏≠Êñá</button>
            </div>
            <div id="tapahtumatoistin-sentence-translation" class="translation"></div>
            <div id="tapahtumatoistin-answer-container" style="display: none;">
                <div class="sentence-container">
                    <p id="tapahtumatoistin-answer">...</p>
                    <button class="tts-btn" onclick="speakText(document.getElementById('tapahtumatoistin-answer').textContent)">üîä</button>
                    <button class="translation-toggle" onclick="toggleTranslation('tapahtumatoistin-answer-translation')">‰∏≠Êñá</button>
                </div>
                <div id="tapahtumatoistin-answer-translation" class="translation"></div>
            </div>
            <button class="button" id="tapahtumatoistin-button" onclick="handleTapahtumatoistinClick()">Valmis! (ÂÆåÊàê!)</button>
        </div>

        <!-- ========================================================== -->
        <!-- Èò∂ÊÆµ‰∏âÔºöÁ≥ªÁªüËá™Âä®Âåñ (Kielioppimatriisi) -->
        <!-- ========================================================== -->
        <div class="module">
            <h2>Èò∂ÊÆµ‰∏âÔºöÁ≥ªÁªüËá™Âä®Âåñ - "ËØ≠Ê≥ïÁü©Èòµ"</h2>
            <p class="instructions"><strong>ÁõÆÊ†áÔºö</strong>ÈÄöËøáËÆ§Áü•ÂÜ≤ÂáªÔºåÂ∞ÜËØ≠Ê≥ïÊ®°ÂºèÂÜÖÂåñ‰∏∫Êú¨ËÉΩ„ÄÇ<strong>‰Ω†ÁöÑ‰ªªÂä°‰∏çÊòØÁêÜËß£ÔºåËÄåÊòØË∑ü‰∏äËäÇÂ•èÔºåÂø´ÈÄüË∑üËØªÔºÅ</strong></p>
            <div class="sentence-container">
                <div id="sentence-display">ÁÇπÂáª‰∏ãÊñπÊåâÈíÆÁîüÊàêÂè•Â≠ê„ÄÇ</div>
                <button class="tts-btn" onclick="speakText(document.getElementById('sentence-display').textContent)" style="align-self: flex-start;">üîä</button>
                <button class="translation-toggle" onclick="toggleTranslation('sentence-display-translation')" style="align-self: flex-start;">‰∏≠Êñá</button>
            </div>
            <div id="sentence-display-translation" class="translation"></div>
            <button class="button" onclick="runKielioppimatriisi()">Luo uusi lause (ÁîüÊàêÊñ∞Âè•Â≠ê)</button>
        </div>

        <!-- ========================================================== -->
        <!-- Èò∂ÊÆµÂõõÔºöËÆ§Áü•ÂçáÂçé (Kokonaiskuva) -->
        <!-- ========================================================== -->
        <div class="module">
            <h2>Èò∂ÊÆµÂõõÔºöËÆ§Áü•ÂçáÂçé - "ÊÄªËÆæËÆ°Â∏àËìùÂõæ"</h2>
            <p class="instructions">
                <strong>ÁõÆÊ†áÔºö</strong>Â∞Ü‰Ω†Â∑≤ÁªèÂÜÖÂåñÁöÑ"ËØ≠ÊÑü"ËΩ¨Âåñ‰∏∫Ê∏ÖÊô∞ÁöÑ"ËÆæËÆ°ËßÑÂàô"„ÄÇËØ∑ÂõûÁ≠î‰ª•‰∏ãÈóÆÈ¢òÔºåÂ∞Ü‰Ω†ÁöÑÂèëÁé∞Êï¥ÁêÜÊàê‰Ω†ÁöÑÁßÅ‰∫∫Ëä¨ÂÖ∞ËØ≠Áü•ËØÜÂ∫ìÔºÅ
            </p>

            <div class="guided-question">
                <h3>ÈóÆÈ¢ò1ÔºöÊó∂Èó¥ÁöÑÂç∞ËÆ∞</h3>
                <p>ÂõûÈ°æÈò∂ÊÆµ‰∏ÄÂíå‰∫åÔºåÂΩì‰Ω†ÊÉ≥Ë¶ÅÊèèËø∞‰∏Ä‰ª∂„ÄêÊò®Â§©ÂèëÁîü„ÄëÁöÑ‰∫ãÊó∂ÔºåËä¨ÂÖ∞ËØ≠ÁöÑÂä®ËØçÊú¨Ë∫´ÂèëÁîü‰∫Ü‰ªÄ‰πàÊúÄÊ†∏ÂøÉÁöÑÂèòÂåñÔºüÔºàÊèêÁ§∫ÔºöËßÇÂØüÈÇ£‰∫õÈ´ò‰∫ÆÁöÑÂä®ËØçÔºåÂÆÉ‰ª¨ÂÖ±ÂêåÁöÑ"Â£∞Èü≥ÂØÜÁ†Å"ÊòØ‰ªÄ‰πàÔºüÔºâ</p>
                <div class="answer-space">
                    <!-- Â≠¶‰π†ËÄÖÂèØ‰ª•Âú®ËÑë‰∏≠ÊàñÁ∫∏‰∏äÂõûÁ≠î -->
                </div>
                <button class="translation-toggle" onclick="toggleTranslation('answer1')">ÁÇπÂáªÊü•ÁúãËÆ§Áü•ÈîöÁÇπ</button>
                <div id="answer1" class="translation">
                    <p><strong>ËÆ§Áü•ÈîöÁÇπÔºö</strong>Âä®ËØçÁöÑ‰∏≠Èó¥ÈÄöÂ∏∏‰ºöÂä†ÂÖ•‰∏Ä‰∏™ <strong>-i-</strong> Ê†áËÆ∞ÔºåËøôÂ∞±ÊòØËä¨ÂÖ∞ËØ≠ËøáÂéªÊó∂ÁöÑ"Êó∂Èó¥Êà≥"„ÄÇ‰æãÂ¶ÇÔºölukea -> luk<strong>i</strong>, sy√∂d√§ -> s√∂<strong>i</strong>„ÄÇ‰Ω†Â∑≤ÁªèÊéåÊè°‰∫ÜÂêØÂä®"Êó∂Èó¥Á©øÊ¢≠Êú∫"ÁöÑÁ¨¨‰∏Ä‰∏™ÂØÜÁ†ÅÔºÅ</p>
                </div>
            </div>

            <div class="guided-question">
                <h3>ÈóÆÈ¢ò2ÔºöÂÆåÊàêÁöÑ‰ø°Âè∑</h3>
                <p>ËßÇÂØüÈò∂ÊÆµ‰∫åÁöÑ"‰∫ã‰ª∂ÂõûÊîæÊ®°ÊãüÂô®"„ÄÇÂΩì‰∏Ä‰∏™Âä®‰Ωú„ÄêÊ≠£Âú®ËøõË°å„Äë(esim. Ê≠£Âú®ÂêÉËãπÊûú) Êó∂ÔºåÂè•Â≠êÁöÑÂÆæËØ≠ (ËãπÊûú) ÊòØ‰ªÄ‰πàÂΩ¢ÂºèÔºüÂΩìËøô‰∏™Âä®‰Ωú„ÄêÂ∑≤ÁªèÂÆåÊàê„Äë(esim. ÂêÉÂÆå‰∫ÜËãπÊûú) Êó∂ÔºåÂÆæËØ≠ÁöÑÂΩ¢ÂºèÂèàÂèëÁîü‰∫Ü‰ªÄ‰πàÁ•ûÂ•áÁöÑÂèòÂåñÔºü</p>
                <div class="answer-space"></div>
                <button class="translation-toggle" onclick="toggleTranslation('answer2')">ÁÇπÂáªÊü•ÁúãËÆ§Áü•ÈîöÁÇπ</button>
                <div id="answer2" class="translation">
                    <p><strong>ËÆ§Áü•ÈîöÁÇπÔºö</strong>Ê≤°ÈîôÔºÅ</p>
                    <ul>
                        <li><strong>ËøõË°å‰∏≠ (ÈÉ®ÂàÜÊ†º, Partitiivi):</strong> `omenaa` (-a/√§, -ta/t√§, -tta/tt√§ÁªìÂ∞æ)„ÄÇËøôË°®Á§∫Âä®‰Ωú‰ΩúÁî®‰∫éÁâ©‰ΩìÁöÑ‰∏ÄÈÉ®ÂàÜÔºåÊàñÁªìÊûú‰∏çÁ°ÆÂÆö„ÄÇ</li>
                        <li><strong>Â∑≤ÂÆåÊàê (Â±ûÊ†º/ÂÆæÊ†º, Genetiivi/Akkusatiivi):</strong> `omenan` (-nÁªìÂ∞æ)„ÄÇËøôÂÉè‰∏Ä‰∏™"ÂÆåÊàê"ÁöÑÂç∞Á´†ÔºåË°®Á§∫Êï¥‰∏™Âä®‰ΩúÁªìÊùüÔºåÂπ∂‰∫ßÂá∫‰∫Ü‰∏Ä‰∏™ÂÆåÊï¥ÁöÑÁªìÊûú„ÄÇ</li>
                    </ul>
                    <p><strong>ËøôÂ∞±ÊòØËä¨ÂÖ∞ËØ≠ÂÆæËØ≠Ê†ºÁöÑÊ†∏ÂøÉÁßòÂØÜÔºöÂÆÉ‰∏ç‰ªÖ‰ªÖËØ¥Êòé"Ë∞ÅÊòØÂÆæËØ≠"ÔºåÊõ¥ÈáçË¶ÅÁöÑÊòØÊèèËø∞‰∫Ü"Âä®‰ΩúÁöÑÁä∂ÊÄÅÂíåÁªìÊûú"ÔºÅ</strong></p>
                </div>
            </div>
            
            <div class="guided-question">
                <h3>ÈóÆÈ¢ò3Ôºö‰Ω†ÁöÑËÆæËÆ°ËìùÂõæ</h3>
                <p>Áé∞Âú®ÔºåËØ∑ËØïÁùÄÁî®‰Ω†Ëá™Â∑±ÁöÑËØùÔºåÊÄªÁªì‰∏Ä‰∏ãÔºöÂ¶ÇÊûúÊàëÊò®Â§©„ÄêÂÆåÊàê„Äë‰∫Ü‰∏Ä‰ª∂‰∫ãÔºàÊØîÂ¶Ç"ÊàëËØªÂÆå‰∫Ü‰∏ÄÊú¨‰π¶"ÔºâÔºåÊàëÈúÄË¶ÅÂØπÂè•Â≠êÈáåÁöÑÂì™‰∏§‰∏™ÈÉ®ÂàÜËøõË°å"ÁºñËØë"Ôºå‰ª•ÂèäÂ¶Ç‰Ωï"ÁºñËØë"Ôºü</p>
                <div class="answer-space"></div>
                <button class="translation-toggle" onclick="toggleTranslation('answer3')">ÁÇπÂáªÊü•ÁúãËÆ§Áü•ÈîöÁÇπ</button>
                <div id="answer3" class="translation">
                    <p><strong>‰∏Ä‰∏™‰ºòÁßÄÁöÑËÆæËÆ°ËìùÂõæÂèØËÉΩÊòØËøôÊ†∑ÁöÑÔºö</strong></p>
                    <p>1. ÊâæÂà∞„ÄêÂä®ËØç„ÄëÔºåÁªôÂÆÉÊâì‰∏äËøáÂéªÁöÑ„ÄêÊó∂Èó¥Êà≥„ÄëÔºåÈÄöÂ∏∏ÊòØÂä†ÂÖ• <strong>-i-</strong> (esim. `lukea` -> `luin`)„ÄÇ</p>
                    <p>2. ÊâæÂà∞„ÄêÂÆæËØ≠„ÄëÔºåÁªôÂÆÉÁõñ‰∏ä„ÄêÂ∑≤ÂÆåÊàê„ÄëÁöÑÂç∞Á´†ÔºåÈÄöÂ∏∏ÊòØÊääÂÆÉÂèòÊàê <strong>-n</strong> ÁªìÂ∞æÁöÑÂΩ¢Âºè (esim. `kirja` -> `kirjan`)„ÄÇ</p>
                    <p>3. ÁªÑÂêàËµ∑Êù•Ôºö`Min√§ luin kirjan.` (ÊàëËØªÂÆå‰∫Ü‰∏ÄÊú¨‰π¶„ÄÇ) ÊÅ≠Âñú‰Ω†Ôºå‰Ω†Â∑≤Áªè‰ªé‰∏Ä‰∏™‰ΩøÁî®ËÄÖÔºåÊôãÂçá‰∏∫Ëä¨ÂÖ∞ËØ≠ÁöÑ"Âè•Â≠êËÆæËÆ°Â∏à"‰∫ÜÔºÅ</p>
                </div>
            </div>

            <div class="guided-question">
                <h3>ÈóÆÈ¢ò4ÔºöËøÅÁßª‰∏éÂ∫îÁî®</h3>
                <p>Âü∫‰∫é‰Ω†ÂàöÊâçÊÄªÁªìÁöÑ"ËÆæËÆ°ËìùÂõæ"ÔºåËØïÁùÄÊûÑÈÄ†Ëøô‰∏™Âè•Â≠êÔºö"Êò®Â§©ÊàëÂÆåÊàê‰∫Ü‰Ωú‰∏ö„ÄÇ"‰Ω†‰ºöÂ¶Ç‰Ωï"ÁºñËØë"Ëøô‰∏™Ëä¨ÂÖ∞ËØ≠Âè•Â≠êÔºüÔºàÊèêÁ§∫Ôºötehd√§ = ÂÅöÔºåkotiteht√§v√§ = ‰Ωú‰∏öÔºâ</p>
                <div class="answer-space"></div>
                <button class="translation-toggle" onclick="toggleTranslation('answer4')">ÁÇπÂáªÊü•ÁúãËÆ§Áü•ÈîöÁÇπ</button>
                <div id="answer4" class="translation">
                    <p><strong>ËÆ§Áü•ÈîöÁÇπÔºö</strong></p>
                    <p>ÊåâÁÖß‰Ω†ÁöÑËÆæËÆ°ËìùÂõæÔºö</p>
                    <p>1. Âä®ËØçÔºö`tehd√§` -> `tein` (Âä†ÂÖ•Êó∂Èó¥Êà≥ -i-)</p>
                    <p>2. ÂÆæËØ≠Ôºö`kotiteht√§v√§` -> `kotiteht√§v√§n` (Âä†‰∏äÂÆåÊàêÂç∞Á´† -n)</p>
                    <p>3. ÁªÑÂêàÔºö`Min√§ tein kotiteht√§v√§n.` (ÊàëÂÆåÊàê‰∫Ü‰Ωú‰∏ö„ÄÇ)</p>
                    <p><strong>üéâ ÊÅ≠ÂñúÔºÅ‰Ω†Â∑≤ÁªèËÉΩÂ§üÁã¨Á´ãËÆæËÆ°Ëä¨ÂÖ∞ËØ≠Âè•Â≠ê‰∫ÜÔºÅËøôÊ≠£ÊòØÁúüÊ≠£ÁöÑËØ≠Ë®ÄÊéåÊéßÂäõÔºÅ</strong></p>
                </div>
            </div>

            <div class="completion-message">
                <h3>üèÜ ËÆ§Áü•ÂçáÂçéÂÆåÊàê</h3>
                <p>‰Ω†Â∑≤ÁªèÊàêÂäüÂÆåÊàê‰∫Ü‰ªé"ÊÑüÊÄß‰ΩìÈ™å"Âà∞"ÁêÜÊÄßÊéåÊéß"ÁöÑËÆ§Áü•ÂçáÂçéÔºÅÁé∞Âú®‰Ω†Êã•ÊúâÁöÑ‰∏çÂÜçÂè™ÊòØ"ËØ≠ÊÑü"ÔºåËÄåÊòØÂèØ‰ª•Ê∏ÖÊô∞Ë°®Ëø∞„ÄÅ‰∏ªÂä®ËøêÁî®„ÄÅÁÅµÊ¥ªËøÅÁßªÁöÑ"ËÆæËÆ°ËÉΩÂäõ"„ÄÇ</p>
                <p><strong>‰∏ã‰∏ÄÊ≠•Ôºö</strong>Â∞ÜËøô‰∫õËÆ§Áü•ÈîöÁÇπËÆ∞ÂΩïÂú®‰Ω†ÁöÑÂ≠¶‰π†Á¨îËÆ∞‰∏≠ÔºåÂÆÉ‰ª¨Â∞ÜÊàê‰∏∫‰Ω†Ëä¨ÂÖ∞ËØ≠Â≠¶‰π†Ë∑Ø‰∏äÊúÄÊúâ‰ª∑ÂÄºÁöÑÊåáÂçóÈíàÔºÅ</p>
            </div>
        </div>

    </div>

    <script>
        // ==========================================================
        // Êï∞ÊçÆÂ±Ç (Data Layer)
        // ==========================================================
        
        // --- Èò∂ÊÆµ‰∏ÄÊï∞ÊçÆÔºöÊÅíÂÆöÈÉ®ÂàÜÊ†ºÂä®ËØçÔºàÂåÖÂê´‰∏≠ÊñáÁøªËØëÔºâ ---
        const aikakoneData = [
            { 
                verbi: "rakastaa", 
                preesens: { min√§: "rakastan", sin√§: "rakastat", h√§n: "rakastaa", me: "rakastamme", te: "rakastatte", he: "rakastavat" }, 
                imperfekti: { min√§: "rakastin", sin√§: "rakastit", h√§n: "rakasti", me: "rakastimme", te: "rakastitte", he: "rakastivat" }, 
                objekti: "sinua",
                translations: {
                    preesens: { min√§: "ÊàëÁà±", sin√§: "‰Ω†Áà±", h√§n: "‰ªñ/Â•πÁà±", me: "Êàë‰ª¨Áà±", te: "‰Ω†‰ª¨Áà±", he: "‰ªñ‰ª¨Áà±" },
                    imperfekti: { min√§: "ÊàëÁà±Ëøá", sin√§: "‰Ω†Áà±Ëøá", h√§n: "‰ªñ/Â•πÁà±Ëøá", me: "Êàë‰ª¨Áà±Ëøá", te: "‰Ω†‰ª¨Áà±Ëøá", he: "‰ªñ‰ª¨Áà±Ëøá" },
                    objekti: "‰Ω†"
                }
            },
            { 
                verbi: "odottaa", 
                preesens: { min√§: "odotan", sin√§: "odotat", h√§n: "odottaa", me: "odotamme", te: "odotatte", he: "odottavat" }, 
                imperfekti: { min√§: "odotin", sin√§: "odotit", h√§n: "odotti", me: "odotimme", te: "odotitte", he: "odottivat" }, 
                objekti: "bussia",
                translations: {
                    preesens: { min√§: "ÊàëÂú®Á≠â", sin√§: "‰Ω†Âú®Á≠â", h√§n: "‰ªñ/Â•πÂú®Á≠â", me: "Êàë‰ª¨Âú®Á≠â", te: "‰Ω†‰ª¨Âú®Á≠â", he: "‰ªñ‰ª¨Âú®Á≠â" },
                    imperfekti: { min√§: "ÊàëÁ≠â‰∫Ü", sin√§: "‰Ω†Á≠â‰∫Ü", h√§n: "‰ªñ/Â•πÁ≠â‰∫Ü", me: "Êàë‰ª¨Á≠â‰∫Ü", te: "‰Ω†‰ª¨Á≠â‰∫Ü", he: "‰ªñ‰ª¨Á≠â‰∫Ü" },
                    objekti: "ÂÖ¨‰∫§ËΩ¶"
                }
            },
            { 
                verbi: "pelata", 
                preesens: { min√§: "pelaan", sin√§: "pelaat", h√§n: "pelaa", me: "pelaamme", te: "pelaatte", he: "pelaavat" }, 
                imperfekti: { min√§: "pelasin", sin√§: "pelasit", h√§n: "pelasi", me: "pelasimme", te: "pelasitte", he: "pelasivat" }, 
                objekti: "jalkapalloa",
                translations: {
                    preesens: { min√§: "ÊàëÂú®Ë∏¢", sin√§: "‰Ω†Âú®Ë∏¢", h√§n: "‰ªñ/Â•πÂú®Ë∏¢", me: "Êàë‰ª¨Âú®Ë∏¢", te: "‰Ω†‰ª¨Âú®Ë∏¢", he: "‰ªñ‰ª¨Âú®Ë∏¢" },
                    imperfekti: { min√§: "ÊàëË∏¢‰∫Ü", sin√§: "‰Ω†Ë∏¢‰∫Ü", h√§n: "‰ªñ/Â•πË∏¢‰∫Ü", me: "Êàë‰ª¨Ë∏¢‰∫Ü", te: "‰Ω†‰ª¨Ë∏¢‰∫Ü", he: "‰ªñ‰ª¨Ë∏¢‰∫Ü" },
                    objekti: "Ë∂≥ÁêÉ"
                }
            },
            { 
                verbi: "soittaa", 
                preesens: { min√§: "soitan", sin√§: "soitat", h√§n: "soittaa", me: "soitamme", te: "soitatte", he: "soittavat" }, 
                imperfekti: { min√§: "soitin", sin√§: "soitit", h√§n: "soitti", me: "soitimme", te: "soititte", he: "soittivat" }, 
                objekti: "pianoa",
                translations: {
                    preesens: { min√§: "ÊàëÂú®Âºπ", sin√§: "‰Ω†Âú®Âºπ", h√§n: "‰ªñ/Â•πÂú®Âºπ", me: "Êàë‰ª¨Âú®Âºπ", te: "‰Ω†‰ª¨Âú®Âºπ", he: "‰ªñ‰ª¨Âú®Âºπ" },
                    imperfekti: { min√§: "ÊàëÂºπ‰∫Ü", sin√§: "‰Ω†Âºπ‰∫Ü", h√§n: "‰ªñ/Â•πÂºπ‰∫Ü", me: "Êàë‰ª¨Âºπ‰∫Ü", te: "‰Ω†‰ª¨Âºπ‰∫Ü", he: "‰ªñ‰ª¨Âºπ‰∫Ü" },
                    objekti: "Èí¢Áê¥"
                }
            },
            { 
                verbi: "kuunnella", 
                preesens: { min√§: "kuuntelen", sin√§: "kuuntelet", h√§n: "kuuntelee", me: "kuuntelemme", te: "kuuntelette", he: "kuuntelevat" }, 
                imperfekti: { min√§: "kuuntelin", sin√§: "kuuntelit", h√§n: "kuunteli", me: "kuuntelimme", te: "kuuntelitte", he: "kuuntelivat" }, 
                objekti: "musiikkia",
                translations: {
                    preesens: { min√§: "ÊàëÂú®Âê¨", sin√§: "‰Ω†Âú®Âê¨", h√§n: "‰ªñ/Â•πÂú®Âê¨", me: "Êàë‰ª¨Âú®Âê¨", te: "‰Ω†‰ª¨Âú®Âê¨", he: "‰ªñ‰ª¨Âú®Âê¨" },
                    imperfekti: { min√§: "ÊàëÂê¨‰∫Ü", sin√§: "‰Ω†Âê¨‰∫Ü", h√§n: "‰ªñ/Â•πÂê¨‰∫Ü", me: "Êàë‰ª¨Âê¨‰∫Ü", te: "‰Ω†‰ª¨Âê¨‰∫Ü", he: "‰ªñ‰ª¨Âê¨‰∫Ü" },
                    objekti: "Èü≥‰πê"
                }
            },
            { 
                verbi: "katsoa", 
                preesens: { min√§: "katson", sin√§: "katsot", h√§n: "katsoo", me: "katsomme", te: "katsotte", he: "katsovat" }, 
                imperfekti: { min√§: "katsoin", sin√§: "katsoit", h√§n: "katsoi", me: "katsoimme", te: "katsoitte", he: "katsoivat" }, 
                objekti: "televisiota",
                translations: {
                    preesens: { min√§: "ÊàëÂú®Áúã", sin√§: "‰Ω†Âú®Áúã", h√§n: "‰ªñ/Â•πÂú®Áúã", me: "Êàë‰ª¨Âú®Áúã", te: "‰Ω†‰ª¨Âú®Áúã", he: "‰ªñ‰ª¨Âú®Áúã" },
                    imperfekti: { min√§: "ÊàëÁúã‰∫Ü", sin√§: "‰Ω†Áúã‰∫Ü", h√§n: "‰ªñ/Â•πÁúã‰∫Ü", me: "Êàë‰ª¨Áúã‰∫Ü", te: "‰Ω†‰ª¨Áúã‰∫Ü", he: "‰ªñ‰ª¨Áúã‰∫Ü" },
                    objekti: "ÁîµËßÜ"
                }
            },
            { 
                verbi: "puhua", 
                preesens: { min√§: "puhun", sin√§: "puhut", h√§n: "puhuu", me: "puhumme", te: "puhutte", he: "puhuvat" }, 
                imperfekti: { min√§: "puhuin", sin√§: "puhuit", h√§n: "puhui", me: "puhuimme", te: "puhuitte", he: "puhuivat" }, 
                objekti: "suomea",
                translations: {
                    preesens: { min√§: "ÊàëÂú®ËØ¥", sin√§: "‰Ω†Âú®ËØ¥", h√§n: "‰ªñ/Â•πÂú®ËØ¥", me: "Êàë‰ª¨Âú®ËØ¥", te: "‰Ω†‰ª¨Âú®ËØ¥", he: "‰ªñ‰ª¨Âú®ËØ¥" },
                    imperfekti: { min√§: "ÊàëËØ¥‰∫Ü", sin√§: "‰Ω†ËØ¥‰∫Ü", h√§n: "‰ªñ/Â•πËØ¥‰∫Ü", me: "Êàë‰ª¨ËØ¥‰∫Ü", te: "‰Ω†‰ª¨ËØ¥‰∫Ü", he: "‰ªñ‰ª¨ËØ¥‰∫Ü" },
                    objekti: "Ëä¨ÂÖ∞ËØ≠"
                }
            },
            { 
                verbi: "opiskella", 
                preesens: { min√§: "opiskelen", sin√§: "opiskelet", h√§n: "opiskelee", me: "opiskelemme", te: "opiskelette", he: "opiskelevat" }, 
                imperfekti: { min√§: "opiskelin", sin√§: "opiskelit", h√§n: "opiskeli", me: "opiskelimme", te: "opiskelitte", he: "opiskelivat" }, 
                objekti: "kielt√§",
                translations: {
                    preesens: { min√§: "ÊàëÂú®Â≠¶", sin√§: "‰Ω†Âú®Â≠¶", h√§n: "‰ªñ/Â•πÂú®Â≠¶", me: "Êàë‰ª¨Âú®Â≠¶", te: "‰Ω†‰ª¨Âú®Â≠¶", he: "‰ªñ‰ª¨Âú®Â≠¶" },
                    imperfekti: { min√§: "ÊàëÂ≠¶‰∫Ü", sin√§: "‰Ω†Â≠¶‰∫Ü", h√§n: "‰ªñ/Â•πÂ≠¶‰∫Ü", me: "Êàë‰ª¨Â≠¶‰∫Ü", te: "‰Ω†‰ª¨Â≠¶‰∫Ü", he: "‰ªñ‰ª¨Â≠¶‰∫Ü" },
                    objekti: "ËØ≠Ë®Ä"
                }
            },
            { 
                verbi: "ty√∂skennell√§", 
                preesens: { min√§: "ty√∂skentelen", sin√§: "ty√∂skentelet", h√§n: "ty√∂skentelee", me: "ty√∂skentelemme", te: "ty√∂skentelette", he: "ty√∂skentelev√§t" }, 
                imperfekti: { min√§: "ty√∂skentelin", sin√§: "ty√∂skentelit", h√§n: "ty√∂skenteli", me: "ty√∂skentelimme", te: "ty√∂skentelitte", he: "ty√∂skenteliv√§t" }, 
                objekti: "projektia",
                translations: {
                    preesens: { min√§: "ÊàëÂú®ÂÅö", sin√§: "‰Ω†Âú®ÂÅö", h√§n: "‰ªñ/Â•πÂú®ÂÅö", me: "Êàë‰ª¨Âú®ÂÅö", te: "‰Ω†‰ª¨Âú®ÂÅö", he: "‰ªñ‰ª¨Âú®ÂÅö" },
                    imperfekti: { min√§: "ÊàëÂÅö‰∫Ü", sin√§: "‰Ω†ÂÅö‰∫Ü", h√§n: "‰ªñ/Â•πÂÅö‰∫Ü", me: "Êàë‰ª¨ÂÅö‰∫Ü", te: "‰Ω†‰ª¨ÂÅö‰∫Ü", he: "‰ªñ‰ª¨ÂÅö‰∫Ü" },
                    objekti: "È°πÁõÆ"
                }
            },
            { 
                verbi: "auttaa", 
                preesens: { min√§: "autan", sin√§: "autat", h√§n: "auttaa", me: "autamme", te: "autatte", he: "auttavat" }, 
                imperfekti: { min√§: "autin", sin√§: "autit", h√§n: "auttoi", me: "autoimme", te: "autoitte", he: "auttoivat" }, 
                objekti: "yst√§v√§√§",
                translations: {
                    preesens: { min√§: "ÊàëÂú®Â∏Æ", sin√§: "‰Ω†Âú®Â∏Æ", h√§n: "‰ªñ/Â•πÂú®Â∏Æ", me: "Êàë‰ª¨Âú®Â∏Æ", te: "‰Ω†‰ª¨Âú®Â∏Æ", he: "‰ªñ‰ª¨Âú®Â∏Æ" },
                    imperfekti: { min√§: "ÊàëÂ∏Æ‰∫Ü", sin√§: "‰Ω†Â∏Æ‰∫Ü", h√§n: "‰ªñ/Â•πÂ∏Æ‰∫Ü", me: "Êàë‰ª¨Â∏Æ‰∫Ü", te: "‰Ω†‰ª¨Â∏Æ‰∫Ü", he: "‰ªñ‰ª¨Â∏Æ‰∫Ü" },
                    objekti: "ÊúãÂèã"
                }
            }
        ];

        // --- Èò∂ÊÆµ‰∫åÊï∞ÊçÆÔºö‰∫ã‰ª∂ÂõûÊîæÔºàÂåÖÂê´‰∏≠ÊñáÁøªËØëÂíåËßÜËßâÂÖÉÁ¥†Ôºâ ---
        const tapahtumatoistinData = [
            { 
                id: 1, nimi: "ÂêÉËãπÊûú", 
                kuva_prosessi: "https://placehold.co/600x400/E8D8A7/000000?text=Sy%C3%B6n+omenaa...", 
                kuva_tulos: "https://placehold.co/600x400/A3C9A8/000000?text=S%C3%B6in+omenan!", 
                lause_prosessi: "Min√§ sy√∂n <span class='highlight'>omenaa</span>.", 
                lause_tulos: "Min√§ <span class='highlight'>s√∂in</span> <span class='highlight'>omenan</span>.",
                visual: {
                    emoji: "üçé",
                    action_process: "üëÑ",
                    action_result: "‚úÖ",
                    animation_class: "eating",
                    label_process: "Ê≠£Âú®ÂêÉ...",
                    label_result: "ÂêÉÂÆå‰∫ÜÔºÅ"
                },
                translations: {
                    prosessi: "ÊàëÂú®ÂêÉËãπÊûú„ÄÇÔºàÂä®‰ΩúËøõË°å‰∏≠Ôºâ",
                    tulos: "ÊàëÂêÉ‰∫ÜËãπÊûú„ÄÇÔºàÂä®‰ΩúÂ∑≤ÂÆåÊàêÔºâ"
                }
            },
            { 
                id: 2, nimi: "ÂñùÂíñÂï°", 
                kuva_prosessi: "https://placehold.co/600x400/E8D8A7/000000?text=Juon+kahvia...", 
                kuva_tulos: "https://placehold.co/600x400/A3C9A8/000000?text=Join+kahvin!", 
                lause_prosessi: "Sin√§ juot <span class='highlight'>kahvia</span>.", 
                lause_tulos: "Sin√§ <span class='highlight'>joit</span> <span class='highlight'>kahvin</span>.",
                visual: {
                    emoji: "‚òï",
                    action_process: "üëÑ",
                    action_result: "‚úÖ",
                    animation_class: "drinking",
                    label_process: "Ê≠£Âú®Âñù...",
                    label_result: "ÂñùÂÆå‰∫ÜÔºÅ"
                },
                translations: {
                    prosessi: "‰Ω†Âú®ÂñùÂíñÂï°„ÄÇÔºàÂä®‰ΩúËøõË°å‰∏≠Ôºâ",
                    tulos: "‰Ω†Âñù‰∫ÜÂíñÂï°„ÄÇÔºàÂä®‰ΩúÂ∑≤ÂÆåÊàêÔºâ"
                }
            },
            { 
                id: 3, nimi: "ËØª‰π¶", 
                kuva_prosessi: "https://placehold.co/600x400/E8D8A7/000000?text=Luen+kirjaa...", 
                kuva_tulos: "https://placehold.co/600x400/A3C9A8/000000?text=Luin+kirjan!", 
                lause_prosessi: "H√§n lukee <span class='highlight'>kirjaa</span>.", 
                lause_tulos: "H√§n <span class='highlight'>luki</span> <span class='highlight'>kirjan</span>.",
                visual: {
                    emoji: "üìñ",
                    action_process: "üëÄ",
                    action_result: "‚úÖ",
                    animation_class: "reading",
                    label_process: "Ê≠£Âú®ËØª...",
                    label_result: "ËØªÂÆå‰∫ÜÔºÅ"
                },
                translations: {
                    prosessi: "‰ªñ/Â•πÂú®ËØª‰π¶„ÄÇÔºàÂä®‰ΩúËøõË°å‰∏≠Ôºâ",
                    tulos: "‰ªñ/Â•πËØª‰∫Ü‰π¶„ÄÇÔºàÂä®‰ΩúÂ∑≤ÂÆåÊàêÔºâ"
                }
            },
            { 
                id: 4, nimi: "ÂÜô‰ø°", 
                kuva_prosessi: "https://placehold.co/600x400/E8D8A7/000000?text=Kirjoitan+kirjett%C3%A4...", 
                kuva_tulos: "https://placehold.co/600x400/A3C9A8/000000?text=Kirjoitin+kirjeen!", 
                lause_prosessi: "Me kirjoitamme <span class='highlight'>kirjett√§</span>.", 
                lause_tulos: "Me <span class='highlight'>kirjoitimme</span> <span class='highlight'>kirjeen</span>.",
                visual: {
                    emoji: "‚úâÔ∏è",
                    action_process: "‚úçÔ∏è",
                    action_result: "‚úÖ",
                    animation_class: "writing",
                    label_process: "Ê≠£Âú®ÂÜô...",
                    label_result: "ÂÜôÂÆå‰∫ÜÔºÅ"
                },
                translations: {
                    prosessi: "Êàë‰ª¨Âú®ÂÜô‰ø°„ÄÇÔºàÂä®‰ΩúËøõË°å‰∏≠Ôºâ",
                    tulos: "Êàë‰ª¨ÂÜô‰∫Ü‰ø°„ÄÇÔºàÂä®‰ΩúÂ∑≤ÂÆåÊàêÔºâ"
                }
            },
            { 
                id: 5, nimi: "ÁîªÁîª", 
                kuva_prosessi: "https://placehold.co/600x400/E8D8A7/000000?text=Maalaan+taulua...", 
                kuva_tulos: "https://placehold.co/600x400/A3C9A8/000000?text=Maalasin+taulun!", 
                lause_prosessi: "He maalaavat <span class='highlight'>taulua</span>.", 
                lause_tulos: "He <span class='highlight'>maalasivat</span> <span class='highlight'>taulun</span>.",
                visual: {
                    emoji: "üé®",
                    action_process: "üñåÔ∏è",
                    action_result: "‚úÖ",
                    animation_class: "painting",
                    label_process: "Ê≠£Âú®Áîª...",
                    label_result: "ÁîªÂÆå‰∫ÜÔºÅ"
                },
                translations: {
                    prosessi: "‰ªñ‰ª¨Âú®ÁîªÁîª„ÄÇÔºàÂä®‰ΩúËøõË°å‰∏≠Ôºâ",
                    tulos: "‰ªñ‰ª¨Áîª‰∫ÜÁîª„ÄÇÔºàÂä®‰ΩúÂ∑≤ÂÆåÊàêÔºâ"
                }
            },
            { 
                id: 6, nimi: "ÊâìÊâ´ÊàøÈó¥", 
                kuva_prosessi: "https://placehold.co/600x400/E8D8A7/000000?text=Siivoan+huonetta...", 
                kuva_tulos: "https://placehold.co/600x400/A3C9A8/000000?text=Siivosin+huoneen!", 
                lause_prosessi: "Min√§ siivoan <span class='highlight'>huonetta</span>.", 
                lause_tulos: "Min√§ <span class='highlight'>siivosin</span> <span class='highlight'>huoneen</span>.",
                visual: {
                    emoji: "üè†",
                    action_process: "üßπ",
                    action_result: "‚ú®",
                    animation_class: "cleaning",
                    label_process: "Ê≠£Âú®Êâ´...",
                    label_result: "Êâ´ÂÆå‰∫ÜÔºÅ"
                },
                translations: {
                    prosessi: "ÊàëÂú®ÊâìÊâ´ÊàøÈó¥„ÄÇÔºàÂä®‰ΩúËøõË°å‰∏≠Ôºâ",
                    tulos: "ÊàëÊâìÊâ´‰∫ÜÊàøÈó¥„ÄÇÔºàÂä®‰ΩúÂ∑≤ÂÆåÊàêÔºâ"
                }
            },
            { 
                id: 7, nimi: "‰π∞ËΩ¶", 
                kuva_prosessi: "https://placehold.co/600x400/E8D8A7/000000?text=Ostan+autoa...", 
                kuva_tulos: "https://placehold.co/600x400/A3C9A8/000000?text=Ostin+auton!", 
                lause_prosessi: "H√§n ostaa <span class='highlight'>autoa</span>.", 
                lause_tulos: "H√§n <span class='highlight'>osti</span> <span class='highlight'>auton</span>.",
                visual: {
                    emoji: "üöó",
                    action_process: "üëÄ",
                    action_result: "üîë",
                    animation_class: "shopping",
                    label_process: "Ê≠£Âú®ÈÄâ...",
                    label_result: "‰π∞Âà∞‰∫ÜÔºÅ"
                },
                translations: {
                    prosessi: "‰ªñ/Â•πÂú®‰π∞ËΩ¶„ÄÇÔºàÂä®‰ΩúËøõË°å‰∏≠Ôºâ",
                    tulos: "‰ªñ/Â•π‰π∞‰∫ÜËΩ¶„ÄÇÔºàÂä®‰ΩúÂ∑≤ÂÆåÊàêÔºâ"
                }
            },
            { 
                id: 8, nimi: "‰øÆËá™Ë°åËΩ¶", 
                kuva_prosessi: "https://placehold.co/600x400/E8D8A7/000000?text=Korjaan+py%C3%B6r%C3%A4%C3%A4...", 
                kuva_tulos: "https://placehold.co/600x400/A3C9A8/000000?text=Korjasin+py%C3%B6r%C3%A4n!", 
                lause_prosessi: "Sin√§ korjaat <span class='highlight'>py√∂r√§√§</span>.", 
                lause_tulos: "Sin√§ <span class='highlight'>korjasit</span> <span class='highlight'>py√∂r√§n</span>.",
                visual: {
                    emoji: "üö≤",
                    action_process: "üîß",
                    action_result: "‚úÖ",
                    animation_class: "fixing",
                    label_process: "Ê≠£Âú®‰øÆ...",
                    label_result: "‰øÆÂ•Ω‰∫ÜÔºÅ"
                },
                translations: {
                    prosessi: "‰Ω†Âú®‰øÆËá™Ë°åËΩ¶„ÄÇÔºàÂä®‰ΩúËøõË°å‰∏≠Ôºâ",
                    tulos: "‰Ω†‰øÆ‰∫ÜËá™Ë°åËΩ¶„ÄÇÔºàÂä®‰ΩúÂ∑≤ÂÆåÊàêÔºâ"
                }
            },
            { 
                id: 9, nimi: "ÂÖ≥Èó®", 
                kuva_prosessi: "https://placehold.co/600x400/E8D8A7/000000?text=Suljen+ovea...", 
                kuva_tulos: "https://placehold.co/600x400/A3C9A8/000000?text=Suljin+oven!", 
                lause_prosessi: "H√§n sulkee <span class='highlight'>ovea</span>.", 
                lause_tulos: "H√§n <span class='highlight'>sulki</span> <span class='highlight'>oven</span>.",
                visual: {
                    emoji: "üö™",
                    action_process: "üëã",
                    action_result: "üîí",
                    animation_class: "closing",
                    label_process: "Ê≠£Âú®ÂÖ≥...",
                    label_result: "ÂÖ≥‰∏ä‰∫ÜÔºÅ"
                },
                translations: {
                    prosessi: "‰ªñ/Â•πÂú®ÂÖ≥Èó®„ÄÇÔºàÂä®‰ΩúËøõË°å‰∏≠Ôºâ",
                    tulos: "‰ªñ/Â•πÂÖ≥‰∫ÜÈó®„ÄÇÔºàÂä®‰ΩúÂ∑≤ÂÆåÊàêÔºâ"
                }
            },
            { 
                id: 10, nimi: "ÁÖÆÊ±§", 
                kuva_prosessi: "https://placehold.co/600x400/E8D8A7/000000?text=Keit%C3%A4n+keittoa...", 
                kuva_tulos: "https://placehold.co/600x400/A3C9A8/000000?text=Keitin+keiton!", 
                lause_prosessi: "Me keit√§mme <span class='highlight'>keittoa</span>.", 
                lause_tulos: "Me <span class='highlight'>keitimme</span> <span class='highlight'>keiton</span>.",
                visual: {
                    emoji: "üç≤",
                    action_process: "ü•Ñ",
                    action_result: "üçΩÔ∏è",
                    animation_class: "cooking",
                    label_process: "Ê≠£Âú®ÁÖÆ...",
                    label_result: "ÁÖÆÂ•Ω‰∫ÜÔºÅ"
                },
                translations: {
                    prosessi: "Êàë‰ª¨Âú®ÁÖÆÊ±§„ÄÇÔºàÂä®‰ΩúËøõË°å‰∏≠Ôºâ",
                    tulos: "Êàë‰ª¨ÁÖÆ‰∫ÜÊ±§„ÄÇÔºàÂä®‰ΩúÂ∑≤ÂÆåÊàêÔºâ"
                }
            }
        ];

        // --- Èò∂ÊÆµ‰∏âÊï∞ÊçÆÔºöËØ≠Ê≥ïÁü©ÈòµÔºàÂåÖÂê´‰∏≠ÊñáÁøªËØëÔºâ ---
        const subjektit = ["Min√§", "Sin√§", "H√§n", "Pekka", "Liisa", "Opettaja", "Lapsi", "√Ñiti", "Is√§", "Yst√§v√§", "Veli", "Sisko", "Mummi", "Vaari", "Naapuri", "Kollega", "Opiskelija", "L√§√§k√§ri", "Me", "Te", "He"];
        const persoonaMap = { 
            "Min√§": "min√§", "Sin√§": "sin√§", "H√§n": "h√§n", "Pekka": "h√§n", "Liisa": "h√§n", "Opettaja": "h√§n", "Lapsi": "h√§n", 
            "√Ñiti": "h√§n", "Is√§": "h√§n", "Yst√§v√§": "h√§n", "Veli": "h√§n", "Sisko": "h√§n", "Mummi": "h√§n", "Vaari": "h√§n", 
            "Naapuri": "h√§n", "Kollega": "h√§n", "Opiskelija": "h√§n", "L√§√§k√§ri": "h√§n", "Me": "me", "Te": "te", "He": "he" 
        };
        const subjektitTranslations = { 
            "Min√§": "Êàë", "Sin√§": "‰Ω†", "H√§n": "‰ªñ/Â•π", "Pekka": "‰Ω©Âç°", "Liisa": "‰∏ΩËê®", "Opettaja": "ËÄÅÂ∏à", "Lapsi": "Â≠©Â≠ê", 
            "√Ñiti": "Â¶àÂ¶à", "Is√§": "Áà∏Áà∏", "Yst√§v√§": "ÊúãÂèã", "Veli": "Âì•Âì•/ÂºüÂºü", "Sisko": "ÂßêÂßê/Â¶πÂ¶π", "Mummi": "Â•∂Â•∂", "Vaari": "Áà∑Áà∑", 
            "Naapuri": "ÈÇªÂ±Ö", "Kollega": "Âêå‰∫ã", "Opiskelija": "Â≠¶Áîü", "L√§√§k√§ri": "ÂåªÁîü", "Me": "Êàë‰ª¨", "Te": "‰Ω†‰ª¨", "He": "‰ªñ‰ª¨" 
        };

        const verbiObjektiLinkit = [
            { verbi: { min√§: "s√∂in", sin√§: "s√∂it", h√§n: "s√∂i", me: "s√∂imme", te: "s√∂itte", he: "s√∂iv√§t" }, objekti_gen: "omenan", translations: { verbi: "ÂêÉ‰∫Ü", objekti: "ËãπÊûú" } },
            { verbi: { min√§: "join", sin√§: "joit", h√§n: "joi", me: "joimme", te: "joitte", he: "joivat" }, objekti_gen: "kahvin", translations: { verbi: "Âñù‰∫Ü", objekti: "ÂíñÂï°" } },
            { verbi: { min√§: "luin", sin√§: "luit", h√§n: "luki", me: "luimme", te: "luitte", he: "lukivat" }, objekti_gen: "kirjan", translations: { verbi: "ËØª‰∫Ü", objekti: "‰π¶" } },
            { verbi: { min√§: "ostin", sin√§: "ostit", h√§n: "osti", me: "ostimme", te: "ostitte", he: "ostivat" }, objekti_gen: "auton", translations: { verbi: "‰π∞‰∫Ü", objekti: "Ê±ΩËΩ¶" } },
            { verbi: { min√§: "tein", sin√§: "teit", h√§n: "teki", me: "teimme", te: "teitte", he: "tekiv√§t" }, objekti_gen: "ruoan", translations: { verbi: "ÂÅö‰∫Ü", objekti: "È£üÁâ©" } },
            { verbi: { min√§: "kirjoitin", sin√§: "kirjoitit", h√§n: "kirjoitti", me: "kirjoitimme", te: "kirjoititte", he: "kirjoittivat" }, objekti_gen: "kirjeen", translations: { verbi: "ÂÜô‰∫Ü", objekti: "‰ø°" } },
            { verbi: { min√§: "maalasin", sin√§: "maalasit", h√§n: "maalasi", me: "maalasimme", te: "maalasitte", he: "maalasivat" }, objekti_gen: "talon", translations: { verbi: "Áîª‰∫Ü", objekti: "ÊàøÂ≠ê" } },
            { verbi: { min√§: "siivosin", sin√§: "siivosit", h√§n: "siivosi", me: "siivosimme", te: "siivositte", he: "siivosivat" }, objekti_gen: "huoneen", translations: { verbi: "ÊâìÊâ´‰∫Ü", objekti: "ÊàøÈó¥" } },
            { verbi: { min√§: "korjasin", sin√§: "korjasit", h√§n: "korjasi", me: "korjasimme", te: "korjasitte", he: "korjasivat" }, objekti_gen: "py√∂r√§n", translations: { verbi: "‰øÆ‰∫Ü", objekti: "Ëá™Ë°åËΩ¶" } },
            { verbi: { min√§: "suljin", sin√§: "suljit", h√§n: "sulki", me: "suljimme", te: "suljitte", he: "sulkivat" }, objekti_gen: "oven", translations: { verbi: "ÂÖ≥‰∫Ü", objekti: "Èó®" } },
            { verbi: { min√§: "avasin", sin√§: "avasit", h√§n: "avasi", me: "avasimme", te: "avasitte", he: "avasivat" }, objekti_gen: "ikkunan", translations: { verbi: "ÊâìÂºÄ‰∫Ü", objekti: "Á™óÊà∑" } },
            { verbi: { min√§: "maksoin", sin√§: "maksoit", h√§n: "maksoi", me: "maksoimme", te: "maksoitte", he: "maksoivat" }, objekti_gen: "laskun", translations: { verbi: "ÊîØ‰ªò‰∫Ü", objekti: "Ë¥¶Âçï" } },
            { verbi: { min√§: "kuuntelin", sin√§: "kuuntelit", h√§n: "kuunteli", me: "kuuntelimme", te: "kuuntelitte", he: "kuuntelivat" }, objekti_gen: "musiikin", translations: { verbi: "Âê¨‰∫Ü", objekti: "Èü≥‰πê" } },
            { verbi: { min√§: "katsoin", sin√§: "katsoit", h√§n: "katsoi", me: "katsoimme", te: "katsoitte", he: "katsoivat" }, objekti_gen: "elokuvan", translations: { verbi: "Áúã‰∫Ü", objekti: "ÁîµÂΩ±" } },
            { verbi: { min√§: "puhuin", sin√§: "puhuit", h√§n: "puhui", me: "puhuimme", te: "puhuitte", he: "puhuivat" }, objekti_gen: "√§idin", translations: { verbi: "Âíå...ËØ¥ËØù‰∫Ü", objekti: "Â¶àÂ¶à" } },
            { verbi: { min√§: "opiskelin", sin√§: "opiskelit", h√§n: "opiskeli", me: "opiskelimme", te: "opiskelitte", he: "opiskelivat" }, objekti_gen: "matematiikan", translations: { verbi: "Â≠¶‰∫Ü", objekti: "Êï∞Â≠¶" } },
            { verbi: { min√§: "ty√∂skentelin", sin√§: "ty√∂skentelit", h√§n: "ty√∂skenteli", me: "ty√∂skentelimme", te: "ty√∂skentelitte", he: "ty√∂skenteliv√§t" }, objekti_gen: "teht√§v√§n", translations: { verbi: "ÂÅö‰∫Ü", objekti: "‰ªªÂä°" } },
            { verbi: { min√§: "autin", sin√§: "autit", h√§n: "auttoi", me: "autoimme", te: "autoitte", he: "auttoivat" }, objekti_gen: "yst√§v√§n", translations: { verbi: "Â∏Æ‰∫Ü", objekti: "ÊúãÂèã" } },
            { verbi: { min√§: "soitin", sin√§: "soitit", h√§n: "soitti", me: "soitimme", te: "soititte", he: "soittivat" }, objekti_gen: "kitaran", translations: { verbi: "Âºπ‰∫Ü", objekti: "Âêâ‰ªñ" } },
            { verbi: { min√§: "s√∂in", sin√§: "s√∂it", h√§n: "s√∂i", me: "s√∂imme", te: "s√∂itte", he: "s√∂iv√§t" }, objekti_gen: "pizzan", translations: { verbi: "ÂêÉ‰∫Ü", objekti: "ÊØîËê®" } },
            { verbi: { min√§: "pesin", sin√§: "pesit", h√§n: "pesi", me: "pesimme", te: "pesitte", he: "pesiv√§t" }, objekti_gen: "astiat", translations: { verbi: "Ê¥ó‰∫Ü", objekti: "È§êÂÖ∑" } },
            { verbi: { min√§: "l√∂ysin", sin√§: "l√∂ysit", h√§n: "l√∂ysi", me: "l√∂ysimme", te: "l√∂ysitte", he: "l√∂ysiv√§t" }, objekti_gen: "avaimen", translations: { verbi: "ÊâæÂà∞‰∫Ü", objekti: "Èí•Âåô" } },
            { verbi: { min√§: "unohdin", sin√§: "unohtit", h√§n: "unohti", me: "unohdimme", te: "unohditte", he: "unohtivat" }, objekti_gen: "laukun", translations: { verbi: "Âøò‰∫Ü", objekti: "ÂåÖ" } },
            { verbi: { min√§: "oppisin", sin√§: "oppisit", h√§n: "oppisi", me: "oppisimme", te: "oppisitte", he: "oppisiit" }, objekti_gen: "sanan", translations: { verbi: "Â≠¶‰ºö‰∫Ü", objekti: "ÂçïËØç" } }
        ];

        // ==========================================================
        // ÈÄªËæëÂ±Ç (Logic Layer)
        // ==========================================================

        // --- TTSÂáΩÊï∞ ---
        function speakText(text) {
            // ÁßªÈô§HTMLÊ†áÁ≠æ
            const cleanText = text.replace(/<[^>]*>/g, '');
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(cleanText);
                utterance.lang = 'fi-FI';
                utterance.rate = 0.8;
                speechSynthesis.speak(utterance);
            } else {
                alert('Êä±Ê≠âÔºåÊÇ®ÁöÑÊµèËßàÂô®‰∏çÊîØÊåÅËØ≠Èü≥Êí≠ÊîæÂäüËÉΩ„ÄÇ');
            }
        }

        // --- ÁøªËØëÊòæÁ§∫/ÈöêËóèÂáΩÊï∞ ---
        function toggleTranslation(elementId) {
            const element = document.getElementById(elementId);
            if (element.style.display === 'none' || element.style.display === '') {
                element.style.display = 'block';
            } else {
                element.style.display = 'none';
            }
        }

        // --- DOM ÂÖÉÁ¥†ÂºïÁî® ---
        const aikakoneNytEl = document.getElementById('aikakone-nyt');
        const aikakoneEilenEl = document.getElementById('aikakone-eilen');
        const aikakoneNytTranslationEl = document.getElementById('aikakone-nyt-translation');
        const aikakoneEilenTranslationEl = document.getElementById('aikakone-eilen-translation');
        
        const eventSelectEl = document.getElementById('event-select');
        const tapahtumatoistinVisualEl = document.getElementById('tapahtumatoistin-visual');
        const eventEmojiEl = document.getElementById('event-emoji');
        const eventActionEl = document.getElementById('event-action');
        const eventLabelEl = document.getElementById('event-label');
        const tapahtumatoistinSentenceEl = document.getElementById('tapahtumatoistin-sentence');
        const tapahtumatoistinSentenceTranslationEl = document.getElementById('tapahtumatoistin-sentence-translation');
        const tapahtumatoistinButtonEl = document.getElementById('tapahtumatoistin-button');
        const tapahtumatoistinAnswerContainerEl = document.getElementById('tapahtumatoistin-answer-container');
        const tapahtumatoistinAnswerEl = document.getElementById('tapahtumatoistin-answer');
        const tapahtumatoistinAnswerTranslationEl = document.getElementById('tapahtumatoistin-answer-translation');

        const sentenceDisplayEl = document.getElementById('sentence-display');
        const sentenceDisplayTranslationEl = document.getElementById('sentence-display-translation');

        // --- Áä∂ÊÄÅÂèòÈáè ---
        let tapahtumatoistinState = {
            isShowingProcess: true
        };

        let currentAikakoneData = null;
        let currentTapahtumatoistinData = null;
        let currentKielioppimatriisiTranslation = "";

        // --- ÈöèÊú∫ÈÄâÊã©ÂáΩÊï∞ ---
        function getRandomElement(arr) {
            return arr[Math.floor(Math.random() * arr.length)];
        }

        // --- Èò∂ÊÆµ‰∏ÄÈÄªËæë ---
        function runAikakone() {
            currentAikakoneData = getRandomElement(aikakoneData);
            const subjektiObj = getRandomElement(Object.keys(currentAikakoneData.preesens));
            const subjektiText = subjektiObj.charAt(0).toUpperCase() + subjektiObj.slice(1);
            
            const preesensLause = `${subjektiText} <span class="highlight">${currentAikakoneData.preesens[subjektiObj]}</span> ${currentAikakoneData.objekti}.`;
            const imperfektiLause = `${subjektiText} <span class="highlight">${currentAikakoneData.imperfekti[subjektiObj]}</span> ${currentAikakoneData.objekti}.`;

            aikakoneNytEl.innerHTML = preesensLause;
            aikakoneEilenEl.innerHTML = imperfektiLause;

            // ËÆæÁΩÆÁøªËØë
            aikakoneNytTranslationEl.textContent = `${currentAikakoneData.translations.preesens[subjektiObj]}${currentAikakoneData.translations.objekti}„ÄÇ`;
            aikakoneEilenTranslationEl.textContent = `${currentAikakoneData.translations.imperfekti[subjektiObj]}${currentAikakoneData.translations.objekti}„ÄÇ`;
        }

        // --- Èò∂ÊÆµ‰∫åÈÄªËæë ---
        function runTapahtumatoistin(reset = false) {
            if (reset) {
                tapahtumatoistinState.isShowingProcess = true;
            }

            const selectedEventId = parseInt(eventSelectEl.value);
            currentTapahtumatoistinData = tapahtumatoistinData.find(e => e.id === selectedEventId);
            const mode = document.querySelector('input[name="tapahtumatoistin-mode"]:checked').value;

            tapahtumatoistinAnswerContainerEl.style.display = 'none'; // Hide answer by default

            // Êõ¥Êñ∞ËßÜËßâÂÖÉÁ¥†
            const visual = currentTapahtumatoistinData.visual;
            eventEmojiEl.textContent = visual.emoji;
            
            // Ê∏ÖÈô§‰πãÂâçÁöÑÂä®ÁîªÁ±ª
            tapahtumatoistinVisualEl.className = 'visual-event';
            eventActionEl.className = 'event-action';

            if (mode === 'passive') {
                if (tapahtumatoistinState.isShowingProcess) {
                    // ÊòæÁ§∫ËøáÁ®ãÁä∂ÊÄÅ
                    tapahtumatoistinVisualEl.classList.add('process');
                    eventActionEl.textContent = visual.action_process;
                    eventActionEl.classList.add(visual.animation_class);
                    eventLabelEl.textContent = visual.label_process;
                    tapahtumatoistinSentenceEl.innerHTML = currentTapahtumatoistinData.lause_prosessi;
                    tapahtumatoistinSentenceTranslationEl.textContent = currentTapahtumatoistinData.translations.prosessi;
                    tapahtumatoistinButtonEl.textContent = 'Valmis! (ÂÆåÊàê!)';
                } else {
                    // ÊòæÁ§∫ÁªìÊûúÁä∂ÊÄÅ
                    tapahtumatoistinVisualEl.classList.add('result');
                    eventActionEl.textContent = visual.action_result;
                    eventLabelEl.textContent = visual.label_result;
                    tapahtumatoistinSentenceEl.innerHTML = currentTapahtumatoistinData.lause_tulos;
                    tapahtumatoistinSentenceTranslationEl.textContent = currentTapahtumatoistinData.translations.tulos;
                    tapahtumatoistinButtonEl.textContent = 'Uudelleen (ÂÜçÊù•‰∏ÄÊ¨°)';
                }
            } else { // active mode
                // ÊòæÁ§∫ÁªìÊûúÁä∂ÊÄÅÔºà‰∏ªÂä®Ê®°Âºè‰∏ãÊòæÁ§∫ÊúÄÁªàÁä∂ÊÄÅÔºâ
                tapahtumatoistinVisualEl.classList.add('result');
                eventActionEl.textContent = visual.action_result;
                eventLabelEl.textContent = '?';
                tapahtumatoistinSentenceEl.innerHTML = 'Mit√§ eilen tapahtui?';
                tapahtumatoistinSentenceTranslationEl.textContent = 'Êò®Â§©ÂèëÁîü‰∫Ü‰ªÄ‰πàÔºü';
                tapahtumatoistinAnswerEl.innerHTML = currentTapahtumatoistinData.lause_tulos;
                tapahtumatoistinAnswerTranslationEl.textContent = currentTapahtumatoistinData.translations.tulos;
                tapahtumatoistinButtonEl.textContent = 'N√§yt√§ vastaus (ÊòæÁ§∫Á≠îÊ°à)';
            }
        }
        
        function handleTapahtumatoistinClick() {
            const mode = document.querySelector('input[name="tapahtumatoistin-mode"]:checked').value;
            if (mode === 'passive') {
                tapahtumatoistinState.isShowingProcess = !tapahtumatoistinState.isShowingProcess;
                runTapahtumatoistin();
            } else { // active mode
                tapahtumatoistinAnswerContainerEl.style.display = 'block';
            }
        }
        
        // --- Èò∂ÊÆµ‰∏âÈÄªËæë ---
        function runKielioppimatriisi() {
            const subjekti = getRandomElement(subjektit);
            const verbiObj = getRandomElement(verbiObjektiLinkit);
            const persoona = persoonaMap[subjekti];
            const verbi = verbiObj.verbi[persoona];
            
            const lause = `${subjekti} <span class="highlight">${verbi}</span> ${verbiObj.objekti_gen}.`;
            sentenceDisplayEl.innerHTML = lause;

            // ËÆæÁΩÆÁøªËØë
            const subjektiTranslation = subjektitTranslations[subjekti];
            currentKielioppimatriisiTranslation = `${subjektiTranslation}${verbiObj.translations.verbi}${verbiObj.translations.objekti}„ÄÇ`;
            sentenceDisplayTranslationEl.textContent = currentKielioppimatriisiTranslation;
            
            // Ëá™Âä®ÂèëÈü≥
            const cleanSentence = lause.replace(/<[^>]*>/g, ''); // ÁßªÈô§HTMLÊ†áÁ≠æ
            speakText(cleanSentence);
        }


        // ==========================================================
        // ÂàùÂßãÂåñ (Initialization)
        // ==========================================================
        window.onload = () => {
            // Populate event selector
            tapahtumatoistinData.forEach(event => {
                const option = document.createElement('option');
                option.value = event.id;
                option.textContent = event.nimi;
                eventSelectEl.appendChild(option);
            });

            // Initial runs
            runAikakone();
            runTapahtumatoistin(true);
            runKielioppimatriisi();
        };

    </script>
</body>
</html>